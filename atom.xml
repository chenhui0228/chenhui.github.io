<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>陈辉的博客</title>
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://202.104.112.179:8085/"/>
  <updated>2018-03-06T05:25:14.941Z</updated>
  <id>http://202.104.112.179:8085/</id>
  
  <author>
    <name>陈辉</name>
    <email>chenhui0228@gmail.com</email>
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Python内存管理机制</title>
    <link href="http://202.104.112.179:8085/2018/03/06/python-memorey/"/>
    <id>http://202.104.112.179:8085/2018/03/06/python-memorey/</id>
    <published>2018-03-06T03:04:22.000Z</published>
    <updated>2018-03-06T05:25:14.941Z</updated>
    
    <content type="html"><![CDATA[<hr>
<p><strong>转载申明</strong>：本文转载博主alertbear的文章<a href="http://blog.csdn.net/alertbear/article/details/50808178" target="_blank" rel="external">Python内存管理机制</a>，转载请注明出处！</p>
<hr>
<p>Python内存管理机制主要包括以下三个方面：</p>
<ul>
<li><strong>引用计数机制</strong></li>
<li><strong>垃圾回收机制</strong></li>
<li><strong>内存池机制</strong></li>
</ul>
<hr>
<h2 id="引用计数"><a href="#引用计数" class="headerlink" title="引用计数"></a>引用计数</h2><p>举个例子说明引用是什么：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">a = <span class="number">1</span></div></pre></td></tr></table></figure>
<p>如上为一个简单的赋值语句，1就是对象，a就是引用，引用a指向对象1。<br>同理：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">b = <span class="number">1</span></div></pre></td></tr></table></figure>
<p>b也是对象1的引用。<br>通过内置函数id()返回对象的地址。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">print</span> id(a)  <span class="comment">#43220320</span></div><div class="line"><span class="keyword">print</span> id(b)  <span class="comment">#43220320</span></div></pre></td></tr></table></figure>
<p>当我们创建多个等于1的引用时，实际上是让所有这些引用指向同一个对象。为了检验两个引用指向同一个对象，我们可以用is关键字。is用于判断两个引用所指向的对象是否相同。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">print</span> (a <span class="keyword">is</span> b)  <span class="comment">#True</span></div></pre></td></tr></table></figure>
<p>在Python中，整数和短小的字符，Python都会缓存这些对象，以便重复使用。赋值语句，只是创造了新的引用，而不是对象本身。长的字符串和其它对象可以有多个相同的对象，可以使用赋值语句创建出新的对象。每个对象都有存有指向该对象的引用总数，即引用计数(reference count)。<br>可以使用sys.getrefcount()获得引用计数，需要注意的是，当使用某个引用作为参数，传递给getrefcount()时，参数实际上创建了一个临时的引用。因此，getrefcount()所得到的结果，会比期望的多1。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">from sys import getrefcount</div><div class="line"></div><div class="line">a = [1, 2, 3]</div><div class="line">print(getrefcount(a)) # 2</div><div class="line"></div><div class="line">b = a</div><div class="line">print(getrefcount(b)) # 3</div></pre></td></tr></table></figure>
<ul>
<li><p>引用计数增加</p>
<ol>
<li>对象被创建：x=4</li>
<li>另外的别人被创建：y=x</li>
<li>被作为参数传递给函数：foo(x)</li>
<li>作为容器对象的一个元素：a=[1, x, ‘33’]</li>
</ol>
</li>
<li><p>引用计数减少</p>
<ol>
<li>一个本地引用离开了它的作用域。比如上面的foo(x)函数结束时，x指向的对象引用减1。</li>
<li>对象的别名被显式的销毁：del x ；或者del y</li>
<li>对象的一个别名被赋值给其他对象：x=789</li>
<li>对象从一个窗口对象中移除：myList.remove(x)</li>
<li>窗口对象本身被销毁：del myList，或者窗口对象本身离开了作用域。</li>
</ol>
</li>
</ul>
<h2 id="垃圾回收"><a href="#垃圾回收" class="headerlink" title="垃圾回收"></a>垃圾回收</h2><ul>
<li>引用计数<br><br>引用计数也是一种垃圾收集机制，而且也是一种最直观，最简单的垃圾收集技术。当Python的某个对象的引用计数降为0时，说明没有任何引用指向该对象，该对象就成为要被回收的垃圾了。比如某个新建对象，它被分配给某个引用，对象的引用计数变为1。如果引用被删除，对象的引用计数为0，那么该对象就可以被垃圾回收。<br>不过如果出现循环引用的话，引用计数机制就不再起有效的作用了</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">a = []</div><div class="line">b = []</div><div class="line">a.append(b)</div><div class="line">b.append(a)</div><div class="line"><span class="keyword">print</span> a  <span class="comment"># [[[…]]]</span></div><div class="line"><span class="keyword">print</span> b  <span class="comment"># [[[…]]]</span></div></pre></td></tr></table></figure>
<p>循环引用可以使一组对象的引用计数不为0，然而这些对象实际上并没有被任何外部对象所引用，它们之间只是相互引用。这意味着不会再有人使用这组对象，应该回收这组对象所占用的内存空间，然而由于相互引用的存在，每一个对象的引用计数都不为0，因此这些对象所占用的内存永远不会被释放。<br>Python又引入了其他的垃圾收集机制来弥补引用计数的缺陷：“标记-清除“，“分代回收”两种收集技术。</p>
<ul>
<li><p>标记清除<br><br>如果两个对象的引用计数都为1，但是仅仅存在他们之间的循环引用，那么这两个对象都是需要被回收的，也就是说，它们的引用计数虽然表现为非0，但实际上有效的引用计数为0。所以先将循环引用摘掉，就会得出这两个对象的有效计数。<br>在实际操作中，并不改动真实的引用计数，而是将集合中对象的引用计数复制一份副本，改动该对象引用的副本。对于副本做任何的改动，都不会影响到对象生命周期的维护。<br>这个计数副本的唯一作用是寻找root object集合（该集合中的对象是不能被回收的）。当成功寻找到root object集合之后，首先将现在的内存链表一分为二，一条链表中维护root object集合，成为root链表，而另外一条链表中维护剩下的对象，成为unreachable链表。之所以要剖成两个链表，是基于这样的一种考虑：现在的unreachable可能存在被root链表中的对象，直接或间接引用的对象，这些对象是不能被回收的，一旦在标记的过程中，发现这样的对象，就将其从unreachable链表中移到root链表中；当完成标记后，unreachable链表中剩下的所有对象就是名副其实的垃圾对象了，接下来的垃圾回收只需限制在unreachable链表中即可。</p>
</li>
<li><p>分代回收<br><br>从前面“标记-清除”这样的垃圾收集机制来看，这种垃圾收集机制所带来的额外操作实际上与系统中总的内存块的数量是相关的，当需要回收的内存块越多时，垃圾检测带来的额外操作就越多，而垃圾回收带来的额外操作就越少；反之，当需回收的内存块越少时，垃圾检测就将比垃圾回收带来更少的额外操作。<br>举个例子来说明：<br>当某些内存块M经过了3次垃圾收集的清洗之后还存活时，我们就将内存块M划到一个集合A中去，而新分配的内存都划分到集合B中去。当垃圾收集开始工作时，大多数情况都只对集合B进行垃圾回收，而对集合A进行垃圾回收要隔相当长一段时间后才进行，这就使得垃圾收集机制需要处理的内存少了，效率自然就提高了。在这个过程中，集合B中的某些内存块由于存活时间长而会被转移到集合A中，当然，集合A中实际上也存在一些垃圾，这些垃圾的回收会因为这种分代的机制而被延迟。</p>
</li>
</ul>
<h2 id="内存池"><a href="#内存池" class="headerlink" title="内存池"></a>内存池</h2><img src="/2018/03/06/python-memorey/mempool.png" alt="mempool.png" title="">
<ul>
<li>Python的内存机制呈现金字塔形状，-1，-2层主要有操作系统进行操作；</li>
<li>第0层是C中的malloc，free等内存分配和释放函数进行操作；</li>
<li>第1层和第2层是内存池，有Python的接口函数PyMem_Malloc函数实现，当对象小于256K时有该层直接分配内存；</li>
<li>第3层是最上层，也就是我们对Python对象的直接操作；</li>
</ul>
<p>Python在运行期间会大量地执行malloc和free的操作，频繁地在用户态和核心态之间进行切换，这将严重影响Python的执行效率。为了加速Python的执行效率，Python引入了一个内存池机制，用于管理对小块内存的申请和释放。<br>Python内部默认的小块内存与大块内存的分界点定在256个字节，当申请的内存小于256字节时，PyObject_Malloc会在内存池中申请内存；当申请的内存大于256字节时，PyObject_Malloc的行为将蜕化为malloc的行为。当然，通过修改Python源代码，我们可以改变这个默认值，从而改变Python的默认内存管理行为。</p>
]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
&lt;p&gt;&lt;strong&gt;转载申明&lt;/strong&gt;：本文转载博主alertbear的文章&lt;a href=&quot;http://blog.csdn.net/alertbear/article/details/50808178&quot; target=&quot;_blank&quot; rel=&quot;exter
    
    </summary>
    
      <category term="Python" scheme="http://202.104.112.179:8085/categories/Python/"/>
    
    
      <category term="Python内存管理" scheme="http://202.104.112.179:8085/tags/Python%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>Python语言特性</title>
    <link href="http://202.104.112.179:8085/2018/03/01/interview-python/"/>
    <id>http://202.104.112.179:8085/2018/03/01/interview-python/</id>
    <published>2018-03-01T06:17:19.000Z</published>
    <updated>2018-03-06T08:55:28.496Z</updated>
    
    <content type="html"><![CDATA[<hr>
<p><strong>原创申明</strong>：本文转载博主<a href="https://github.com/taizilongxu" target="_blank" rel="external">taizilongxu</a>的文章<a href="https://github.com/taizilongxu/interview_python" target="_blank" rel="external">关于Python的面试题</a>，转载请注明出处！</p>
<hr>
<!-- markdown-toc start - Don't edit this section. Run M-x markdown-toc-generate-toc again -->
<p><strong>Table of Contents</strong></p>
<ul>
<li><a href="#python语言特性">Python语言特性</a><ul>
<li><a href="#1-python的函数参数传递">1 Python的函数参数传递</a></li>
<li><a href="#2-python中的元类metaclass">2 Python中的元类(metaclass)</a></li>
<li><a href="#3-staticmethod和classmethod">3 @staticmethod和@classmethod</a></li>
<li><a href="#4-类变量和实例变量">4 类变量和实例变量</a></li>
<li><a href="#5-python自省">5 Python自省</a></li>
<li><a href="#6-字典推导式">6 字典推导式</a></li>
<li><a href="#7-python中单下划线和双下划线">7 Python中单下划线和双下划线</a></li>
<li><a href="#8-字符串格式化和format">8 字符串格式化:\x和.format</a></li>
<li><a href="#9-迭代器和生成器">9 迭代器和生成器</a></li>
<li><a href="#10-args-and-kwargs">10 <em>args and <code>*</code></em>kwargs</a></li>
<li><a href="#11-面向切面编程aop和装饰器">11 面向切面编程AOP和装饰器</a></li>
<li><a href="#12-鸭子类型">12 鸭子类型</a></li>
<li><a href="#13-python中重载">13 Python中重载</a></li>
<li><a href="#14-新式类和旧式类">14 新式类和旧式类</a></li>
<li><a href="#15-__new__和__init__的区别">15 <strong>new</strong>和<code><strong>init</strong></code>的区别</a></li>
<li><a href="#16-单例模式">16 单例模式</a><ul>
<li><a href="#1-使用__new__方法">1 使用<strong>new</strong>方法</a></li>
<li><a href="#2-共享属性">2 共享属性</a></li>
<li><a href="#3-装饰器版本">3 装饰器版本</a></li>
<li><a href="#4-import方法">4 import方法</a></li>
</ul>
</li>
<li><a href="#17-python中的作用域">17 Python中的作用域</a></li>
<li><a href="#18-gil线程全局锁">18 GIL线程全局锁</a></li>
<li><a href="#19-协程">19 协程</a></li>
<li><a href="#20-闭包">20 闭包</a></li>
<li><a href="#21-lambda函数">21 lambda函数</a></li>
<li><a href="#22-python函数式编程">22 Python函数式编程</a></li>
<li><a href="#23-python里的拷贝">23 Python里的拷贝</a></li>
<li><a href="#24-python垃圾回收机制">24 Python垃圾回收机制</a><ul>
<li><a href="#1-引用计数">1 引用计数</a></li>
<li><a href="#2-标记-清除机制">2 标记-清除机制</a></li>
<li><a href="#3-分代技术">3 分代技术</a></li>
</ul>
</li>
<li><a href="#25-python的list">25 Python的List</a></li>
<li><a href="#26-python的is">26 Python的is</a></li>
<li><a href="#27-readreadline和readlines">27 read,readline和readlines</a></li>
<li><a href="#28-python2和3的区别">28 Python2和3的区别</a></li>
<li><a href="#29-super-init">29 super init</a></li>
<li><a href="#30-range-and-xrange">30 range and xrange</a></li>
</ul>
</li>
<li><a href="#操作系统">操作系统</a><ul>
<li><a href="#1-selectpoll和epoll">1 select,poll和epoll</a></li>
<li><a href="#2-调度算法">2 调度算法</a></li>
<li><a href="#3-死锁">3 死锁</a></li>
<li><a href="#4-程序编译与链接">4 程序编译与链接</a><ul>
<li><a href="#1-预处理">1 预处理</a></li>
<li><a href="#2-编译">2 编译</a></li>
<li><a href="#3-汇编">3 汇编</a></li>
<li><a href="#4-链接">4 链接</a></li>
</ul>
</li>
<li><a href="#5-静态链接和动态链接">5 静态链接和动态链接</a></li>
<li><a href="#6-虚拟内存技术">6 虚拟内存技术</a></li>
<li><a href="#7-分页和分段">7 分页和分段</a><ul>
<li><a href="#分页与分段的主要区别">分页与分段的主要区别</a></li>
</ul>
</li>
<li><a href="#8-页面置换算法">8 页面置换算法</a></li>
<li><a href="#9-边沿触发和水平触发">9 边沿触发和水平触发</a></li>
</ul>
</li>
<li><a href="#数据库">数据库</a><ul>
<li><a href="#1-事务">1 事务</a></li>
<li><a href="#2-数据库索引">2 数据库索引</a></li>
<li><a href="#3-redis原理">3 Redis原理</a><ul>
<li><a href="#redis是什么">Redis是什么？</a></li>
<li><a href="#redis数据库">Redis数据库</a></li>
<li><a href="#redis缺点">Redis缺点</a></li>
</ul>
</li>
<li><a href="#4-乐观锁和悲观锁">4 乐观锁和悲观锁</a></li>
<li><a href="#5-mvcc">5 MVCC</a><ul>
<li><a href="#mysql的innodb引擎是如何实现mvcc的"><a href="http://lib.csdn.net/base/mysql" target="_blank" rel="external">MySQL</a>的innodb引擎是如何实现MVCC的</a></li>
</ul>
</li>
<li><a href="#6-myisam和innodb">6 MyISAM和InnoDB</a></li>
</ul>
</li>
<li><a href="#网络">网络</a><ul>
<li><a href="#1-三次握手">1 三次握手</a></li>
<li><a href="#2-四次挥手">2 四次挥手</a></li>
<li><a href="#3-arp协议">3 ARP协议</a></li>
<li><a href="#4-urllib和urllib2的区别">4 urllib和urllib2的区别</a></li>
<li><a href="#5-post和get">5 Post和Get</a></li>
<li><a href="#6-cookie和session">6 Cookie和Session</a></li>
<li><a href="#7-apache和nginx的区别">7 apache和nginx的区别</a></li>
<li><a href="#8-网站用户密码保存">8 网站用户密码保存</a></li>
<li><a href="#9-http和https">9 HTTP和HTTPS</a></li>
<li><a href="#10-xsrf和xss">10 XSRF和XSS</a></li>
<li><a href="#11-幂等-idempotence">11 幂等 Idempotence</a></li>
<li><a href="#12-restful架构soaprpc">12 RESTful架构(SOAP,RPC)</a></li>
<li><a href="#13-soap">13 SOAP</a></li>
<li><a href="#14-rpc">14 RPC</a></li>
<li><a href="#15-cgi和wsgi">15 CGI和WSGI</a></li>
<li><a href="#16-中间人攻击">16 中间人攻击</a></li>
<li><a href="#17-c10k问题">17 c10k问题</a></li>
<li><a href="#18-socket">18 socket</a></li>
<li><a href="#19-浏览器缓存">19 浏览器缓存</a></li>
<li><a href="#20-http10和http11">20 HTTP1.0和HTTP1.1</a></li>
<li><a href="#21-ajax">21 Ajax</a></li>
</ul>
</li>
<li><a href="#nix">*NIX</a><ul>
<li><a href="#unix进程间通信方式ipc">unix进程间通信方式(IPC)</a></li>
</ul>
</li>
<li><a href="#数据结构">数据结构</a><ul>
<li><a href="#1-红黑树">1 红黑树</a></li>
</ul>
</li>
<li><a href="#编程题">编程题</a><ul>
<li><a href="#1-台阶问题斐波那契">1 台阶问题/斐波那契</a></li>
<li><a href="#2-变态台阶问题">2 变态台阶问题</a></li>
<li><a href="#3-矩形覆盖">3 矩形覆盖</a></li>
<li><a href="#4-杨氏矩阵查找">4 杨氏矩阵查找</a></li>
<li><a href="#5-去除列表中的重复元素">5 去除列表中的重复元素</a></li>
<li><a href="#6-链表成对调换">6 链表成对调换</a></li>
<li><a href="#7-创建字典的方法">7 创建字典的方法</a><ul>
<li><a href="#1-直接创建">1 直接创建</a></li>
<li><a href="#2-工厂方法">2 工厂方法</a></li>
<li><a href="#3-fromkeys方法">3 fromkeys()方法</a></li>
</ul>
</li>
<li><a href="#8-合并两个有序列表">8 合并两个有序列表</a></li>
<li><a href="#9-交叉链表求交点">9 交叉链表求交点</a></li>
<li><a href="#10-二分查找">10 二分查找</a></li>
<li><a href="#11-快排">11 快排</a></li>
<li><a href="#12-找零问题">12 找零问题</a></li>
<li><a href="#13-广度遍历和深度遍历二叉树">13 广度遍历和深度遍历二叉树</a></li>
<li><a href="#17-前中后序遍历">17 前中后序遍历</a></li>
<li><a href="#18-求最大树深">18 求最大树深</a></li>
<li><a href="#19-求两棵树是否相同">19 求两棵树是否相同</a></li>
<li><a href="#20-前序中序求后序">20 前序中序求后序</a></li>
<li><a href="#21-单链表逆置">21 单链表逆置</a></li>
<li><a href="#22-两个字符串是否是变位词">22 两个字符串是否是变位词</a></li>
<li><a href="#23-动态规划问题">23 动态规划问题</a></li>
</ul>
</li>
</ul>
<!-- markdown-toc end -->
<h1 id="Python语言特性"><a href="#Python语言特性" class="headerlink" title="Python语言特性"></a>Python语言特性</h1><h2 id="1-Python的函数参数传递"><a href="#1-Python的函数参数传递" class="headerlink" title="1 Python的函数参数传递"></a>1 Python的函数参数传递</h2><p>看两个例子:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">a = <span class="number">1</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">fun</span><span class="params">(a)</span>:</span></div><div class="line">    a = <span class="number">2</span></div><div class="line">fun(a)</div><div class="line"><span class="keyword">print</span> a  <span class="comment"># 1</span></div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">a = []</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">fun</span><span class="params">(a)</span>:</span></div><div class="line">    a.append(<span class="number">1</span>)</div><div class="line">fun(a)</div><div class="line"><span class="keyword">print</span> a  <span class="comment"># [1]</span></div></pre></td></tr></table></figure>
<p>所有的变量都可以理解是内存中一个对象的“引用”，或者，也可以看似c中void*的感觉。</p>
<p>通过<code>id</code>来看引用<code>a</code>的内存地址可以比较理解：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">a = <span class="number">1</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">fun</span><span class="params">(a)</span>:</span></div><div class="line">    <span class="keyword">print</span> <span class="string">"func_in"</span>,id(a)   <span class="comment"># func_in 41322472</span></div><div class="line">    a = <span class="number">2</span></div><div class="line">    <span class="keyword">print</span> <span class="string">"re-point"</span>,id(a), id(<span class="number">2</span>)   <span class="comment"># re-point 41322448 41322448</span></div><div class="line"><span class="keyword">print</span> <span class="string">"func_out"</span>,id(a), id(<span class="number">1</span>)  <span class="comment"># func_out 41322472 41322472</span></div><div class="line">fun(a)</div><div class="line"><span class="keyword">print</span> a  <span class="comment"># 1</span></div></pre></td></tr></table></figure>
<p>注：具体的值在不同电脑上运行时可能不同。</p>
<p>可以看到，在执行完<code>a = 2</code>之后，<code>a</code>引用中保存的值，即内存地址发生变化，由原来<code>1</code>对象的所在的地址变成了<code>2</code>这个实体对象的内存地址。</p>
<p>而第2个例子<code>a</code>引用保存的内存值就不会发生变化：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">a = []</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">fun</span><span class="params">(a)</span>:</span></div><div class="line">    <span class="keyword">print</span> <span class="string">"func_in"</span>,id(a)  <span class="comment"># func_in 53629256</span></div><div class="line">    a.append(<span class="number">1</span>)</div><div class="line"><span class="keyword">print</span> <span class="string">"func_out"</span>,id(a)     <span class="comment"># func_out 53629256</span></div><div class="line">fun(a)</div><div class="line"><span class="keyword">print</span> a  <span class="comment"># [1]</span></div></pre></td></tr></table></figure>
<p>这里记住的是类型是属于对象的，而不是变量。而对象有两种,“可更改”（mutable）与“不可更改”（immutable）对象。在python中，strings, tuples, 和numbers是不可更改的对象，而 list, dict, set 等则是可以修改的对象。(这就是这个问题的重点)</p>
<p>当一个引用传递给函数的时候,函数自动复制一份引用,这个函数里的引用和外边的引用没有半毛关系了.所以第一个例子里函数把引用指向了一个不可变对象,当函数返回的时候,外面的引用没半毛感觉.而第二个例子就不一样了,函数内的引用指向的是可变对象,对它的操作就和定位了指针地址一样,在内存里进行修改.</p>
<p>如果还不明白的话,这里有更好的解释: <a href="http://stackoverflow.com/questions/986006/how-do-i-pass-a-variable-by-reference" target="_blank" rel="external">http://stackoverflow.com/questions/986006/how-do-i-pass-a-variable-by-reference</a></p>
<h2 id="2-Python中的元类-metaclass"><a href="#2-Python中的元类-metaclass" class="headerlink" title="2 Python中的元类(metaclass)"></a>2 Python中的元类(metaclass)</h2><p>这个非常的不常用,但是像ORM这种复杂的结构还是会需要的,详情请看:<a href="http://stackoverflow.com/questions/100003/what-is-a-metaclass-in-python" target="_blank" rel="external">http://stackoverflow.com/questions/100003/what-is-a-metaclass-in-python</a></p>
<h2 id="3-staticmethod和-classmethod"><a href="#3-staticmethod和-classmethod" class="headerlink" title="3 @staticmethod和@classmethod"></a>3 @staticmethod和@classmethod</h2><p>Python其实有3个方法,即静态方法(staticmethod),类方法(classmethod)和实例方法,如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">(x)</span>:</span></div><div class="line">    <span class="keyword">print</span> <span class="string">"executing foo(%s)"</span>%(x)</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">(self,x)</span>:</span></div><div class="line">        <span class="keyword">print</span> <span class="string">"executing foo(%s,%s)"</span>%(self,x)</div><div class="line"></div><div class="line"><span class="meta">    @classmethod</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">class_foo</span><span class="params">(cls,x)</span>:</span></div><div class="line">        <span class="keyword">print</span> <span class="string">"executing class_foo(%s,%s)"</span>%(cls,x)</div><div class="line"></div><div class="line"><span class="meta">    @staticmethod</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">static_foo</span><span class="params">(x)</span>:</span></div><div class="line">        <span class="keyword">print</span> <span class="string">"executing static_foo(%s)"</span>%x</div><div class="line"></div><div class="line">a=A()</div></pre></td></tr></table></figure>
<p>这里先理解下函数参数里面的self和cls.这个self和cls是对类或者实例的绑定,对于一般的函数来说我们可以这么调用<code>foo(x)</code>,这个函数就是最常用的,它的工作跟任何东西(类,实例)无关.对于实例方法,我们知道在类里每次定义方法的时候都需要绑定这个实例,就是<code>foo(self, x)</code>,为什么要这么做呢?因为实例方法的调用离不开实例,我们需要把实例自己传给函数,调用的时候是这样的<code>a.foo(x)</code>(其实是<code>foo(a, x)</code>).类方法一样,只不过它传递的是类而不是实例,<code>A.class_foo(x)</code>.注意这里的self和cls可以替换别的参数,但是python的约定是这俩,还是不要改的好.</p>
<p>对于静态方法其实和普通的方法一样,不需要对谁进行绑定,唯一的区别是调用的时候需要使用<code>a.static_foo(x)</code>或者<code>A.static_foo(x)</code>来调用.</p>
<table>
<thead>
<tr>
<th style="text-align:left">\</th>
<th style="text-align:left">实例方法</th>
<th style="text-align:left">类方法</th>
<th style="text-align:left">静态方法</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">a = A()</td>
<td style="text-align:left">a.foo(x)</td>
<td style="text-align:left">a.class_foo(x)</td>
<td style="text-align:left">a.static_foo(x)</td>
</tr>
<tr>
<td style="text-align:left">A</td>
<td style="text-align:left">不可用</td>
<td style="text-align:left">A.class_foo(x)</td>
<td style="text-align:left">A.static_foo(x)</td>
</tr>
</tbody>
</table>
<p>更多关于这个问题:</p>
<ol>
<li><a href="http://stackoverflow.com/questions/136097/what-is-the-difference-between-staticmethod-and-classmethod-in-python" target="_blank" rel="external">http://stackoverflow.com/questions/136097/what-is-the-difference-between-staticmethod-and-classmethod-in-python</a></li>
<li><a href="https://realpython.com/blog/python/instance-class-and-static-methods-demystified/" target="_blank" rel="external">https://realpython.com/blog/python/instance-class-and-static-methods-demystified/</a><h2 id="4-类变量和实例变量"><a href="#4-类变量和实例变量" class="headerlink" title="4 类变量和实例变量"></a>4 类变量和实例变量</h2></li>
</ol>
<p><strong>类变量：</strong></p>
<blockquote>
<p>​    是可在类的所有实例之间共享的值（也就是说，它们不是单独分配给每个实例的）。例如下例中，num_of_instance 就是类变量，用于跟踪存在着多少个Test 的实例。</p>
</blockquote>
<p><strong>实例变量：</strong></p>
<blockquote>
<p>实例化之后，每个实例单独拥有的变量。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span><span class="params">(object)</span>:</span>  </div><div class="line">    num_of_instance = <span class="number">0</span>  </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name)</span>:</span>  </div><div class="line">        self.name = name  </div><div class="line">        Test.num_of_instance += <span class="number">1</span>  </div><div class="line">  </div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:  </div><div class="line">    <span class="keyword">print</span> Test.num_of_instance   <span class="comment"># 0</span></div><div class="line">    t1 = Test(<span class="string">'jack'</span>)  </div><div class="line">    <span class="keyword">print</span> Test.num_of_instance   <span class="comment"># 1</span></div><div class="line">    t2 = Test(<span class="string">'lucy'</span>)  </div><div class="line">    <span class="keyword">print</span> t1.name , t1.num_of_instance  <span class="comment"># jack 2</span></div><div class="line">    <span class="keyword">print</span> t2.name , t2.num_of_instance  <span class="comment"># lucy 2</span></div></pre></td></tr></table></figure>
<blockquote>
<p>补充的例子</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>:</span></div><div class="line">    name=<span class="string">"aaa"</span></div><div class="line"></div><div class="line">p1=Person()</div><div class="line">p2=Person()</div><div class="line">p1.name=<span class="string">"bbb"</span></div><div class="line"><span class="keyword">print</span> p1.name  <span class="comment"># bbb</span></div><div class="line"><span class="keyword">print</span> p2.name  <span class="comment"># aaa</span></div><div class="line"><span class="keyword">print</span> Person.name  <span class="comment"># aaa</span></div></pre></td></tr></table></figure>
<p>这里<code>p1.name=&quot;bbb&quot;</code>是实例调用了类变量,这其实和上面第一个问题一样,就是函数传参的问题,<code>p1.name</code>一开始是指向的类变量<code>name=&quot;aaa&quot;</code>,但是在实例的作用域里把类变量的引用改变了,就变成了一个实例变量,self.name不再引用Person的类变量name了.</p>
<p>可以看看下面的例子:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>:</span></div><div class="line">    name=[]</div><div class="line"></div><div class="line">p1=Person()</div><div class="line">p2=Person()</div><div class="line">p1.name.append(<span class="number">1</span>)</div><div class="line"><span class="keyword">print</span> p1.name  <span class="comment"># [1]</span></div><div class="line"><span class="keyword">print</span> p2.name  <span class="comment"># [1]</span></div><div class="line"><span class="keyword">print</span> Person.name  <span class="comment"># [1]</span></div></pre></td></tr></table></figure>
<p>参考:<a href="http://stackoverflow.com/questions/6470428/catch-multiple-exceptions-in-one-line-except-block" target="_blank" rel="external">http://stackoverflow.com/questions/6470428/catch-multiple-exceptions-in-one-line-except-block</a></p>
<h2 id="5-Python自省"><a href="#5-Python自省" class="headerlink" title="5 Python自省"></a>5 Python自省</h2><p>这个也是python彪悍的特性.</p>
<p>自省就是面向对象的语言所写的程序在运行时,所能知道对象的类型.简单一句就是运行时能够获得对象的类型.比如type(),dir(),getattr(),hasattr(),isinstance().</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">a = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</div><div class="line">b = &#123;<span class="string">'a'</span>:<span class="number">1</span>,<span class="string">'b'</span>:<span class="number">2</span>,<span class="string">'c'</span>:<span class="number">3</span>&#125;</div><div class="line">c = <span class="keyword">True</span></div><div class="line"><span class="keyword">print</span> type(a),type(b),type(c) <span class="comment"># &lt;type 'list'&gt; &lt;type 'dict'&gt; &lt;type 'bool'&gt;</span></div><div class="line"><span class="keyword">print</span> isinstance(a,list)  <span class="comment"># True</span></div></pre></td></tr></table></figure>
<h2 id="6-字典推导式"><a href="#6-字典推导式" class="headerlink" title="6 字典推导式"></a>6 字典推导式</h2><p>可能你见过列表推导时,却没有见过字典推导式,在2.7中才加入的:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">d = &#123;key: value <span class="keyword">for</span> (key, value) <span class="keyword">in</span> iterable&#125;</div></pre></td></tr></table></figure>
<h2 id="7-Python中单下划线和双下划线"><a href="#7-Python中单下划线和双下划线" class="headerlink" title="7 Python中单下划线和双下划线"></a>7 Python中单下划线和双下划线</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span><span class="params">()</span>:</span></div><div class="line"><span class="meta">... </span>    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></div><div class="line"><span class="meta">... </span>            self.__superprivate = <span class="string">"Hello"</span></div><div class="line"><span class="meta">... </span>            self._semiprivate = <span class="string">", world!"</span></div><div class="line">...</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>mc = MyClass()</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">print</span> mc.__superprivate</div><div class="line">Traceback (most recent call last):</div><div class="line">  File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</div><div class="line">AttributeError: myClass instance has no attribute <span class="string">'__superprivate'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">print</span> mc._semiprivate</div><div class="line">, world!</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">print</span> mc.__dict__</div><div class="line">&#123;<span class="string">'_MyClass__superprivate'</span>: <span class="string">'Hello'</span>, <span class="string">'_semiprivate'</span>: <span class="string">', world!'</span>&#125;</div></pre></td></tr></table></figure>
<p><code>__foo__</code>:一种约定,Python内部的名字,用来区别其他用户自定义的命名,以防冲突，就是例如<code>__init__()</code>,<code>__del__()</code>,<code>__call__()</code>这些特殊方法</p>
<p><code>_foo</code>:一种约定,用来指定变量私有.程序员用来指定私有变量的一种方式.不能用from module import * 导入，其他方面和公有一样访问；</p>
<p><code>__foo</code>:这个有真正的意义:解析器用<code>_classname__foo</code>来代替这个名字,以区别和其他类相同的命名,它无法直接像公有成员一样随便访问,通过对象名._类名__xxx这样的方式可以访问.</p>
<p>详情见:<a href="http://stackoverflow.com/questions/1301346/the-meaning-of-a-single-and-a-double-underscore-before-an-object-name-in-python" target="_blank" rel="external">http://stackoverflow.com/questions/1301346/the-meaning-of-a-single-and-a-double-underscore-before-an-object-name-in-python</a></p>
<p>或者: <a href="http://www.zhihu.com/question/19754941" target="_blank" rel="external">http://www.zhihu.com/question/19754941</a></p>
<h2 id="8-字符串格式化-和-format"><a href="#8-字符串格式化-和-format" class="headerlink" title="8 字符串格式化:%和.format"></a>8 字符串格式化:%和.format</h2><p>.format在许多方面看起来更便利.对于<code>%</code>最烦人的是它无法同时传递一个变量和元组.你可能会想下面的代码不会有什么问题:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&quot;hi there %s&quot; % name</div></pre></td></tr></table></figure>
<p>但是,如果name恰好是(1,2,3),它将会抛出一个TypeError异常.为了保证它总是正确的,你必须这样做:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&quot;hi there %s&quot; % (name,)   # 提供一个单元素的数组而不是一个参数</div></pre></td></tr></table></figure>
<p>但是有点丑..format就没有这些问题.你给的第二个问题也是这样,.format好看多了.</p>
<p>你为什么不用它?</p>
<ul>
<li>不知道它(在读这个之前)</li>
<li>为了和Python2.5兼容(譬如logging库建议使用<code>%</code>(<a href="https://github.com/taizilongxu/interview_python/issues/4" target="_blank" rel="external">issue #4</a>))</li>
</ul>
<p><a href="http://stackoverflow.com/questions/5082452/python-string-formatting-vs-format" target="_blank" rel="external">http://stackoverflow.com/questions/5082452/python-string-formatting-vs-format</a></p>
<h2 id="9-迭代器和生成器"><a href="#9-迭代器和生成器" class="headerlink" title="9 迭代器和生成器"></a>9 迭代器和生成器</h2><p>这个是stackoverflow里python排名第一的问题,值得一看: <a href="http://stackoverflow.com/questions/231767/what-does-the-yield-keyword-do-in-python" target="_blank" rel="external">http://stackoverflow.com/questions/231767/what-does-the-yield-keyword-do-in-python</a></p>
<p>这是中文版: <a href="http://taizilongxu.gitbooks.io/stackoverflow-about-python/content/1/README.html" target="_blank" rel="external">http://taizilongxu.gitbooks.io/stackoverflow-about-python/content/1/README.html</a></p>
<p>这里有个关于生成器的创建问题面试官有考：<br>问：  将列表生成式中[]改成() 之后数据结构是否改变？<br>答案：是，从列表变为生成器</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>L = [x*x <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">10</span>)]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>L</div><div class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">16</span>, <span class="number">25</span>, <span class="number">36</span>, <span class="number">49</span>, <span class="number">64</span>, <span class="number">81</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>g = (x*x <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">10</span>))</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>g</div><div class="line">&lt;generator object &lt;genexpr&gt; at <span class="number">0x0000028F8B774200</span>&gt;</div></pre></td></tr></table></figure>
<p>通过列表生成式，可以直接创建一个列表。但是，受到内存限制，列表容量肯定是有限的。而且，创建一个包含百万元素的列表，不仅是占用很大的内存空间，如：我们只需要访问前面的几个元素，后面大部分元素所占的空间都是浪费的。因此，没有必要创建完整的列表（节省大量内存空间）。在Python中，我们可以采用生成器：边循环，边计算的机制—&gt;generator</p>
<h2 id="10-args-and-kwargs"><a href="#10-args-and-kwargs" class="headerlink" title="10 *args and **kwargs"></a>10 <code>*args</code> and <code>**kwargs</code></h2><p>用<code>*args</code>和<code>**kwargs</code>只是为了方便并没有强制使用它们.</p>
<p>当你不确定你的函数里将要传递多少参数时你可以用<code>*args</code>.例如,它可以传递任意数量的参数:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">print_everything</span><span class="params">(*args)</span>:</span></div><div class="line">        <span class="keyword">for</span> count, thing <span class="keyword">in</span> enumerate(args):</div><div class="line"><span class="meta">... </span>        <span class="keyword">print</span> <span class="string">'&#123;0&#125;. &#123;1&#125;'</span>.format(count, thing)</div><div class="line">...</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print_everything(<span class="string">'apple'</span>, <span class="string">'banana'</span>, <span class="string">'cabbage'</span>)</div><div class="line"><span class="number">0.</span> apple</div><div class="line"><span class="number">1.</span> banana</div><div class="line"><span class="number">2.</span> cabbage</div></pre></td></tr></table></figure>
<p>相似的,<code>**kwargs</code>允许你使用没有事先定义的参数名:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">table_things</span><span class="params">(**kwargs)</span>:</span></div><div class="line"><span class="meta">... </span>    <span class="keyword">for</span> name, value <span class="keyword">in</span> kwargs.items():</div><div class="line"><span class="meta">... </span>        <span class="keyword">print</span> <span class="string">'&#123;0&#125; = &#123;1&#125;'</span>.format(name, value)</div><div class="line">...</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>table_things(apple = <span class="string">'fruit'</span>, cabbage = <span class="string">'vegetable'</span>)</div><div class="line">cabbage = vegetable</div><div class="line">apple = fruit</div></pre></td></tr></table></figure>
<p>你也可以混着用.命名参数首先获得参数值然后所有的其他参数都传递给<code>*args</code>和<code>**kwargs</code>.命名参数在列表的最前端.例如:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">def table_things(titlestring, **kwargs)</div></pre></td></tr></table></figure>
<p><code>*args</code>和<code>**kwargs</code>可以同时在函数的定义中,但是<code>*args</code>必须在<code>**kwargs</code>前面.</p>
<p>当调用函数时你也可以用<code>*</code>和<code>**</code>语法.例如:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">print_three_things</span><span class="params">(a, b, c)</span>:</span></div><div class="line"><span class="meta">... </span>    <span class="keyword">print</span> <span class="string">'a = &#123;0&#125;, b = &#123;1&#125;, c = &#123;2&#125;'</span>.format(a,b,c)</div><div class="line">...</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>mylist = [<span class="string">'aardvark'</span>, <span class="string">'baboon'</span>, <span class="string">'cat'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print_three_things(*mylist)</div><div class="line"></div><div class="line">a = aardvark, b = baboon, c = cat</div></pre></td></tr></table></figure>
<p>就像你看到的一样,它可以传递列表(或者元组)的每一项并把它们解包.注意必须与它们在函数里的参数相吻合.当然,你也可以在函数定义或者函数调用时用*.</p>
<p><a href="http://stackoverflow.com/questions/3394835/args-and-kwargs" target="_blank" rel="external">http://stackoverflow.com/questions/3394835/args-and-kwargs</a></p>
<h2 id="11-面向切面编程AOP和装饰器"><a href="#11-面向切面编程AOP和装饰器" class="headerlink" title="11 面向切面编程AOP和装饰器"></a>11 面向切面编程AOP和装饰器</h2><p>这个AOP一听起来有点懵,同学面阿里的时候就被问懵了…</p>
<p>装饰器是一个很著名的设计模式，经常被用于有切面需求的场景，较为经典的有插入日志、性能测试、事务处理等。装饰器是解决这类问题的绝佳设计，有了装饰器，我们就可以抽离出大量函数中与函数功能本身无关的雷同代码并继续重用。概括的讲，<strong>装饰器的作用就是为已经存在的对象添加额外的功能。</strong></p>
<p>这个问题比较大,推荐: <a href="http://stackoverflow.com/questions/739654/how-can-i-make-a-chain-of-function-decorators-in-python" target="_blank" rel="external">http://stackoverflow.com/questions/739654/how-can-i-make-a-chain-of-function-decorators-in-python</a></p>
<p>中文: <a href="http://taizilongxu.gitbooks.io/stackoverflow-about-python/content/3/README.html" target="_blank" rel="external">http://taizilongxu.gitbooks.io/stackoverflow-about-python/content/3/README.html</a></p>
<h2 id="12-鸭子类型"><a href="#12-鸭子类型" class="headerlink" title="12 鸭子类型"></a>12 鸭子类型</h2><p>“当看到一只鸟走起来像鸭子、游泳起来像鸭子、叫起来也像鸭子，那么这只鸟就可以被称为鸭子。”</p>
<p>我们并不关心对象是什么类型，到底是不是鸭子，只关心行为。</p>
<p>比如在python中，有很多file-like的东西，比如StringIO,GzipFile,socket。它们有很多相同的方法，我们把它们当作文件使用。</p>
<p>又比如list.extend()方法中,我们并不关心它的参数是不是list,只要它是可迭代的,所以它的参数可以是list/tuple/dict/字符串/生成器等.</p>
<p>鸭子类型在动态语言中经常使用，非常灵活，使得python不想java那样专门去弄一大堆的设计模式。</p>
<h2 id="13-Python中重载"><a href="#13-Python中重载" class="headerlink" title="13 Python中重载"></a>13 Python中重载</h2><p>引自知乎:<a href="http://www.zhihu.com/question/20053359" target="_blank" rel="external">http://www.zhihu.com/question/20053359</a></p>
<p>函数重载主要是为了解决两个问题。</p>
<ol>
<li>可变参数类型。</li>
<li>可变参数个数。</li>
</ol>
<p>另外，一个基本的设计原则是，仅仅当两个函数除了参数类型和参数个数不同以外，其功能是完全相同的，此时才使用函数重载，如果两个函数的功能其实不同，那么不应当使用重载，而应当使用一个名字不同的函数。</p>
<p>好吧，那么对于情况 1 ，函数功能相同，但是参数类型不同，python 如何处理？答案是根本不需要处理，因为 python 可以接受任何类型的参数，如果函数的功能相同，那么不同的参数类型在 python 中很可能是相同的代码，没有必要做成两个不同函数。</p>
<p>那么对于情况 2 ，函数功能相同，但参数个数不同，python 如何处理？大家知道，答案就是缺省参数。对那些缺少的参数设定为缺省参数即可解决问题。因为你假设函数功能相同，那么那些缺少的参数终归是需要用的。</p>
<p>好了，鉴于情况 1 跟 情况 2 都有了解决方案，python 自然就不需要函数重载了。</p>
<h2 id="14-新式类和旧式类"><a href="#14-新式类和旧式类" class="headerlink" title="14 新式类和旧式类"></a>14 新式类和旧式类</h2><p>这个面试官问了,我说了老半天,不知道他问的真正意图是什么.</p>
<p><a href="http://stackoverflow.com/questions/54867/what-is-the-difference-between-old-style-and-new-style-classes-in-python" target="_blank" rel="external">stackoverflow</a></p>
<p>这篇文章很好的介绍了新式类的特性: <a href="http://www.cnblogs.com/btchenguang/archive/2012/09/17/2689146.html" target="_blank" rel="external">http://www.cnblogs.com/btchenguang/archive/2012/09/17/2689146.html</a></p>
<p>新式类很早在2.2就出现了,所以旧式类完全是兼容的问题,Python3里的类全部都是新式类.这里有一个MRO问题可以了解下(新式类是广度优先,旧式类是深度优先),<python核心编程>里讲的也很多.</python核心编程></p>
<blockquote>
<p>一个旧式类的深度优先的例子</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span><span class="params">()</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">foo1</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">print</span> <span class="string">"A"</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span><span class="params">(A)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">foo2</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">pass</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span><span class="params">(A)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">foo1</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">print</span> <span class="string">"C"</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">D</span><span class="params">(B, C)</span>:</span></div><div class="line">    <span class="keyword">pass</span></div><div class="line"></div><div class="line">d = D()</div><div class="line">d.foo1()</div><div class="line"></div><div class="line"><span class="comment"># A</span></div></pre></td></tr></table></figure>
<p><strong>按照经典类的查找顺序<code>从左到右深度优先</code>的规则，在访问<code>d.foo1()</code>的时候,D这个类是没有的..那么往上查找,先找到B,里面没有,深度优先,访问A,找到了foo1(),所以这时候调用的是A的foo1()，从而导致C重写的foo1()被绕过</strong></p>
<h2 id="15-new-和-init-的区别"><a href="#15-new-和-init-的区别" class="headerlink" title="15 __new__和__init__的区别"></a>15 <code>__new__</code>和<code>__init__</code>的区别</h2><p>这个<code>__new__</code>确实很少见到,先做了解吧.</p>
<ol>
<li><code>__new__</code>是一个静态方法,而<code>__init__</code>是一个实例方法.</li>
<li><code>__new__</code>方法会返回一个创建的实例,而<code>__init__</code>什么都不返回.</li>
<li>只有在<code>__new__</code>返回一个cls的实例时后面的<code>__init__</code>才能被调用.</li>
<li>当创建一个新实例时调用<code>__new__</code>,初始化一个实例时用<code>__init__</code>.</li>
</ol>
<p><a href="http://stackoverflow.com/questions/674304/pythons-use-of-new-and-init" target="_blank" rel="external">stackoverflow</a></p>
<p>ps: <code>__metaclass__</code>是创建类时起作用.所以我们可以分别使用<code>__metaclass__</code>,<code>__new__</code>和<code>__init__</code>来分别在类创建,实例创建和实例初始化的时候做一些小手脚.</p>
<h2 id="16-单例模式"><a href="#16-单例模式" class="headerlink" title="16 单例模式"></a>16 单例模式</h2><blockquote>
<p>​    单例模式是一种常用的软件设计模式。在它的核心结构中只包含一个被称为单例类的特殊类。通过单例模式可以保证系统中一个类只有一个实例而且该实例易于外界访问，从而方便对实例个数的控制并节约系统资源。如果希望在系统中某个类的对象只能存在一个，单例模式是最好的解决方案。</p>
<p><code>__new__()</code>在<code>__init__()</code>之前被调用，用于生成实例对象。利用这个方法和类的属性的特点可以实现设计模式的单例模式。单例模式是指创建唯一对象，单例模式设计的类只能实例</p>
</blockquote>
<p><strong>这个绝对常考啊.绝对要记住1~2个方法,当时面试官是让手写的.</strong></p>
<h3 id="1-使用-new-方法"><a href="#1-使用-new-方法" class="headerlink" title="1 使用__new__方法"></a>1 使用<code>__new__</code>方法</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__new__</span><span class="params">(cls, *args, **kw)</span>:</span></div><div class="line">        <span class="keyword">if</span> <span class="keyword">not</span> hasattr(cls, <span class="string">'_instance'</span>):</div><div class="line">            orig = super(Singleton, cls)</div><div class="line">            cls._instance = orig.__new__(cls, *args, **kw)</div><div class="line">        <span class="keyword">return</span> cls._instance</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span><span class="params">(Singleton)</span>:</span></div><div class="line">    a = <span class="number">1</span></div></pre></td></tr></table></figure>
<h3 id="2-共享属性"><a href="#2-共享属性" class="headerlink" title="2 共享属性"></a>2 共享属性</h3><p>创建实例时把所有实例的<code>__dict__</code>指向同一个字典,这样它们具有相同的属性和方法.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Borg</span><span class="params">(object)</span>:</span></div><div class="line">    _state = &#123;&#125;</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__new__</span><span class="params">(cls, *args, **kw)</span>:</span></div><div class="line">        ob = super(Borg, cls).__new__(cls, *args, **kw)</div><div class="line">        ob.__dict__ = cls._state</div><div class="line">        <span class="keyword">return</span> ob</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass2</span><span class="params">(Borg)</span>:</span></div><div class="line">    a = <span class="number">1</span></div></pre></td></tr></table></figure>
<h3 id="3-装饰器版本"><a href="#3-装饰器版本" class="headerlink" title="3 装饰器版本"></a>3 装饰器版本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">singleton</span><span class="params">(cls, *args, **kw)</span>:</span></div><div class="line">    instances = &#123;&#125;</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getinstance</span><span class="params">()</span>:</span></div><div class="line">        <span class="keyword">if</span> cls <span class="keyword">not</span> <span class="keyword">in</span> instances:</div><div class="line">            instances[cls] = cls(*args, **kw)</div><div class="line">        <span class="keyword">return</span> instances[cls]</div><div class="line">    <span class="keyword">return</span> getinstance</div><div class="line"></div><div class="line"><span class="meta">@singleton</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span>:</span></div><div class="line">  ...</div></pre></td></tr></table></figure>
<h3 id="4-import方法"><a href="#4-import方法" class="headerlink" title="4 import方法"></a>4 import方法</h3><p>作为python的模块是天然的单例模式</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># mysingleton.py</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">My_Singleton</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">pass</span></div><div class="line"></div><div class="line">my_singleton = My_Singleton()</div><div class="line"></div><div class="line"><span class="comment"># to use</span></div><div class="line"><span class="keyword">from</span> mysingleton <span class="keyword">import</span> my_singleton</div><div class="line"></div><div class="line">my_singleton.foo()</div></pre></td></tr></table></figure>
<h2 id="17-Python中的作用域"><a href="#17-Python中的作用域" class="headerlink" title="17 Python中的作用域"></a>17 Python中的作用域</h2><p>Python 中，一个变量的作用域总是由在代码中被赋值的地方所决定的。</p>
<p>当 Python 遇到一个变量的话他会按照这样的顺序进行搜索：</p>
<p>本地作用域（Local）→当前作用域被嵌入的本地作用域（Enclosing locals）→全局/模块作用域（Global）→内置作用域（Built-in）</p>
<h2 id="18-GIL线程全局锁"><a href="#18-GIL线程全局锁" class="headerlink" title="18 GIL线程全局锁"></a>18 GIL线程全局锁</h2><p>线程全局锁(Global Interpreter Lock),即Python为了保证线程安全而采取的独立线程运行的限制,说白了就是一个核只能在同一时间运行一个线程.<strong>对于io密集型任务，python的多线程起到作用，但对于cpu密集型任务，python的多线程几乎占不到任何优势，还有可能因为争夺资源而变慢。</strong></p>
<p>见<a href="http://www.oschina.net/translate/pythons-hardest-problem" target="_blank" rel="external">Python 最难的问题</a></p>
<p>解决办法就是多进程和下面的协程(协程也只是单CPU,但是能减小切换代价提升性能).</p>
<h2 id="19-协程"><a href="#19-协程" class="headerlink" title="19 协程"></a>19 协程</h2><p>知乎被问到了,呵呵哒,跪了</p>
<p>简单点说协程是进程和线程的升级版,进程和线程都面临着内核态和用户态的切换问题而耗费许多切换时间,而协程就是用户自己控制切换的时机,不再需要陷入系统的内核态.</p>
<p>Python里最常见的yield就是协程的思想!可以查看第九个问题.</p>
<h2 id="20-闭包"><a href="#20-闭包" class="headerlink" title="20 闭包"></a>20 闭包</h2><p>闭包(closure)是函数式编程的重要的语法结构。闭包也是一种组织代码的结构，它同样提高了代码的可重复使用性。</p>
<p>当一个内嵌函数引用其外部作作用域的变量,我们就会得到一个闭包. 总结一下,创建一个闭包必须满足以下几点:</p>
<ol>
<li>必须有一个内嵌函数</li>
<li>内嵌函数必须引用外部函数中的变量</li>
<li>外部函数的返回值必须是内嵌函数</li>
</ol>
<p>感觉闭包还是有难度的,几句话是说不明白的,还是查查相关资料.</p>
<p>重点是函数运行后并不会被撤销,就像16题的instance字典一样,当函数运行完后,instance并不被销毁,而是继续留在内存空间里.这个功能类似类里的类变量,只不过迁移到了函数上.</p>
<p>闭包就像个空心球一样,你知道外面和里面,但你不知道中间是什么样.</p>
<h2 id="21-lambda函数"><a href="#21-lambda函数" class="headerlink" title="21 lambda函数"></a>21 lambda函数</h2><p>其实就是一个匿名函数,为什么叫lambda?因为和后面的函数式编程有关.</p>
<p>推荐: <a href="http://www.zhihu.com/question/20125256" target="_blank" rel="external">知乎</a></p>
<h2 id="22-Python函数式编程"><a href="#22-Python函数式编程" class="headerlink" title="22 Python函数式编程"></a>22 Python函数式编程</h2><p>这个需要适当的了解一下吧,毕竟函数式编程在Python中也做了引用.</p>
<p>推荐: <a href="http://coolshell.cn/articles/10822.html" target="_blank" rel="external">酷壳</a></p>
<p>python中函数式编程支持:</p>
<p>filter 函数的功能相当于过滤器。调用一个布尔函数<code>bool_func</code>来迭代遍历每个seq中的元素；返回一个使<code>bool_seq</code>返回值为true的元素的序列。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt;a = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>]</div><div class="line">&gt;&gt;&gt;b = filter(<span class="keyword">lambda</span> x: x &gt; <span class="number">5</span>, a)</div><div class="line">&gt;&gt;&gt;<span class="keyword">print</span> b</div><div class="line">&gt;&gt;&gt;[<span class="number">6</span>,<span class="number">7</span>]</div></pre></td></tr></table></figure>
<p>map函数是对一个序列的每个项依次执行函数，下面是对一个序列每个项都乘以2：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = map(<span class="keyword">lambda</span> x:x*<span class="number">2</span>,[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>list(a)</div><div class="line">[<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>]</div></pre></td></tr></table></figure>
<p>reduce函数是对一个序列的每个项迭代调用函数，下面是求3的阶乘：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>reduce(<span class="keyword">lambda</span> x,y:x*y,range(<span class="number">1</span>,<span class="number">4</span>))</div><div class="line"><span class="number">6</span></div></pre></td></tr></table></figure>
<h2 id="23-Python里的拷贝"><a href="#23-Python里的拷贝" class="headerlink" title="23 Python里的拷贝"></a>23 Python里的拷贝</h2><p>引用和copy(),deepcopy()的区别</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> copy</div><div class="line">a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, [<span class="string">'a'</span>, <span class="string">'b'</span>]]  <span class="comment">#原始对象</span></div><div class="line"></div><div class="line">b = a  <span class="comment">#赋值，传对象的引用</span></div><div class="line">c = copy.copy(a)  <span class="comment">#对象拷贝，浅拷贝</span></div><div class="line">d = copy.deepcopy(a)  <span class="comment">#对象拷贝，深拷贝</span></div><div class="line"></div><div class="line">a.append(<span class="number">5</span>)  <span class="comment">#修改对象a</span></div><div class="line">a[<span class="number">4</span>].append(<span class="string">'c'</span>)  <span class="comment">#修改对象a中的['a', 'b']数组对象</span></div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">'a = '</span>, a</div><div class="line"><span class="keyword">print</span> <span class="string">'b = '</span>, b</div><div class="line"><span class="keyword">print</span> <span class="string">'c = '</span>, c</div><div class="line"><span class="keyword">print</span> <span class="string">'d = '</span>, d</div><div class="line"></div><div class="line">输出结果：</div><div class="line">a =  [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>], <span class="number">5</span>]</div><div class="line">b =  [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>], <span class="number">5</span>]</div><div class="line">c =  [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>]]</div><div class="line">d =  [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, [<span class="string">'a'</span>, <span class="string">'b'</span>]]</div></pre></td></tr></table></figure>
<h2 id="24-Python垃圾回收机制"><a href="#24-Python垃圾回收机制" class="headerlink" title="24 Python垃圾回收机制"></a>24 Python垃圾回收机制</h2><p>Python GC主要使用引用计数（reference counting）来跟踪和回收垃圾。在引用计数的基础上，通过“标记-清除”（mark and sweep）解决容器对象可能产生的循环引用问题，通过“分代回收”（generation collection）以空间换时间的方法提高垃圾回收效率。</p>
<h3 id="1-引用计数"><a href="#1-引用计数" class="headerlink" title="1 引用计数"></a>1 引用计数</h3><p>PyObject是每个对象必有的内容，其中<code>ob_refcnt</code>就是做为引用计数。当一个对象有新的引用时，它的<code>ob_refcnt</code>就会增加，当引用它的对象被删除，它的<code>ob_refcnt</code>就会减少.引用计数为0时，该对象生命就结束了。</p>
<p>优点:</p>
<ol>
<li>简单</li>
<li>实时性</li>
</ol>
<p>缺点:</p>
<ol>
<li>维护引用计数消耗资源</li>
<li>循环引用</li>
</ol>
<h3 id="2-标记-清除机制"><a href="#2-标记-清除机制" class="headerlink" title="2 标记-清除机制"></a>2 标记-清除机制</h3><p>基本思路是先按需分配，等到没有空闲内存的时候从寄存器和程序栈上的引用出发，遍历以对象为节点、以引用为边构成的图，把所有可以访问到的对象打上标记，然后清扫一遍内存空间，把所有没标记的对象释放。</p>
<h3 id="3-分代技术"><a href="#3-分代技术" class="headerlink" title="3 分代技术"></a>3 分代技术</h3><p>分代回收的整体思想是：将系统中的所有内存块根据其存活时间划分为不同的集合，每个集合就成为一个“代”，垃圾收集频率随着“代”的存活时间的增大而减小，存活时间通常利用经过几次垃圾回收来度量。</p>
<p>Python默认定义了三代对象集合，索引数越大，对象存活时间越长。</p>
<p>举例：<br>当某些内存块M经过了3次垃圾收集的清洗之后还存活时，我们就将内存块M划到一个集合A中去，而新分配的内存都划分到集合B中去。当垃圾收集开始工作时，大多数情况都只对集合B进行垃圾回收，而对集合A进行垃圾回收要隔相当长一段时间后才进行，这就使得垃圾收集机制需要处理的内存少了，效率自然就提高了。在这个过程中，集合B中的某些内存块由于存活时间长而会被转移到集合A中，当然，集合A中实际上也存在一些垃圾，这些垃圾的回收会因为这种分代的机制而被延迟。</p>
<h2 id="25-Python的List"><a href="#25-Python的List" class="headerlink" title="25 Python的List"></a>25 Python的List</h2><p>推荐: <a href="http://www.jianshu.com/p/J4U6rR" target="_blank" rel="external">http://www.jianshu.com/p/J4U6rR</a></p>
<h2 id="26-Python的is"><a href="#26-Python的is" class="headerlink" title="26 Python的is"></a>26 Python的is</h2><p>is是对比地址,==是对比值</p>
<h2 id="27-read-readline和readlines"><a href="#27-read-readline和readlines" class="headerlink" title="27 read,readline和readlines"></a>27 read,readline和readlines</h2><ul>
<li>read        读取整个文件</li>
<li>readline    读取下一行,使用生成器方法</li>
<li>readlines   读取整个文件到一个迭代器以供我们遍历</li>
</ul>
<h2 id="28-Python2和3的区别"><a href="#28-Python2和3的区别" class="headerlink" title="28 Python2和3的区别"></a>28 Python2和3的区别</h2><p>推荐：<a href="http://chenqx.github.io/2014/11/10/Key-differences-between-Python-2-7-x-and-Python-3-x/" target="_blank" rel="external">Python 2.7.x 与 Python 3.x 的主要差异</a></p>
<h2 id="29-super-init"><a href="#29-super-init" class="headerlink" title="29 super init"></a>29 super init</h2><p>super() lets you avoid referring to the base class explicitly, which can be nice. But the main advantage comes with multiple inheritance, where all sorts of fun stuff can happen. See the standard docs on super if you haven’t already.</p>
<p>Note that the syntax changed in Python 3.0: you can just say super().<code>__init__</code>() instead of super(ChildB, self).<code>__init__</code>() which IMO is quite a bit nicer.</p>
<p><a href="http://stackoverflow.com/questions/576169/understanding-python-super-with-init-methods" target="_blank" rel="external">http://stackoverflow.com/questions/576169/understanding-python-super-with-init-methods</a></p>
<p><a href="http://blog.csdn.net/mrlevo520/article/details/51712440" target="_blank" rel="external">Python2.7中的super方法浅见</a></p>
<h2 id="30-range-and-xrange"><a href="#30-range-and-xrange" class="headerlink" title="30 range and xrange"></a>30 range and xrange</h2><p>都在循环时使用，xrange内存性能更好。<br>for i in range(0, 20):<br>for i in xrange(0, 20):<br>What is the difference between range and xrange functions in Python 2.X?<br> range creates a list, so if you do range(1, 10000000) it creates a list in memory with 9999999 elements.<br> xrange is a sequence object that evaluates lazily.</p>
<p><a href="http://stackoverflow.com/questions/94935/what-is-the-difference-between-range-and-xrange-functions-in-python-2-x" target="_blank" rel="external">http://stackoverflow.com/questions/94935/what-is-the-difference-between-range-and-xrange-functions-in-python-2-x</a></p>
<h1 id="操作系统"><a href="#操作系统" class="headerlink" title="操作系统"></a>操作系统</h1><h2 id="1-select-poll和epoll"><a href="#1-select-poll和epoll" class="headerlink" title="1 select,poll和epoll"></a>1 select,poll和epoll</h2><p>其实所有的I/O都是轮询的方法,只不过实现的层面不同罢了.</p>
<p>这个问题可能有点深入了,但相信能回答出这个问题是对I/O多路复用有很好的了解了.其中tornado使用的就是epoll的.</p>
<p><a href="http://www.cnblogs.com/Anker/p/3265058.html" target="_blank" rel="external">selec,poll和epoll区别总结</a></p>
<p>基本上select有3个缺点:</p>
<ol>
<li>连接数受限</li>
<li>查找配对速度慢</li>
<li>数据由内核拷贝到用户态</li>
</ol>
<p>poll改善了第一个缺点</p>
<p>epoll改了三个缺点.</p>
<p>关于epoll的: <a href="http://www.cnblogs.com/my_life/articles/3968782.html" target="_blank" rel="external">http://www.cnblogs.com/my_life/articles/3968782.html</a></p>
<h2 id="2-调度算法"><a href="#2-调度算法" class="headerlink" title="2 调度算法"></a>2 调度算法</h2><ol>
<li>先来先服务(FCFS, First Come First Serve)</li>
<li>短作业优先(SJF, Shortest Job First)</li>
<li>最高优先权调度(Priority Scheduling)</li>
<li>时间片轮转(RR, Round Robin)</li>
<li>多级反馈队列调度(multilevel feedback queue scheduling)</li>
</ol>
<p>常见的调度算法总结:<a href="http://www.jianshu.com/p/6edf8174c1eb" target="_blank" rel="external">http://www.jianshu.com/p/6edf8174c1eb</a></p>
<p>实时调度算法:</p>
<ol>
<li>最早截至时间优先 EDF</li>
<li>最低松弛度优先 LLF</li>
</ol>
<h2 id="3-死锁"><a href="#3-死锁" class="headerlink" title="3 死锁"></a>3 死锁</h2><p>原因:</p>
<ol>
<li>竞争资源</li>
<li>程序推进顺序不当</li>
</ol>
<p>必要条件:</p>
<ol>
<li>互斥条件</li>
<li>请求和保持条件</li>
<li>不剥夺条件</li>
<li>环路等待条件</li>
</ol>
<p>处理死锁基本方法:</p>
<ol>
<li>预防死锁(摒弃除1以外的条件)</li>
<li>避免死锁(银行家算法)</li>
<li>检测死锁(资源分配图)</li>
<li>解除死锁<ol>
<li>剥夺资源</li>
<li>撤销进程</li>
</ol>
</li>
</ol>
<p>死锁概念处理策略详细介绍:<a href="https://wizardforcel.gitbooks.io/wangdaokaoyan-os/content/10.html" target="_blank" rel="external">https://wizardforcel.gitbooks.io/wangdaokaoyan-os/content/10.html</a></p>
<h2 id="4-程序编译与链接"><a href="#4-程序编译与链接" class="headerlink" title="4 程序编译与链接"></a>4 程序编译与链接</h2><p>推荐: <a href="http://www.ruanyifeng.com/blog/2014/11/compiler.html" target="_blank" rel="external">http://www.ruanyifeng.com/blog/2014/11/compiler.html</a></p>
<p>Bulid过程可以分解为4个步骤:预处理(Prepressing), 编译(Compilation)、汇编(Assembly)、链接(Linking)</p>
<p>以c语言为例:</p>
<h3 id="1-预处理"><a href="#1-预处理" class="headerlink" title="1 预处理"></a>1 预处理</h3><p>预编译过程主要处理那些源文件中的以“#”开始的预编译指令，主要处理规则有：</p>
<ol>
<li>将所有的“#define”删除，并展开所用的宏定义</li>
<li>处理所有条件预编译指令，比如“#if”、“#ifdef”、 “#elif”、“#endif”</li>
<li>处理“#include”预编译指令，将被包含的文件插入到该编译指令的位置，注：此过程是递归进行的</li>
<li>删除所有注释</li>
<li>添加行号和文件名标识，以便于编译时编译器产生调试用的行号信息以及用于编译时产生编译错误或警告时可显示行号</li>
<li>保留所有的#pragma编译器指令。</li>
</ol>
<h3 id="2-编译"><a href="#2-编译" class="headerlink" title="2 编译"></a>2 编译</h3><p>编译过程就是把预处理完的文件进行一系列的词法分析、语法分析、语义分析及优化后生成相应的汇编代码文件。这个过程是整个程序构建的核心部分。</p>
<h3 id="3-汇编"><a href="#3-汇编" class="headerlink" title="3 汇编"></a>3 汇编</h3><p>汇编器是将汇编代码转化成机器可以执行的指令，每一条汇编语句几乎都是一条机器指令。经过编译、链接、汇编输出的文件成为目标文件(Object File)</p>
<h3 id="4-链接"><a href="#4-链接" class="headerlink" title="4 链接"></a>4 链接</h3><p>链接的主要内容就是把各个模块之间相互引用的部分处理好，使各个模块可以正确的拼接。<br>链接的主要过程包块 地址和空间的分配（Address and Storage Allocation）、符号决议(Symbol Resolution)和重定位(Relocation)等步骤。</p>
<h2 id="5-静态链接和动态链接"><a href="#5-静态链接和动态链接" class="headerlink" title="5 静态链接和动态链接"></a>5 静态链接和动态链接</h2><p>静态链接方法：静态链接的时候，载入代码就会把程序会用到的动态代码或动态代码的地址确定下来<br>静态库的链接可以使用静态链接，动态链接库也可以使用这种方法链接导入库</p>
<p>动态链接方法：使用这种方式的程序并不在一开始就完成动态链接，而是直到真正调用动态库代码时，载入程序才计算(被调用的那部分)动态代码的逻辑地址，然后等到某个时候，程序又需要调用另外某块动态代码时，载入程序又去计算这部分代码的逻辑地址，所以，这种方式使程序初始化时间较短，但运行期间的性能比不上静态链接的程序</p>
<h2 id="6-虚拟内存技术"><a href="#6-虚拟内存技术" class="headerlink" title="6 虚拟内存技术"></a>6 虚拟内存技术</h2><p>虚拟存储器是指具有请求调入功能和置换功能,能从逻辑上对内存容量加以扩充的一种存储系统.</p>
<h2 id="7-分页和分段"><a href="#7-分页和分段" class="headerlink" title="7 分页和分段"></a>7 分页和分段</h2><p>分页: 用户程序的地址空间被划分成若干固定大小的区域，称为“页”，相应地，内存空间分成若干个物理块，页和块的大小相等。可将用户程序的任一页放在内存的任一块中，实现了离散分配。</p>
<p>分段: 将用户程序地址空间分成若干个大小不等的段，每段可以定义一组相对完整的逻辑信息。存储分配时，以段为单位，段与段在内存中可以不相邻接，也实现了离散分配。</p>
<h3 id="分页与分段的主要区别"><a href="#分页与分段的主要区别" class="headerlink" title="分页与分段的主要区别"></a>分页与分段的主要区别</h3><ol>
<li>页是信息的物理单位,分页是为了实现非连续分配,以便解决内存碎片问题,或者说分页是由于系统管理的需要.段是信息的逻辑单位,它含有一组意义相对完整的信息,分段的目的是为了更好地实现共享,满足用户的需要.</li>
<li>页的大小固定,由系统确定,将逻辑地址划分为页号和页内地址是由机器硬件实现的.而段的长度却不固定,决定于用户所编写的程序,通常由编译程序在对源程序进行编译时根据信息的性质来划分.</li>
<li>分页的作业地址空间是一维的.分段的地址空间是二维的.</li>
</ol>
<h2 id="8-页面置换算法"><a href="#8-页面置换算法" class="headerlink" title="8 页面置换算法"></a>8 页面置换算法</h2><ol>
<li>最佳置换算法OPT:不可能实现</li>
<li>先进先出FIFO</li>
<li>最近最久未使用算法LRU:最近一段时间里最久没有使用过的页面予以置换.</li>
<li>clock算法</li>
</ol>
<h2 id="9-边沿触发和水平触发"><a href="#9-边沿触发和水平触发" class="headerlink" title="9 边沿触发和水平触发"></a>9 边沿触发和水平触发</h2><p>边缘触发是指每当状态变化时发生一个 io 事件，条件触发是只要满足条件就发生一个 io 事件</p>
<h1 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h1><h2 id="1-事务"><a href="#1-事务" class="headerlink" title="1 事务"></a>1 事务</h2><p>数据库事务(Database Transaction) ，是指作为单个逻辑工作单元执行的一系列操作，要么完全地执行，要么完全地不执行。<br>彻底理解数据库事务: <a href="http://www.hollischuang.com/archives/898" target="_blank" rel="external">http://www.hollischuang.com/archives/898</a></p>
<h2 id="2-数据库索引"><a href="#2-数据库索引" class="headerlink" title="2 数据库索引"></a>2 数据库索引</h2><p>推荐: <a href="http://tech.meituan.com/mysql-index.html" target="_blank" rel="external">http://tech.meituan.com/mysql-index.html</a></p>
<p><a href="http://blog.codinglabs.org/articles/theory-of-mysql-index.html" target="_blank" rel="external">MySQL索引背后的数据结构及算法原理</a></p>
<p>聚集索引,非聚集索引,B-Tree,B+Tree,最左前缀原理</p>
<h2 id="3-Redis原理"><a href="#3-Redis原理" class="headerlink" title="3 Redis原理"></a>3 Redis原理</h2><h3 id="Redis是什么？"><a href="#Redis是什么？" class="headerlink" title="Redis是什么？"></a>Redis是什么？</h3><ol>
<li>是一个完全开源免费的key-value内存数据库 </li>
<li>通常被认为是一个数据结构服务器，主要是因为其有着丰富的数据结构 strings、map、 list、sets、 sorted sets</li>
</ol>
<h3 id="Redis数据库"><a href="#Redis数据库" class="headerlink" title="Redis数据库"></a>Redis数据库</h3><blockquote>
<p>​    通常局限点来说，Redis也以消息队列的形式存在，作为内嵌的List存在，满足实时的高并发需求。在使用缓存的时候，redis比memcached具有更多的优势，并且支持更多的数据类型，把redis当作一个中间存储系统，用来处理高并发的数据库操作</p>
</blockquote>
<ul>
<li>速度快：使用标准C写，所有数据都在内存中完成，读写速度分别达到10万/20万 </li>
<li>持久化：对数据的更新采用Copy-on-write技术，可以异步地保存到磁盘上，主要有两种策略，一是根据时间，更新次数的快照（save 300 10 ）二是基于语句追加方式(Append-only file，aof) </li>
<li>自动操作：对不同数据类型的操作都是自动的，很安全 </li>
<li>快速的主–从复制，官方提供了一个数据，Slave在21秒即完成了对Amazon网站10G key set的复制。 </li>
<li>Sharding技术： 很容易将数据分布到多个Redis实例中，数据库的扩展是个永恒的话题，在关系型数据库中，主要是以添加硬件、以分区为主要技术形式的纵向扩展解决了很多的应用场景，但随着web2.0、移动互联网、云计算等应用的兴起，这种扩展模式已经不太适合了，所以近年来，像采用主从配置、数据库复制形式的，Sharding这种技术把负载分布到多个特理节点上去的横向扩展方式用处越来越多。</li>
</ul>
<h3 id="Redis缺点"><a href="#Redis缺点" class="headerlink" title="Redis缺点"></a>Redis缺点</h3><ul>
<li>是数据库容量受到物理内存的限制,不能用作海量数据的高性能读写,因此Redis适合的场景主要局限在较小数据量的高性能操作和运算上。</li>
<li>Redis较难支持在线扩容，在集群容量达到上限时在线扩容会变得很复杂。为避免这一问题，运维人员在系统上线时必须确保有足够的空间，这对资源造成了很大的浪费。</li>
</ul>
<h2 id="4-乐观锁和悲观锁"><a href="#4-乐观锁和悲观锁" class="headerlink" title="4 乐观锁和悲观锁"></a>4 乐观锁和悲观锁</h2><p>悲观锁：假定会发生并发冲突，屏蔽一切可能违反数据完整性的操作</p>
<p>乐观锁：假设不会发生并发冲突，只在提交操作时检查是否违反数据完整性。</p>
<p>乐观锁与悲观锁的具体区别: <a href="http://www.cnblogs.com/Bob-FD/p/3352216.html" target="_blank" rel="external">http://www.cnblogs.com/Bob-FD/p/3352216.html</a></p>
<h2 id="5-MVCC"><a href="#5-MVCC" class="headerlink" title="5 MVCC"></a>5 MVCC</h2><blockquote>
<p>​    全称是Multi-Version Concurrent Control，即多版本并发控制，在MVCC协议下，每个读操作会看到一个一致性的snapshot，并且可以实现非阻塞的读。MVCC允许数据具有多个版本，这个版本可以是时间戳或者是全局递增的事务ID，在同一个时间点，不同的事务看到的数据是不同的。</p>
</blockquote>
<h3 id="MySQL的innodb引擎是如何实现MVCC的"><a href="#MySQL的innodb引擎是如何实现MVCC的" class="headerlink" title="MySQL的innodb引擎是如何实现MVCC的"></a><a href="http://lib.csdn.net/base/mysql" target="_blank" rel="external">MySQL</a>的innodb引擎是如何实现MVCC的</h3><p>innodb会为每一行添加两个字段，分别表示该行<strong>创建的版本</strong>和<strong>删除的版本</strong>，填入的是事务的版本号，这个版本号随着事务的创建不断递增。在repeated read的隔离级别（<a href="http://blog.csdn.net/chosen0ne/article/details/10036775" target="_blank" rel="external">事务的隔离级别请看这篇文章</a>）下，具体各种数据库操作的实现：</p>
<ul>
<li>select：满足以下两个条件innodb会返回该行数据：<ul>
<li>该行的创建版本号小于等于当前版本号，用于保证在select操作之前所有的操作已经执行落地。</li>
<li>该行的删除版本号大于当前版本或者为空。删除版本号大于当前版本意味着有一个并发事务将该行删除了。</li>
</ul>
</li>
<li>insert：将新插入的行的创建版本号设置为当前系统的版本号。</li>
<li>delete：将要删除的行的删除版本号设置为当前系统的版本号。</li>
<li>update：不执行原地update，而是转换成insert + delete。将旧行的删除版本号设置为当前版本号，并将新行insert同时设置创建版本号为当前版本号。</li>
</ul>
<p>其中，写操作（insert、delete和update）执行时，需要将系统版本号递增。</p>
<p>​    由于旧数据并不真正的删除，所以必须对这些数据进行清理，innodb会开启一个后台线程执行清理工作，具体的规则是将删除版本号小于当前系统版本的行删除，这个过程叫做purge。</p>
<p>通过MVCC很好的实现了事务的隔离性，可以达到repeated read级别，要实现serializable还必须加锁。</p>
<blockquote>
<p> 参考：<a href="http://blog.csdn.net/chosen0ne/article/details/18093187" target="_blank" rel="external">MVCC浅析</a></p>
</blockquote>
<h2 id="6-MyISAM和InnoDB"><a href="#6-MyISAM和InnoDB" class="headerlink" title="6 MyISAM和InnoDB"></a>6 MyISAM和InnoDB</h2><p>MyISAM 适合于一些需要大量查询的应用，但其对于有大量写操作并不是很好。甚至你只是需要update一个字段，整个表都会被锁起来，而别的进程，就算是读进程都无法操作直到读操作完成。另外，MyISAM 对于 SELECT COUNT(*) 这类的计算是超快无比的。</p>
<p>InnoDB 的趋势会是一个非常复杂的存储引擎，对于一些小的应用，它会比 MyISAM 还慢。他是它支持“行锁” ，于是在写操作比较多的时候，会更优秀。并且，他还支持更多的高级应用，比如：事务。</p>
<p>mysql 数据库引擎: <a href="http://www.cnblogs.com/0201zcr/p/5296843.html" target="_blank" rel="external">http://www.cnblogs.com/0201zcr/p/5296843.html</a><br>MySQL存储引擎－－MyISAM与InnoDB区别: <a href="https://segmentfault.com/a/1190000008227211" target="_blank" rel="external">https://segmentfault.com/a/1190000008227211</a></p>
<h1 id="网络"><a href="#网络" class="headerlink" title="网络"></a>网络</h1><h2 id="1-三次握手"><a href="#1-三次握手" class="headerlink" title="1 三次握手"></a>1 三次握手</h2><ol>
<li>客户端通过向服务器端发送一个SYN来创建一个主动打开，作为三次握手的一部分。客户端把这段连接的序号设定为随机数 A。</li>
<li>服务器端应当为一个合法的SYN回送一个SYN/ACK。ACK 的确认码应为 A+1，SYN/ACK 包本身又有一个随机序号 B。</li>
<li>最后，客户端再发送一个ACK。当服务端受到这个ACK的时候，就完成了三路握手，并进入了连接创建状态。此时包序号被设定为收到的确认号 A+1，而响应则为 B+1。</li>
</ol>
<h2 id="2-四次挥手"><a href="#2-四次挥手" class="headerlink" title="2 四次挥手"></a>2 四次挥手</h2><p><em>注意: 中断连接端可以是客户端，也可以是服务器端. 下面仅以客户端断开连接举例, 反之亦然.</em></p>
<ol>
<li>客户端发送一个数据分段, 其中的 FIN 标记设置为1. 客户端进入 FIN-WAIT 状态. 该状态下客户端只接收数据, 不再发送数据.</li>
<li>服务器接收到带有 FIN = 1 的数据分段, 发送带有 ACK = 1 的剩余数据分段, 确认收到客户端发来的 FIN 信息.</li>
<li>服务器等到所有数据传输结束, 向客户端发送一个带有 FIN = 1 的数据分段, 并进入 CLOSE-WAIT 状态, 等待客户端发来带有 ACK = 1 的确认报文.</li>
<li>客户端收到服务器发来带有 FIN = 1 的报文, 返回 ACK = 1 的报文确认, 为了防止服务器端未收到需要重发, 进入 TIME-WAIT 状态. 服务器接收到报文后关闭连接. 客户端等待 2MSL 后未收到回复, 则认为服务器成功关闭, 客户端关闭连接.</li>
</ol>
<p>图解: <a href="http://blog.csdn.net/whuslei/article/details/6667471" target="_blank" rel="external">http://blog.csdn.net/whuslei/article/details/6667471</a></p>
<h2 id="3-ARP协议"><a href="#3-ARP协议" class="headerlink" title="3 ARP协议"></a>3 ARP协议</h2><p>地址解析协议(Address Resolution Protocol)，其基本功能为透过目标设备的IP地址，查询目标的MAC地址，以保证通信的顺利进行。它是IPv4网络层必不可少的协议，不过在IPv6中已不再适用，并被邻居发现协议（NDP）所替代。</p>
<h2 id="4-urllib和urllib2的区别"><a href="#4-urllib和urllib2的区别" class="headerlink" title="4 urllib和urllib2的区别"></a>4 urllib和urllib2的区别</h2><p>这个面试官确实问过,当时答的urllib2可以Post而urllib不可以.</p>
<ol>
<li>urllib提供urlencode方法用来GET查询字符串的产生，而urllib2没有。这是为何urllib常和urllib2一起使用的原因。</li>
<li>urllib2可以接受一个Request类的实例来设置URL请求的headers，urllib仅可以接受URL。这意味着，你不可以伪装你的User Agent字符串等。</li>
</ol>
<h2 id="5-Post和Get"><a href="#5-Post和Get" class="headerlink" title="5 Post和Get"></a>5 Post和Get</h2><p><a href="http://www.cnblogs.com/nankezhishi/archive/2012/06/09/getandpost.html" target="_blank" rel="external">GET和POST有什么区别？及为什么网上的多数答案都是错的</a><br><a href="https://www.zhihu.com/question/31640769?rf=37401322" target="_blank" rel="external">知乎回答</a></p>
<p>get: <a href="http://tools.ietf.org/html/rfc2616#section-9.3" target="_blank" rel="external">RFC 2616 - Hypertext Transfer Protocol – HTTP/1.1</a><br>post: <a href="http://tools.ietf.org/html/rfc2616#section-9.5" target="_blank" rel="external">RFC 2616 - Hypertext Transfer Protocol – HTTP/1.1</a></p>
<h2 id="6-Cookie和Session"><a href="#6-Cookie和Session" class="headerlink" title="6 Cookie和Session"></a>6 Cookie和Session</h2><table>
<thead>
<tr>
<th style="text-align:left"></th>
<th style="text-align:left">Cookie</th>
<th style="text-align:left">Session</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">储存位置</td>
<td style="text-align:left">客户端</td>
<td style="text-align:left">服务器端</td>
</tr>
<tr>
<td style="text-align:left">目的</td>
<td style="text-align:left">跟踪会话，也可以保存用户偏好设置或者保存用户名密码等</td>
<td style="text-align:left">跟踪会话</td>
</tr>
<tr>
<td style="text-align:left">安全性</td>
<td style="text-align:left">不安全</td>
<td style="text-align:left">安全</td>
</tr>
</tbody>
</table>
<p>session技术是要使用到cookie的，之所以出现session技术，主要是为了安全。</p>
<h2 id="7-apache和nginx的区别"><a href="#7-apache和nginx的区别" class="headerlink" title="7 apache和nginx的区别"></a>7 apache和nginx的区别</h2><p>nginx 相对 apache 的优点：</p>
<ul>
<li>轻量级，同样起web 服务，比apache 占用更少的内存及资源</li>
<li>抗并发，nginx 处理请求是异步非阻塞的，支持更多的并发连接，而apache 则是阻塞型的，在高并发下nginx 能保持低资源低消耗高性能</li>
<li>配置简洁</li>
<li>高度模块化的设计，编写模块相对简单</li>
<li>社区活跃</li>
</ul>
<p>apache 相对nginx 的优点：</p>
<ul>
<li>rewrite ，比nginx 的rewrite 强大</li>
<li>模块超多，基本想到的都可以找到</li>
<li>少bug ，nginx 的bug 相对较多</li>
<li>超稳定</li>
</ul>
<h2 id="8-网站用户密码保存"><a href="#8-网站用户密码保存" class="headerlink" title="8 网站用户密码保存"></a>8 网站用户密码保存</h2><ol>
<li>明文保存</li>
<li>明文hash后保存,如md5</li>
<li>MD5+Salt方式,这个salt可以随机</li>
<li>知乎使用了Bcrypy(好像)加密</li>
</ol>
<h2 id="9-HTTP和HTTPS"><a href="#9-HTTP和HTTPS" class="headerlink" title="9 HTTP和HTTPS"></a>9 HTTP和HTTPS</h2><table>
<thead>
<tr>
<th style="text-align:left">状态码</th>
<th style="text-align:left">定义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">1xx 报告</td>
<td style="text-align:left">接收到请求，继续进程</td>
</tr>
<tr>
<td style="text-align:left">2xx 成功</td>
<td style="text-align:left">步骤成功接收，被理解，并被接受</td>
</tr>
<tr>
<td style="text-align:left">3xx 重定向</td>
<td style="text-align:left">为了完成请求,必须采取进一步措施</td>
</tr>
<tr>
<td style="text-align:left">4xx 客户端出错</td>
<td style="text-align:left">请求包括错的顺序或不能完成</td>
</tr>
<tr>
<td style="text-align:left">5xx 服务器出错</td>
<td style="text-align:left">服务器无法完成显然有效的请求</td>
</tr>
</tbody>
</table>
<p>403: Forbidden<br>404: Not Found</p>
<p>HTTPS握手,对称加密,非对称加密,TLS/SSL,RSA</p>
<h2 id="10-XSRF和XSS"><a href="#10-XSRF和XSS" class="headerlink" title="10 XSRF和XSS"></a>10 XSRF和XSS</h2><ul>
<li>CSRF(Cross-site request forgery)跨站请求伪造</li>
<li>XSS(Cross Site Scripting)跨站脚本攻击</li>
</ul>
<p>CSRF重点在请求,XSS重点在脚本</p>
<h2 id="11-幂等-Idempotence"><a href="#11-幂等-Idempotence" class="headerlink" title="11 幂等 Idempotence"></a>11 幂等 Idempotence</h2><p>HTTP方法的幂等性是指一次和多次请求某一个资源应该具有同样的<strong>副作用</strong>。(注意是副作用)</p>
<p><code>GET http://www.bank.com/account/123456</code>，不会改变资源的状态，不论调用一次还是N次都没有副作用。请注意，这里强调的是一次和N次具有相同的副作用，而不是每次GET的结果相同。<code>GET http://www.news.com/latest-news</code>这个HTTP请求可能会每次得到不同的结果，但它本身并没有产生任何副作用，因而是满足幂等性的。</p>
<p>DELETE方法用于删除资源，有副作用，但它应该满足幂等性。比如：<code>DELETE http://www.forum.com/article/4231</code>，调用一次和N次对系统产生的副作用是相同的，即删掉id为4231的帖子；因此，调用者可以多次调用或刷新页面而不必担心引起错误。</p>
<p>POST所对应的URI并非创建的资源本身，而是资源的接收者。比如：<code>POST http://www.forum.com/articles</code>的语义是在<code>http://www.forum.com/articles</code>下创建一篇帖子，HTTP响应中应包含帖子的创建状态以及帖子的URI。两次相同的POST请求会在服务器端创建两份资源，它们具有不同的URI；所以，POST方法不具备幂等性。</p>
<p>PUT所对应的URI是要创建或更新的资源本身。比如：<code>PUT http://www.forum/articles/4231</code>的语义是创建或更新ID为4231的帖子。对同一URI进行多次PUT的副作用和一次PUT是相同的；因此，PUT方法具有幂等性。</p>
<h2 id="12-RESTful架构-SOAP-RPC"><a href="#12-RESTful架构-SOAP-RPC" class="headerlink" title="12 RESTful架构(SOAP,RPC)"></a>12 RESTful架构(SOAP,RPC)</h2><p>推荐: <a href="http://www.ruanyifeng.com/blog/2011/09/restful.html" target="_blank" rel="external">http://www.ruanyifeng.com/blog/2011/09/restful.html</a></p>
<h2 id="13-SOAP"><a href="#13-SOAP" class="headerlink" title="13 SOAP"></a>13 SOAP</h2><p>SOAP（原为Simple Object Access Protocol的首字母缩写，即简单对象访问协议）是交换数据的一种协议规范，使用在计算机网络Web服务（web service）中，交换带结构信息。SOAP为了简化网页服务器（Web Server）从XML数据库中提取数据时，节省去格式化页面时间，以及不同应用程序之间按照HTTP通信协议，遵从XML格式执行资料互换，使其抽象于语言实现、平台和硬件。</p>
<h2 id="14-RPC"><a href="#14-RPC" class="headerlink" title="14 RPC"></a>14 RPC</h2><p>RPC（Remote Procedure Call Protocol）——远程过程调用协议，它是一种通过网络从远程计算机程序上请求服务，而不需要了解底层网络技术的协议。RPC协议假定某些传输协议的存在，如TCP或UDP，为通信程序之间携带信息数据。在OSI网络通信模型中，RPC跨越了传输层和应用层。RPC使得开发包括网络分布式多程序在内的应用程序更加容易。</p>
<p>总结:服务提供的两大流派.传统意义以方法调用为导向通称RPC。为了企业SOA,若干厂商联合推出webservice,制定了wsdl接口定义,传输soap.当互联网时代,臃肿SOA被简化为http+xml/json.但是简化出现各种混乱。以资源为导向,任何操作无非是对资源的增删改查，于是统一的REST出现了.</p>
<p>进化的顺序: RPC -&gt; SOAP -&gt; RESTful</p>
<h2 id="15-CGI和WSGI"><a href="#15-CGI和WSGI" class="headerlink" title="15 CGI和WSGI"></a>15 CGI和WSGI</h2><p>CGI是通用网关接口，是连接web服务器和应用程序的接口，用户通过CGI来获取动态数据或文件等。<br>CGI程序是一个独立的程序，它可以用几乎所有语言来写，包括perl，c，lua，python等等。</p>
<p>WSGI, Web Server Gateway Interface，是Python应用程序或框架和Web服务器之间的一种接口，WSGI的其中一个目的就是让用户可以用统一的语言(Python)编写前后端。</p>
<p>官方说明：<a href="https://www.python.org/dev/peps/pep-3333/" target="_blank" rel="external">PEP-3333</a></p>
<h2 id="16-中间人攻击"><a href="#16-中间人攻击" class="headerlink" title="16 中间人攻击"></a>16 中间人攻击</h2><p>在GFW里屡见不鲜的,呵呵.</p>
<p>中间人攻击（Man-in-the-middle attack，通常缩写为MITM）是指攻击者与通讯的两端分别创建独立的联系，并交换其所收到的数据，使通讯的两端认为他们正在通过一个私密的连接与对方直接对话，但事实上整个会话都被攻击者完全控制。</p>
<h2 id="17-c10k问题"><a href="#17-c10k问题" class="headerlink" title="17 c10k问题"></a>17 c10k问题</h2><p>所谓c10k问题，指的是服务器同时支持成千上万个客户端的问题，也就是concurrent 10 000 connection（这也是c10k这个名字的由来）。<br>推荐: <a href="https://my.oschina.net/xianggao/blog/664275" target="_blank" rel="external">https://my.oschina.net/xianggao/blog/664275</a></p>
<h2 id="18-socket"><a href="#18-socket" class="headerlink" title="18 socket"></a>18 socket</h2><p>推荐: <a href="http://www.360doc.com/content/11/0609/15/5482098_122692444.shtml" target="_blank" rel="external">http://www.360doc.com/content/11/0609/15/5482098_122692444.shtml</a></p>
<p>Socket=Ip address+ TCP/UDP + port</p>
<h2 id="19-浏览器缓存"><a href="#19-浏览器缓存" class="headerlink" title="19 浏览器缓存"></a>19 浏览器缓存</h2><p>推荐: <a href="http://www.cnblogs.com/skynet/archive/2012/11/28/2792503.html" target="_blank" rel="external">http://www.cnblogs.com/skynet/archive/2012/11/28/2792503.html</a></p>
<p>304 Not Modified</p>
<h2 id="20-HTTP1-0和HTTP1-1"><a href="#20-HTTP1-0和HTTP1-1" class="headerlink" title="20 HTTP1.0和HTTP1.1"></a>20 HTTP1.0和HTTP1.1</h2><p>推荐: <a href="http://blog.csdn.net/elifefly/article/details/3964766" target="_blank" rel="external">http://blog.csdn.net/elifefly/article/details/3964766</a></p>
<ol>
<li>请求头Host字段,一个服务器多个网站</li>
<li>长链接</li>
<li>文件断点续传</li>
<li>身份认证,状态管理,Cache缓存</li>
</ol>
<p>HTTP请求8种方法介绍<br>HTTP/1.1协议中共定义了8种HTTP请求方法，HTTP请求方法也被叫做“请求动作”，不同的方法规定了不同的操作指定的资源方式。服务端也会根据不同的请求方法做不同的响应。</p>
<p>GET</p>
<p>GET请求会显示请求指定的资源。一般来说GET方法应该只用于数据的读取，而不应当用于会产生副作用的非幂等的操作中。</p>
<p>GET会方法请求指定的页面信息，并返回响应主体，GET被认为是不安全的方法，因为GET方法会被网络蜘蛛等任意的访问。</p>
<p>HEAD</p>
<p>HEAD方法与GET方法一样，都是向服务器发出指定资源的请求。但是，服务器在响应HEAD请求时不会回传资源的内容部分，即：响应主体。这样，我们可以不传输全部内容的情况下，就可以获取服务器的响应头信息。HEAD方法常被用于客户端查看服务器的性能。</p>
<p>POST</p>
<p>POST请求会 向指定资源提交数据，请求服务器进行处理，如：表单数据提交、文件上传等，请求数据会被包含在请求体中。POST方法是非幂等的方法，因为这个请求可能会创建新的资源或/和修改现有资源。</p>
<p>PUT</p>
<p>PUT请求会身向指定资源位置上传其最新内容，PUT方法是幂等的方法。通过该方法客户端可以将指定资源的最新数据传送给服务器取代指定的资源的内容。</p>
<p>DELETE</p>
<p>DELETE请求用于请求服务器删除所请求URI（统一资源标识符，Uniform Resource Identifier）所标识的资源。DELETE请求后指定资源会被删除，DELETE方法也是幂等的。</p>
<p>CONNECT</p>
<p>CONNECT方法是HTTP/1.1协议预留的，能够将连接改为管道方式的代理服务器。通常用于SSL加密服务器的链接与非加密的HTTP代理服务器的通信。</p>
<p>OPTIONS</p>
<p>OPTIONS请求与HEAD类似，一般也是用于客户端查看服务器的性能。 这个方法会请求服务器返回该资源所支持的所有HTTP请求方法，该方法会用’*’来代替资源名称，向服务器发送OPTIONS请求，可以测试服务器功能是否正常。JavaScript的XMLHttpRequest对象进行CORS跨域资源共享时，就是使用OPTIONS方法发送嗅探请求，以判断是否有对指定资源的访问权限。 允许</p>
<p>TRACE</p>
<p>TRACE请求服务器回显其收到的请求信息，该方法主要用于HTTP请求的测试或诊断。</p>
<p>HTTP/1.1之后增加的方法</p>
<p>在HTTP/1.1标准制定之后，又陆续扩展了一些方法。其中使用中较多的是 PATCH 方法：</p>
<p>PATCH</p>
<p>PATCH方法出现的较晚，它在2010年的RFC 5789标准中被定义。PATCH请求与PUT请求类似，同样用于资源的更新。二者有以下两点不同：</p>
<p>但PATCH一般用于资源的部分更新，而PUT一般用于资源的整体更新。<br>当资源不存在时，PATCH会创建一个新的资源，而PUT只会对已在资源进行更新。</p>
<h2 id="21-Ajax"><a href="#21-Ajax" class="headerlink" title="21 Ajax"></a>21 Ajax</h2><p>AJAX,Asynchronous JavaScript and XML（异步的 JavaScript 和 XML）, 是与在不重新加载整个页面的情况下，与服务器交换数据并更新部分网页的技术。</p>
<h1 id="NIX"><a href="#NIX" class="headerlink" title="*NIX"></a>*NIX</h1><h2 id="unix进程间通信方式-IPC"><a href="#unix进程间通信方式-IPC" class="headerlink" title="unix进程间通信方式(IPC)"></a>unix进程间通信方式(IPC)</h2><ol>
<li>管道（Pipe）：管道可用于具有亲缘关系进程间的通信，允许一个进程和另一个与它有共同祖先的进程之间进行通信。</li>
<li>命名管道（named pipe）：命名管道克服了管道没有名字的限制，因此，除具有管道所具有的功能外，它还允许无亲缘关系进程间的通信。命名管道在文件系统中有对应的文件名。命名管道通过命令mkfifo或系统调用mkfifo来创建。</li>
<li>信号（Signal）：信号是比较复杂的通信方式，用于通知接受进程有某种事件发生，除了用于进程间通信外，进程还可以发送信号给进程本身；linux除了支持Unix早期信号语义函数sigal外，还支持语义符合Posix.1标准的信号函数sigaction（实际上，该函数是基于BSD的，BSD为了实现可靠信号机制，又能够统一对外接口，用sigaction函数重新实现了signal函数）。</li>
<li>消息（Message）队列：消息队列是消息的链接表，包括Posix消息队列system V消息队列。有足够权限的进程可以向队列中添加消息，被赋予读权限的进程则可以读走队列中的消息。消息队列克服了信号承载信息量少，管道只能承载无格式字节流以及缓冲区大小受限等缺</li>
<li>共享内存：使得多个进程可以访问同一块内存空间，是最快的可用IPC形式。是针对其他通信机制运行效率较低而设计的。往往与其它通信机制，如信号量结合使用，来达到进程间的同步及互斥。</li>
<li>内存映射（mapped memory）：内存映射允许任何多个进程间通信，每一个使用该机制的进程通过把一个共享的文件映射到自己的进程地址空间来实现它。</li>
<li>信号量（semaphore）：主要作为进程间以及同一进程不同线程之间的同步手段。</li>
<li>套接口（Socket）：更为一般的进程间通信机制，可用于不同机器之间的进程间通信。起初是由Unix系统的BSD分支开发出来的，但现在一般可以移植到其它类Unix系统上：Linux和System V的变种都支持套接字。</li>
</ol>
<h1 id="数据结构"><a href="#数据结构" class="headerlink" title="数据结构"></a>数据结构</h1><h2 id="1-红黑树"><a href="#1-红黑树" class="headerlink" title="1 红黑树"></a>1 红黑树</h2><p>红黑树与AVL的比较：</p>
<p>AVL是严格平衡树，因此在增加或者删除节点的时候，根据不同情况，旋转的次数比红黑树要多；</p>
<p>红黑是用非严格的平衡来换取增删节点时候旋转次数的降低；</p>
<p>所以简单说，如果你的应用中，搜索的次数远远大于插入和删除，那么选择AVL，如果搜索，插入删除次数几乎差不多，应该选择RB。</p>
<p>红黑树详解: <a href="https://xieguanglei.github.io/blog/post/red-black-tree.html" target="_blank" rel="external">https://xieguanglei.github.io/blog/post/red-black-tree.html</a></p>
<p>教你透彻了解红黑树: <a href="https://github.com/julycoding/The-Art-Of-Programming-By-July/blob/master/ebook/zh/03.01.md" target="_blank" rel="external">https://github.com/julycoding/The-Art-Of-Programming-By-July/blob/master/ebook/zh/03.01.md</a></p>
<h1 id="编程题"><a href="#编程题" class="headerlink" title="编程题"></a>编程题</h1><h2 id="1-台阶问题-斐波那契"><a href="#1-台阶问题-斐波那契" class="headerlink" title="1 台阶问题/斐波那契"></a>1 台阶问题/斐波那契</h2><p>一只青蛙一次可以跳上1级台阶，也可以跳上2级。求该青蛙跳上一个n级的台阶总共有多少种跳法。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">fib = <span class="keyword">lambda</span> n: n <span class="keyword">if</span> n &lt;= <span class="number">2</span> <span class="keyword">else</span> fib(n - <span class="number">1</span>) + fib(n - <span class="number">2</span>)</div></pre></td></tr></table></figure>
<p>第二种记忆方法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">memo</span><span class="params">(func)</span>:</span></div><div class="line">    cache = &#123;&#125;</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrap</span><span class="params">(*args)</span>:</span></div><div class="line">        <span class="keyword">if</span> args <span class="keyword">not</span> <span class="keyword">in</span> cache:</div><div class="line">            cache[args] = func(*args)</div><div class="line">        <span class="keyword">return</span> cache[args]</div><div class="line">    <span class="keyword">return</span> wrap</div><div class="line"></div><div class="line"></div><div class="line"><span class="meta">@memo</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">fib</span><span class="params">(i)</span>:</span></div><div class="line">    <span class="keyword">if</span> i &lt; <span class="number">2</span>:</div><div class="line">        <span class="keyword">return</span> <span class="number">1</span></div><div class="line">    <span class="keyword">return</span> fib(i<span class="number">-1</span>) + fib(i<span class="number">-2</span>)</div></pre></td></tr></table></figure>
<p>第三种方法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">fib</span><span class="params">(n)</span>:</span></div><div class="line">    a, b = <span class="number">0</span>, <span class="number">1</span></div><div class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> xrange(n):</div><div class="line">        a, b = b, a + b</div><div class="line">    <span class="keyword">return</span> b</div></pre></td></tr></table></figure>
<h2 id="2-变态台阶问题"><a href="#2-变态台阶问题" class="headerlink" title="2 变态台阶问题"></a>2 变态台阶问题</h2><p>一只青蛙一次可以跳上1级台阶，也可以跳上2级……它也可以跳上n级。求该青蛙跳上一个n级的台阶总共有多少种跳法。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">fib = <span class="keyword">lambda</span> n: n <span class="keyword">if</span> n &lt; <span class="number">2</span> <span class="keyword">else</span> <span class="number">2</span> * fib(n - <span class="number">1</span>)</div></pre></td></tr></table></figure>
<h2 id="3-矩形覆盖"><a href="#3-矩形覆盖" class="headerlink" title="3 矩形覆盖"></a>3 矩形覆盖</h2><p>我们可以用<code>2*1</code>的小矩形横着或者竖着去覆盖更大的矩形。请问用n个<code>2*1</code>的小矩形无重叠地覆盖一个<code>2*n</code>的大矩形，总共有多少种方法？</p>
<blockquote>
<p>第<code>2*n</code>个矩形的覆盖方法等于第<code>2*(n-1)</code>加上第<code>2*(n-2)</code>的方法。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">f = <span class="keyword">lambda</span> n: <span class="number">1</span> <span class="keyword">if</span> n &lt; <span class="number">2</span> <span class="keyword">else</span> f(n - <span class="number">1</span>) + f(n - <span class="number">2</span>)</div></pre></td></tr></table></figure>
<h2 id="4-杨氏矩阵查找"><a href="#4-杨氏矩阵查找" class="headerlink" title="4 杨氏矩阵查找"></a>4 杨氏矩阵查找</h2><p>在一个m行n列二维数组中，每一行都按照从左到右递增的顺序排序，每一列都按照从上到下递增的顺序排序。请完成一个函数，输入这样的一个二维数组和一个整数，判断数组中是否含有该整数。</p>
<p>使用Step-wise线性搜索。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_value</span><span class="params">(l, r, c)</span>:</span></div><div class="line">    <span class="keyword">return</span> l[r][c]</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">find</span><span class="params">(l, x)</span>:</span></div><div class="line">    m = len(l) - <span class="number">1</span></div><div class="line">    n = len(l[<span class="number">0</span>]) - <span class="number">1</span></div><div class="line">    r = <span class="number">0</span></div><div class="line">    c = n</div><div class="line">    <span class="keyword">while</span> c &gt;= <span class="number">0</span> <span class="keyword">and</span> r &lt;= m:</div><div class="line">        value = get_value(l, r, c)</div><div class="line">        <span class="keyword">if</span> value == x:</div><div class="line">            <span class="keyword">return</span> <span class="keyword">True</span></div><div class="line">        <span class="keyword">elif</span> value &gt; x:</div><div class="line">            c = c - <span class="number">1</span></div><div class="line">        <span class="keyword">elif</span> value &lt; x:</div><div class="line">            r = r + <span class="number">1</span></div><div class="line">    <span class="keyword">return</span> <span class="keyword">False</span></div></pre></td></tr></table></figure>
<h2 id="5-去除列表中的重复元素"><a href="#5-去除列表中的重复元素" class="headerlink" title="5 去除列表中的重复元素"></a>5 去除列表中的重复元素</h2><p>用集合</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">list(set(l))</div></pre></td></tr></table></figure>
<p>用字典</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">l1 = [<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'a'</span>,<span class="string">'a'</span>]</div><div class="line">l2 = &#123;&#125;.fromkeys(l1).keys()</div><div class="line"><span class="keyword">print</span> l2</div></pre></td></tr></table></figure>
<p>用字典并保持顺序</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">l1 = [<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'a'</span>,<span class="string">'a'</span>]</div><div class="line">l2 = list(set(l1))</div><div class="line">l2.sort(key=l1.index)</div><div class="line"><span class="keyword">print</span> l2</div></pre></td></tr></table></figure>
<p>列表推导式</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">l1 = [<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'a'</span>,<span class="string">'a'</span>]</div><div class="line">l2 = []</div><div class="line">[l2.append(i) <span class="keyword">for</span> i <span class="keyword">in</span> l1 <span class="keyword">if</span> <span class="keyword">not</span> i <span class="keyword">in</span> l2]</div></pre></td></tr></table></figure>
<p>sorted排序并且用列表推导式.</p>
<p>l = [‘b’,’c’,’d’,’b’,’c’,’a’,’a’]<br>[single.append(i) for i in sorted(l) if i not in single]<br>print single</p>
<h2 id="6-链表成对调换"><a href="#6-链表成对调换" class="headerlink" title="6 链表成对调换"></a>6 链表成对调换</h2><p><code>1-&gt;2-&gt;3-&gt;4</code>转换成<code>2-&gt;1-&gt;4-&gt;3</code>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ListNode</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, x)</span>:</span></div><div class="line">        self.val = x</div><div class="line">        self.next = <span class="keyword">None</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></div><div class="line">    <span class="comment"># @param a ListNode</span></div><div class="line">    <span class="comment"># @return a ListNode</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">swapPairs</span><span class="params">(self, head)</span>:</span></div><div class="line">        <span class="keyword">if</span> head != <span class="keyword">None</span> <span class="keyword">and</span> head.next != <span class="keyword">None</span>:</div><div class="line">            next = head.next</div><div class="line">            head.next = self.swapPairs(next.next)</div><div class="line">            next.next = head</div><div class="line">            <span class="keyword">return</span> next</div><div class="line">        <span class="keyword">return</span> head</div></pre></td></tr></table></figure>
<h2 id="7-创建字典的方法"><a href="#7-创建字典的方法" class="headerlink" title="7 创建字典的方法"></a>7 创建字典的方法</h2><h3 id="1-直接创建"><a href="#1-直接创建" class="headerlink" title="1 直接创建"></a>1 直接创建</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">dict = &#123;<span class="string">'name'</span>:<span class="string">'earth'</span>, <span class="string">'port'</span>:<span class="string">'80'</span>&#125;</div></pre></td></tr></table></figure>
<h3 id="2-工厂方法"><a href="#2-工厂方法" class="headerlink" title="2 工厂方法"></a>2 工厂方法</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">items=[(<span class="string">'name'</span>,<span class="string">'earth'</span>),(<span class="string">'port'</span>,<span class="string">'80'</span>)]</div><div class="line">dict2=dict(items)</div><div class="line">dict1=dict(([<span class="string">'name'</span>,<span class="string">'earth'</span>],[<span class="string">'port'</span>,<span class="string">'80'</span>]))</div></pre></td></tr></table></figure>
<h3 id="3-fromkeys-方法"><a href="#3-fromkeys-方法" class="headerlink" title="3 fromkeys()方法"></a>3 fromkeys()方法</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">dict1=&#123;&#125;.fromkeys((<span class="string">'x'</span>,<span class="string">'y'</span>),<span class="number">-1</span>)</div><div class="line">dict=&#123;<span class="string">'x'</span>:<span class="number">-1</span>,<span class="string">'y'</span>:<span class="number">-1</span>&#125;</div><div class="line">dict2=&#123;&#125;.fromkeys((<span class="string">'x'</span>,<span class="string">'y'</span>))</div><div class="line">dict2=&#123;<span class="string">'x'</span>:<span class="keyword">None</span>, <span class="string">'y'</span>:<span class="keyword">None</span>&#125;</div></pre></td></tr></table></figure>
<h2 id="8-合并两个有序列表"><a href="#8-合并两个有序列表" class="headerlink" title="8 合并两个有序列表"></a>8 合并两个有序列表</h2><p>知乎远程面试要求编程</p>
<blockquote>
<p> 尾递归</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">_recursion_merge_sort2</span><span class="params">(l1, l2, tmp)</span>:</span></div><div class="line">    <span class="keyword">if</span> len(l1) == <span class="number">0</span> <span class="keyword">or</span> len(l2) == <span class="number">0</span>:</div><div class="line">        tmp.extend(l1)</div><div class="line">        tmp.extend(l2)</div><div class="line">        <span class="keyword">return</span> tmp</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        <span class="keyword">if</span> l1[<span class="number">0</span>] &lt; l2[<span class="number">0</span>]:</div><div class="line">            tmp.append(l1[<span class="number">0</span>])</div><div class="line">            <span class="keyword">del</span> l1[<span class="number">0</span>]</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            tmp.append(l2[<span class="number">0</span>])</div><div class="line">            <span class="keyword">del</span> l2[<span class="number">0</span>]</div><div class="line">        <span class="keyword">return</span> _recursion_merge_sort2(l1, l2, tmp)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">recursion_merge_sort2</span><span class="params">(l1, l2)</span>:</span></div><div class="line">    <span class="keyword">return</span> _recursion_merge_sort2(l1, l2, [])</div></pre></td></tr></table></figure>
<blockquote>
<p> 循环算法</p>
</blockquote>
<p>思路：</p>
<p>定义一个新的空列表</p>
<p>比较两个列表的首个元素</p>
<p>小的就插入到新列表里</p>
<p>把已经插入新列表的元素从旧列表删除</p>
<p>直到两个旧列表有一个为空</p>
<p>再把旧列表加到新列表后面</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">def loop_merge_sort(l1, l2):</div><div class="line">    tmp = []</div><div class="line">    while len(l1) &gt; 0 and len(l2) &gt; 0:</div><div class="line">        if l1[0] &lt; l2[0]:</div><div class="line">            tmp.append(l1[0])</div><div class="line">            del l1[0]</div><div class="line">        else:</div><div class="line">            tmp.append(l2[0])</div><div class="line">            del l2[0]</div><div class="line">    tmp.extend(l1)</div><div class="line">    tmp.extend(l2)</div><div class="line">    return tmp</div></pre></td></tr></table></figure>
<blockquote>
<p>pop弹出</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">a = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">7</span>]</div><div class="line">b = [<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">merge_sortedlist</span><span class="params">(a,b)</span>:</span></div><div class="line">    c = []</div><div class="line">    <span class="keyword">while</span> a <span class="keyword">and</span> b:</div><div class="line">        <span class="keyword">if</span> a[<span class="number">0</span>] &gt;= b[<span class="number">0</span>]:</div><div class="line">            c.append(b.pop(<span class="number">0</span>))</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            c.append(a.pop(<span class="number">0</span>))</div><div class="line">    <span class="keyword">while</span> a:</div><div class="line">        c.append(a.pop(<span class="number">0</span>))</div><div class="line">    <span class="keyword">while</span> b:</div><div class="line">        c.append(b.pop(<span class="number">0</span>))</div><div class="line">    <span class="keyword">return</span> c</div><div class="line"><span class="keyword">print</span> merge_sortedlist(a,b)</div></pre></td></tr></table></figure>
<h2 id="9-交叉链表求交点"><a href="#9-交叉链表求交点" class="headerlink" title="9 交叉链表求交点"></a>9 交叉链表求交点</h2><blockquote>
<p>其实思想可以按照从尾开始比较两个链表，如果相交，则从尾开始必然一致，只要从尾开始比较，直至不一致的地方即为交叉点，如图所示</p>
</blockquote>
<p><img src="http://hi.csdn.net/attachment/201106/28/0_1309244136MWLP.gif" alt=""></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 使用a,b两个list来模拟链表，可以看出交叉点是 7这个节点</span></div><div class="line">a = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">1</span>,<span class="number">5</span>]</div><div class="line">b = [<span class="number">4</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">1</span>,<span class="number">5</span>]</div><div class="line"></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,min(len(a),len(b))):</div><div class="line">    <span class="keyword">if</span> i==<span class="number">1</span> <span class="keyword">and</span> (a[<span class="number">-1</span>] != b[<span class="number">-1</span>]):</div><div class="line">        <span class="keyword">print</span> <span class="string">"No"</span></div><div class="line">        <span class="keyword">break</span></div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        <span class="keyword">if</span> a[-i] != b[-i]:</div><div class="line">            <span class="keyword">print</span> <span class="string">"交叉节点："</span>,a[-i+<span class="number">1</span>]</div><div class="line">            <span class="keyword">break</span></div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            <span class="keyword">pass</span></div></pre></td></tr></table></figure>
<blockquote>
<p>另外一种比较正规的方法，构造链表类</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ListNode</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, x)</span>:</span></div><div class="line">        self.val = x</div><div class="line">        self.next = <span class="keyword">None</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">node</span><span class="params">(l1, l2)</span>:</span></div><div class="line">    length1, lenth2 = <span class="number">0</span>, <span class="number">0</span></div><div class="line">    <span class="comment"># 求两个链表长度</span></div><div class="line">    <span class="keyword">while</span> l1.next:</div><div class="line">        l1 = l1.next</div><div class="line">        length1 += <span class="number">1</span></div><div class="line">    <span class="keyword">while</span> l2.next:</div><div class="line">        l2 = l2.next</div><div class="line">        length2 += <span class="number">1</span></div><div class="line">    <span class="comment"># 长的链表先走</span></div><div class="line">    <span class="keyword">if</span> length1 &gt; lenth2:</div><div class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> range(length1 - length2):</div><div class="line">            l1 = l1.next</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> range(length2 - length1):</div><div class="line">            l2 = l2.next</div><div class="line">    <span class="keyword">while</span> l1 <span class="keyword">and</span> l2:</div><div class="line">        <span class="keyword">if</span> l1.next == l2.next:</div><div class="line">            <span class="keyword">return</span> l1.next</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            l1 = l1.next</div><div class="line">            l2 = l2.next</div></pre></td></tr></table></figure>
<p>修改了一下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#coding:utf-8</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ListNode</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, x)</span>:</span></div><div class="line">        self.val = x</div><div class="line">        self.next = <span class="keyword">None</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">node</span><span class="params">(l1, l2)</span>:</span></div><div class="line">    length1, length2 = <span class="number">0</span>, <span class="number">0</span></div><div class="line">    <span class="comment"># 求两个链表长度</span></div><div class="line">    <span class="keyword">while</span> l1.next:</div><div class="line">        l1 = l1.next<span class="comment">#尾节点</span></div><div class="line">        length1 += <span class="number">1</span></div><div class="line">    <span class="keyword">while</span> l2.next:</div><div class="line">        l2 = l2.next<span class="comment">#尾节点</span></div><div class="line">        length2 += <span class="number">1</span></div><div class="line"></div><div class="line">    <span class="comment">#如果相交</span></div><div class="line">    <span class="keyword">if</span> l1.next == l2.next:</div><div class="line">        <span class="comment"># 长的链表先走</span></div><div class="line">        <span class="keyword">if</span> length1 &gt; length2:</div><div class="line">            <span class="keyword">for</span> _ <span class="keyword">in</span> range(length1 - length2):</div><div class="line">                l1 = l1.next</div><div class="line">            <span class="keyword">return</span> l1<span class="comment">#返回交点</span></div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            <span class="keyword">for</span> _ <span class="keyword">in</span> range(length2 - length1):</div><div class="line">                l2 = l2.next</div><div class="line">            <span class="keyword">return</span> l2<span class="comment">#返回交点</span></div><div class="line">    <span class="comment"># 如果不相交</span></div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        <span class="keyword">return</span></div></pre></td></tr></table></figure>
<p>思路: <a href="http://humaoli.blog.163.com/blog/static/13346651820141125102125995/" target="_blank" rel="external">http://humaoli.blog.163.com/blog/static/13346651820141125102125995/</a></p>
<h2 id="10-二分查找"><a href="#10-二分查找" class="headerlink" title="10 二分查找"></a>10 二分查找</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">#coding:utf-8</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">binary_search</span><span class="params">(list,item)</span>:</span></div><div class="line">    low = <span class="number">0</span></div><div class="line">    high = len(list)<span class="number">-1</span></div><div class="line">    <span class="keyword">while</span> low&lt;=high:</div><div class="line">        mid = (low+high)/<span class="number">2</span></div><div class="line">        guess = list[mid]</div><div class="line">        <span class="keyword">if</span> guess&gt;item:</div><div class="line">            high = mid<span class="number">-1</span></div><div class="line">        <span class="keyword">elif</span> guess&lt;item:</div><div class="line">            low = mid+<span class="number">1</span></div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            <span class="keyword">return</span> mid</div><div class="line">    <span class="keyword">return</span> <span class="keyword">None</span></div><div class="line">mylist = [<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">9</span>]</div><div class="line"><span class="keyword">print</span> binary_search(mylist,<span class="number">3</span>)</div></pre></td></tr></table></figure>
<p>参考: <a href="http://blog.csdn.net/u013205877/article/details/76411718" target="_blank" rel="external">http://blog.csdn.net/u013205877/article/details/76411718</a></p>
<h2 id="11-快排"><a href="#11-快排" class="headerlink" title="11 快排"></a>11 快排</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#coding:utf-8</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">quicksort</span><span class="params">(list)</span>:</span></div><div class="line">    <span class="keyword">if</span> len(list)&lt;<span class="number">2</span>:</div><div class="line">        <span class="keyword">return</span> list</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        midpivot = list[<span class="number">0</span>]</div><div class="line">        lessbeforemidpivot = [i <span class="keyword">for</span> i <span class="keyword">in</span> list[<span class="number">1</span>:] <span class="keyword">if</span> i&lt;=midpivot]</div><div class="line">        biggerafterpivot = [i <span class="keyword">for</span> i <span class="keyword">in</span> list[<span class="number">1</span>:] <span class="keyword">if</span> i &gt; midpivot]</div><div class="line">        finallylist = quicksort(lessbeforemidpivot)+[midpivot]+quicksort(biggerafterpivot)</div><div class="line">        <span class="keyword">return</span> finallylist</div><div class="line"></div><div class="line"><span class="keyword">print</span> quicksort([<span class="number">2</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">5</span>])</div></pre></td></tr></table></figure>
<blockquote>
<p> 更多排序问题可见：<a href="http://blog.csdn.net/mrlevo520/article/details/77829204" target="_blank" rel="external">数据结构与算法-排序篇-Python描述</a></p>
</blockquote>
<h2 id="12-找零问题"><a href="#12-找零问题" class="headerlink" title="12 找零问题"></a>12 找零问题</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">#coding:utf-8</span></div><div class="line"><span class="comment">#values是硬币的面值values = [ 25, 21, 10, 5, 1]</span></div><div class="line"><span class="comment">#valuesCounts   钱币对应的种类数</span></div><div class="line"><span class="comment">#money  找出来的总钱数</span></div><div class="line"><span class="comment">#coinsUsed   对应于目前钱币总数i所使用的硬币数目</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">coinChange</span><span class="params">(values,valuesCounts,money,coinsUsed)</span>:</span></div><div class="line">    <span class="comment">#遍历出从1到money所有的钱数可能</span></div><div class="line">    <span class="keyword">for</span> cents <span class="keyword">in</span> range(<span class="number">1</span>,money+<span class="number">1</span>):</div><div class="line">        minCoins = cents</div><div class="line">        <span class="comment">#把所有的硬币面值遍历出来和钱数做对比</span></div><div class="line">        <span class="keyword">for</span> kind <span class="keyword">in</span> range(<span class="number">0</span>,valuesCounts):</div><div class="line">            <span class="keyword">if</span> (values[kind] &lt;= cents):</div><div class="line">                temp = coinsUsed[cents - values[kind]] +<span class="number">1</span></div><div class="line">                <span class="keyword">if</span> (temp &lt; minCoins):</div><div class="line">                    minCoins = temp</div><div class="line">        coinsUsed[cents] = minCoins</div><div class="line">        <span class="keyword">print</span> (<span class="string">'面值:&#123;0&#125;的最少硬币使用数为:&#123;1&#125;'</span>.format(cents, coinsUsed[cents]))</div></pre></td></tr></table></figure>
<p>思路: <a href="http://blog.csdn.net/wdxin1322/article/details/9501163" target="_blank" rel="external">http://blog.csdn.net/wdxin1322/article/details/9501163</a></p>
<p>方法: <a href="http://www.cnblogs.com/ChenxofHit/archive/2011/03/18/1988431.html" target="_blank" rel="external">http://www.cnblogs.com/ChenxofHit/archive/2011/03/18/1988431.html</a></p>
<h2 id="13-广度遍历和深度遍历二叉树"><a href="#13-广度遍历和深度遍历二叉树" class="headerlink" title="13 广度遍历和深度遍历二叉树"></a>13 广度遍历和深度遍历二叉树</h2><p>给定一个数组，构建二叉树，并且按层次打印这个二叉树</p>
<h2 id="14-二叉树节点"><a href="#14-二叉树节点" class="headerlink" title="14 二叉树节点"></a>14 二叉树节点</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Node</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, data, left=None, right=None)</span>:</span></div><div class="line">        self.data = data</div><div class="line">        self.left = left</div><div class="line">        self.right = right</div><div class="line"></div><div class="line">tree = Node(<span class="number">1</span>, Node(<span class="number">3</span>, Node(<span class="number">7</span>, Node(<span class="number">0</span>)), Node(<span class="number">6</span>)), Node(<span class="number">2</span>, Node(<span class="number">5</span>), Node(<span class="number">4</span>)))</div></pre></td></tr></table></figure>
<h2 id="15-层次遍历"><a href="#15-层次遍历" class="headerlink" title="15 层次遍历"></a>15 层次遍历</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">lookup</span><span class="params">(root)</span>:</span></div><div class="line">    stack = [root]</div><div class="line">    <span class="keyword">while</span> stack:</div><div class="line">        current = stack.pop(<span class="number">0</span>)</div><div class="line">        <span class="keyword">print</span> current.data</div><div class="line">        <span class="keyword">if</span> current.left:</div><div class="line">            stack.append(current.left)</div><div class="line">        <span class="keyword">if</span> current.right:</div><div class="line">            stack.append(current.right)</div></pre></td></tr></table></figure>
<h2 id="16-深度遍历"><a href="#16-深度遍历" class="headerlink" title="16 深度遍历"></a>16 深度遍历</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">deep</span><span class="params">(root)</span>:</span></div><div class="line">    <span class="keyword">if</span> <span class="keyword">not</span> root:</div><div class="line">        <span class="keyword">return</span></div><div class="line">    <span class="keyword">print</span> root.data</div><div class="line">    deep(root.left)</div><div class="line">    deep(root.right)</div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    lookup(tree)</div><div class="line">    deep(tree)</div></pre></td></tr></table></figure>
<h2 id="17-前中后序遍历"><a href="#17-前中后序遍历" class="headerlink" title="17 前中后序遍历"></a>17 前中后序遍历</h2><p>深度遍历改变顺序就OK了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">#coding:utf-8</span></div><div class="line"><span class="comment">#二叉树的遍历</span></div><div class="line"><span class="comment">#简单的二叉树节点类</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Node</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,value,left,right)</span>:</span></div><div class="line">        self.value = value</div><div class="line">        self.left = left</div><div class="line">        self.right = right</div><div class="line"></div><div class="line"><span class="comment">#中序遍历:遍历左子树,访问当前节点,遍历右子树</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">mid_travelsal</span><span class="params">(root)</span>:</span></div><div class="line">    <span class="keyword">if</span> root.left <span class="keyword">is</span> <span class="keyword">None</span>:</div><div class="line">        mid_travelsal(root.left)</div><div class="line">    <span class="comment">#访问当前节点</span></div><div class="line">    print(root.value)</div><div class="line">    <span class="keyword">if</span> root.right <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</div><div class="line">        mid_travelsal(root.right)</div><div class="line"></div><div class="line"><span class="comment">#前序遍历:访问当前节点,遍历左子树,遍历右子树</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">pre_travelsal</span><span class="params">(root)</span>:</span></div><div class="line">    <span class="keyword">print</span> (root.value)</div><div class="line">    <span class="keyword">if</span> root.left <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</div><div class="line">        pre_travelsal(root.left)</div><div class="line">    <span class="keyword">if</span> root.right <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</div><div class="line">        pre_travelsal(root.right)</div><div class="line"></div><div class="line"><span class="comment">#后续遍历:遍历左子树,遍历右子树,访问当前节点</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">post_trvelsal</span><span class="params">(root)</span>:</span></div><div class="line">    <span class="keyword">if</span> root.left <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</div><div class="line">        post_trvelsal(root.left)</div><div class="line">    <span class="keyword">if</span> root.right <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</div><div class="line">        post_trvelsal(root.right)</div><div class="line">    <span class="keyword">print</span> (root.value)</div></pre></td></tr></table></figure>
<h2 id="18-求最大树深"><a href="#18-求最大树深" class="headerlink" title="18 求最大树深"></a>18 求最大树深</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">maxDepth</span><span class="params">(root)</span>:</span></div><div class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</div><div class="line">            <span class="keyword">return</span> <span class="number">0</span></div><div class="line">        <span class="keyword">return</span> max(maxDepth(root.left), maxDepth(root.right)) + <span class="number">1</span></div></pre></td></tr></table></figure>
<h2 id="19-求两棵树是否相同"><a href="#19-求两棵树是否相同" class="headerlink" title="19 求两棵树是否相同"></a>19 求两棵树是否相同</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">isSameTree</span><span class="params">(p, q)</span>:</span></div><div class="line">    <span class="keyword">if</span> p == <span class="keyword">None</span> <span class="keyword">and</span> q == <span class="keyword">None</span>:</div><div class="line">        <span class="keyword">return</span> <span class="keyword">True</span></div><div class="line">    <span class="keyword">elif</span> p <span class="keyword">and</span> q :</div><div class="line">        <span class="keyword">return</span> p.val == q.val <span class="keyword">and</span> isSameTree(p.left,q.left) <span class="keyword">and</span> isSameTree(p.right,q.right)</div><div class="line">    <span class="keyword">else</span> :</div><div class="line">        <span class="keyword">return</span> <span class="keyword">False</span></div></pre></td></tr></table></figure>
<h2 id="20-前序中序求后序"><a href="#20-前序中序求后序" class="headerlink" title="20 前序中序求后序"></a>20 前序中序求后序</h2><p>推荐: <a href="http://blog.csdn.net/hinyunsin/article/details/6315502" target="_blank" rel="external">http://blog.csdn.net/hinyunsin/article/details/6315502</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">rebuild</span><span class="params">(pre, center)</span>:</span></div><div class="line">    <span class="keyword">if</span> <span class="keyword">not</span> pre:</div><div class="line">        <span class="keyword">return</span></div><div class="line">    cur = Node(pre[<span class="number">0</span>])</div><div class="line">    index = center.index(pre[<span class="number">0</span>])</div><div class="line">    cur.left = rebuild(pre[<span class="number">1</span>:index + <span class="number">1</span>], center[:index])</div><div class="line">    cur.right = rebuild(pre[index + <span class="number">1</span>:], center[index + <span class="number">1</span>:])</div><div class="line">    <span class="keyword">return</span> cur</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">deep</span><span class="params">(root)</span>:</span></div><div class="line">    <span class="keyword">if</span> <span class="keyword">not</span> root:</div><div class="line">        <span class="keyword">return</span></div><div class="line">    deep(root.left)</div><div class="line">    deep(root.right)</div><div class="line">    <span class="keyword">print</span> root.data</div></pre></td></tr></table></figure>
<h2 id="21-单链表逆置"><a href="#21-单链表逆置" class="headerlink" title="21 单链表逆置"></a>21 单链表逆置</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Node</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, data=None, next=None)</span>:</span></div><div class="line">        self.data = data</div><div class="line">        self.next = next</div><div class="line"></div><div class="line">link = Node(<span class="number">1</span>, Node(<span class="number">2</span>, Node(<span class="number">3</span>, Node(<span class="number">4</span>, Node(<span class="number">5</span>, Node(<span class="number">6</span>, Node(<span class="number">7</span>, Node(<span class="number">8</span>, Node(<span class="number">9</span>)))))))))</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">rev</span><span class="params">(link)</span>:</span></div><div class="line">    pre = link</div><div class="line">    cur = link.next</div><div class="line">    pre.next = <span class="keyword">None</span></div><div class="line">    <span class="keyword">while</span> cur:</div><div class="line">        tmp = cur.next</div><div class="line">        cur.next = pre</div><div class="line">        pre = cur</div><div class="line">        cur = tmp</div><div class="line">    <span class="keyword">return</span> pre</div><div class="line"></div><div class="line">root = rev(link)</div><div class="line"><span class="keyword">while</span> root:</div><div class="line">    <span class="keyword">print</span> root.data</div><div class="line">    root = root.next</div></pre></td></tr></table></figure>
<p>思路: <a href="http://blog.csdn.net/feliciafay/article/details/6841115" target="_blank" rel="external">http://blog.csdn.net/feliciafay/article/details/6841115</a></p>
<p>方法: <a href="http://www.xuebuyuan.com/2066385.html?mobile=1" target="_blank" rel="external">http://www.xuebuyuan.com/2066385.html?mobile=1</a></p>
<h2 id="22-两个字符串是否是变位词"><a href="#22-两个字符串是否是变位词" class="headerlink" title="22 两个字符串是否是变位词"></a>22 两个字符串是否是变位词</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Anagram</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    @:param s1: The first string</div><div class="line">    @:param s2: The second string</div><div class="line">    @:return true or false</div><div class="line">    """</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Solution1</span><span class="params">(s1,s2)</span>:</span></div><div class="line">        alist = list(s2)</div><div class="line"></div><div class="line">        pos1 = <span class="number">0</span></div><div class="line">        stillOK = <span class="keyword">True</span></div><div class="line"></div><div class="line">        <span class="keyword">while</span> pos1 &lt; len(s1) <span class="keyword">and</span> stillOK:</div><div class="line">            pos2 = <span class="number">0</span></div><div class="line">            found = <span class="keyword">False</span></div><div class="line">            <span class="keyword">while</span> pos2 &lt; len(alist) <span class="keyword">and</span> <span class="keyword">not</span> found:</div><div class="line">                <span class="keyword">if</span> s1[pos1] == alist[pos2]:</div><div class="line">                    found = <span class="keyword">True</span></div><div class="line">                <span class="keyword">else</span>:</div><div class="line">                    pos2 = pos2 + <span class="number">1</span></div><div class="line"></div><div class="line">            <span class="keyword">if</span> found:</div><div class="line">                alist[pos2] = <span class="keyword">None</span></div><div class="line">            <span class="keyword">else</span>:</div><div class="line">                stillOK = <span class="keyword">False</span></div><div class="line"></div><div class="line">            pos1 = pos1 + <span class="number">1</span></div><div class="line"></div><div class="line">        <span class="keyword">return</span> stillOK</div><div class="line"></div><div class="line">    print(Solution1(<span class="string">'abcd'</span>,<span class="string">'dcba'</span>))</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Solution2</span><span class="params">(s1,s2)</span>:</span></div><div class="line">        alist1 = list(s1)</div><div class="line">        alist2 = list(s2)</div><div class="line"></div><div class="line">        alist1.sort()</div><div class="line">        alist2.sort()</div><div class="line"></div><div class="line"></div><div class="line">        pos = <span class="number">0</span></div><div class="line">        matches = <span class="keyword">True</span></div><div class="line"></div><div class="line">        <span class="keyword">while</span> pos &lt; len(s1) <span class="keyword">and</span> matches:</div><div class="line">            <span class="keyword">if</span> alist1[pos] == alist2[pos]:</div><div class="line">                pos = pos + <span class="number">1</span></div><div class="line">            <span class="keyword">else</span>:</div><div class="line">                matches = <span class="keyword">False</span></div><div class="line"></div><div class="line">        <span class="keyword">return</span> matches</div><div class="line"></div><div class="line">    print(Solution2(<span class="string">'abcde'</span>,<span class="string">'edcbg'</span>))</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Solution3</span><span class="params">(s1,s2)</span>:</span></div><div class="line">        c1 = [<span class="number">0</span>]*<span class="number">26</span></div><div class="line">        c2 = [<span class="number">0</span>]*<span class="number">26</span></div><div class="line"></div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(s1)):</div><div class="line">            pos = ord(s1[i])-ord(<span class="string">'a'</span>)</div><div class="line">            c1[pos] = c1[pos] + <span class="number">1</span></div><div class="line"></div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(s2)):</div><div class="line">            pos = ord(s2[i])-ord(<span class="string">'a'</span>)</div><div class="line">            c2[pos] = c2[pos] + <span class="number">1</span></div><div class="line"></div><div class="line">        j = <span class="number">0</span></div><div class="line">        stillOK = <span class="keyword">True</span></div><div class="line">        <span class="keyword">while</span> j&lt;<span class="number">26</span> <span class="keyword">and</span> stillOK:</div><div class="line">            <span class="keyword">if</span> c1[j] == c2[j]:</div><div class="line">                j = j + <span class="number">1</span></div><div class="line">            <span class="keyword">else</span>:</div><div class="line">                stillOK = <span class="keyword">False</span></div><div class="line"></div><div class="line">        <span class="keyword">return</span> stillOK</div><div class="line"></div><div class="line">    print(Solution3(<span class="string">'apple'</span>,<span class="string">'pleap'</span>))</div></pre></td></tr></table></figure>
<h2 id="23-动态规划问题"><a href="#23-动态规划问题" class="headerlink" title="23 动态规划问题"></a>23 动态规划问题</h2><blockquote>
<p> 可参考：<a href="http://blog.csdn.net/mrlevo520/article/details/75676160" target="_blank" rel="external">动态规划(DP)的整理-Python描述</a></p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
&lt;p&gt;&lt;strong&gt;原创申明&lt;/strong&gt;：本文转载博主&lt;a href=&quot;https://github.com/taizilongxu&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;taizilongxu&lt;/a&gt;的文章&lt;a href=&quot;https
    
    </summary>
    
      <category term="Python" scheme="http://202.104.112.179:8085/categories/Python/"/>
    
    
      <category term="Python" scheme="http://202.104.112.179:8085/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>Python设计模式</title>
    <link href="http://202.104.112.179:8085/2018/02/28/python-pattern/"/>
    <id>http://202.104.112.179:8085/2018/02/28/python-pattern/</id>
    <published>2018-02-28T05:10:02.000Z</published>
    <updated>2018-03-06T08:59:37.186Z</updated>
    
    <content type="html"><![CDATA[<hr>
<p><strong>转载申明</strong>：本文转载博主<a href="https://github.com/taizilongxu" target="_blank" rel="external">taizilongxu</a>的文章<a href="https://github.com/taizilongxu/interview_python/blob/master/pattern.md" target="_blank" rel="external">Python设计模式</a>，转载请注明出处！</p>
<hr>
<p>代码直戳: <a href="https://github.com/faif/python-patterns" target="_blank" rel="external">https://github.com/faif/python-patterns</a></p>
<h1 id="创建型模式"><a href="#创建型模式" class="headerlink" title="创建型模式"></a>创建型模式</h1><h2 id="工厂方法"><a href="#工厂方法" class="headerlink" title="工厂方法"></a>工厂方法</h2><p>实例 -&gt; 类 -&gt; 类工厂</p>
<h2 id="抽象工厂"><a href="#抽象工厂" class="headerlink" title="抽象工厂"></a>抽象工厂</h2><p>简单来说就是把一些具有相同方法的类再进行封装,抽象共同的方法以供调用.是工厂方法的进阶版本.</p>
<p>实例 -&gt; 类 -&gt; 类工厂 -&gt; 抽象工厂</p>
<h2 id="惰性初始化-Lazy-evaluation"><a href="#惰性初始化-Lazy-evaluation" class="headerlink" title="惰性初始化 Lazy evaluation"></a>惰性初始化 Lazy evaluation</h2><p>这个Python里可以使用@property实现,就是当调用的时候才生成.</p>
<h2 id="生成器-Builder"><a href="#生成器-Builder" class="headerlink" title="生成器 Builder"></a>生成器 Builder</h2><img src="/2018/02/28/python-pattern/builder.png" alt="builder.png" title="">
<p>Builder模式主要用于构建一个复杂的对象，但这个对象构建的算法是稳定的，对象中的各个部分经常变化。Builder模式主要在于应对复杂对象各个部分的频繁需求变动。但是难以应对算法的需求变动。这点一定要注意，如果用错了，会带来很多不必要的麻烦。</p>
<p>重点是将复杂对象的建造过程抽象出来（抽象类别），使这个抽象过程的不同实现方法可以构造出不同表现（属性）的对象。</p>
<p>简单的说：子对象变化较频繁，对算法相对稳定。</p>
<h2 id="单例模式-Singleton"><a href="#单例模式-Singleton" class="headerlink" title="单例模式 Singleton"></a>单例模式 Singleton</h2><p>一个类只有一个实例</p>
<h2 id="原型模式"><a href="#原型模式" class="headerlink" title="原型模式"></a>原型模式</h2><p>特点是通过复制一个已经存在的实例来返回新的实例,而不是新建实例.</p>
<p>多用于创建复杂的或者耗时的实例,因为这种情况下,复制一个已经存在的实例使程序运行更高效;或者创建值相等,只是命名不一样的同类数据.</p>
<h2 id="对象池-Object-pool"><a href="#对象池-Object-pool" class="headerlink" title="对象池 Object pool"></a>对象池 Object pool</h2><p>一个对象池是一组已经初始化过且可以使用的对象，而可以不用在有需求时创建和销毁对象。池的用户可以从池子中取得对象，对其进行操作处理，并在不需要时归还给池子而非销毁 而不是销毁它. </p>
<p>在Python内部实现了对象池技术.例如像小整型这样的数据引用非常多,创建销毁都会消耗时间,所以保存在对象池里,减少开销.</p>
<h1 id="结构型模式"><a href="#结构型模式" class="headerlink" title="结构型模式"></a>结构型模式</h1><h2 id="修饰模型-Decorator"><a href="#修饰模型-Decorator" class="headerlink" title="修饰模型 Decorator"></a>修饰模型 Decorator</h2><p>Python里就是装饰器.</p>
<h2 id="代理模式-Proxy"><a href="#代理模式-Proxy" class="headerlink" title="代理模式 Proxy"></a>代理模式 Proxy</h2><p>例如Python里的引用计数.</p>
<h1 id="行为型模式"><a href="#行为型模式" class="headerlink" title="行为型模式"></a>行为型模式</h1><h2 id="迭代器"><a href="#迭代器" class="headerlink" title="迭代器"></a>迭代器</h2><p>迭代容器里所有的元素.</p>
]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
&lt;p&gt;&lt;strong&gt;转载申明&lt;/strong&gt;：本文转载博主&lt;a href=&quot;https://github.com/taizilongxu&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;taizilongxu&lt;/a&gt;的文章&lt;a href=&quot;https
    
    </summary>
    
      <category term="Python" scheme="http://202.104.112.179:8085/categories/Python/"/>
    
    
      <category term="Python" scheme="http://202.104.112.179:8085/tags/Python/"/>
    
      <category term="设计模式" scheme="http://202.104.112.179:8085/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>Openstack-Swift部署指南</title>
    <link href="http://202.104.112.179:8085/2018/01/19/Openstack-Swift-intall/"/>
    <id>http://202.104.112.179:8085/2018/01/19/Openstack-Swift-intall/</id>
    <published>2018-01-19T07:00:55.000Z</published>
    <updated>2018-01-19T08:22:15.628Z</updated>
    
    <content type="html"><![CDATA[<hr>
<p><strong>原创申明</strong>：本文为博主原创，转载请注明出处！</p>
<hr>
<h4 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h4><ul>
<li><p>硬件</p>
<p>  这里只使用了一台服务器，既作为Controller Node，也作为Storage Node</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>主机名</th>
<th>IP</th>
<th>OS</th>
<th>磁盘</th>
<th>文件系统</th>
</tr>
</thead>
<tbody>
<tr>
<td>sf-dev</td>
<td>10.202.127.4</td>
<td>Centos-7.4</td>
<td>/dev/sdb<br>/dev/sdc<br>/dev/sdd</td>
<td>XFS</td>
</tr>
</tbody>
</table>
<ul>
<li><p>软件</p>
<p>  我们使用<a href="https://mirrors.tuna.tsinghua.edu.cn/centos/7/cloud/x86_64/openstack-pike/" target="_blank" rel="external">Openstack Pike</a>版本</p>
</li>
<li><p>配置可用的Openstack源</p>
<p>  这里使用了清华开源镜像。配置服务器镜像：</p>
<pre><code>cd /etc/yum.repos.d/
vim CentOS-Base.repo
</code></pre><p>  增加如下配置</p>
<pre><code>...
[openstack]
name=Openstack
baseurl=https://mirrors.tuna.tsinghua.edu.cn/centos/7/cloud/x86_64/openstack-pike/
gpgcheck=0
...
</code></pre><p>  使用YUM跟新库</p>
<pre><code>yum update -y
</code></pre></li>
</ul>
<h4 id="Swift组件安装于配置"><a href="#Swift组件安装于配置" class="headerlink" title="Swift组件安装于配置"></a>Swift组件安装于配置</h4><p><strong>1. 安装必要的组件包</strong></p>
<pre><code># yum install openstack-swift-proxy python-swiftclient \
  python-keystoneclient python-keystonemiddleware \
  memcached
</code></pre><ul>
<li><p>从Swift源镜像获取代理服务配置文件,并进行配置</p>
<pre><code># curl -o /etc/swift/proxy-server.conf https://git.openstack.org/cgit/openstack/swift/plain/etc/proxy-server.conf-sample?h=stable/pike
</code></pre><p>  编辑代理服务器配置文件<code style="color:#e74c3c; padding:1px 3px; border: solid 1px #e1e4e5">/etc/swift/proxy-server.conf</code> </p>
<ol>
<li><p>编辑 <code style="color:#e74c3c; padding:1px 3px; border: solid 1px #e1e4e5">[DEFAULT]</code> 段内容，配置如下内容</p>
<pre><code>[DEFAULT]
...
bind_port = 8080
user = swift
swift_dir = /etc/swift
</code></pre></li>
<li><p>编辑 <code style="color:#e74c3c; padding:1px 3px; border: solid 1px #e1e4e5">[pipeline:main]</code></p>
<pre><code>[pipeline:main]
pipeline = catch_errors gatekeeper healthcheck proxy-logging cache container_sync bulk tempurl ratelimit tempauth copy container-quotas account-quotas slo dlo versioned_writes proxy-logging proxy-server    
</code></pre></li>
<li><p>编辑 <code style="color:#e74c3c; padding:1px 3px; border: solid 1px #e1e4e5">[app:proxy-server]</code> 段内容，允许自动创建账户</p>
<pre><code>[app:proxy-server]
use = egg:swift#proxy
...
account_autocreate = True
</code></pre></li>
<li><p>在 <code style="color:#e74c3c; padding:1px 3px; border: solid 1px #e1e4e5">[filter:tempauth]</code> 段中，设置允许的的账户/用户</p>
<pre><code>[filter:tempauth]
...
user_admin_admin = admin .admin .reseller_admin
user_test_tester = testing .admin
</code></pre></li>
<li><p>在 <code style="color:#e74c3c; padding:1px 3px; border: solid 1px #e1e4e5">[filter:cache]</code> 段中，设置memcache位置</p>
<pre><code>[filter:cache]
use = egg:swift#memcache
...
memcache_servers = 127.0.0.1:11211
</code></pre></li>
</ol>
</li>
</ul>
<blockquote>
<p><font color="red"><strong>注意：</strong></font>如果控制节点与存储节点分离，以上配置只需在控制节点进行配置，如果使用keystone请参考配置说明，更详细的说明请阅读<a href="https://docs.openstack.org/swift/latest/install/index.html" target="_blank" rel="external">官方文档</a></p>
</blockquote>
<p><strong>2. 存储节点组件包安装于配置说明</strong></p>
<ul>
<li><p>安装实用软件包</p>
<pre><code># yum install xfsprogs rsync
</code></pre></li>
<li><p>格式化磁盘</p>
<pre><code># mkfs.xfs /dev/sdb -f
# mkfs.xfs /dev/sdc -f
# mkfs.xfs /dev/sdd -f
</code></pre></li>
<li><p>创建mount点</p>
<pre><code># mkdir -p /srv/node/sdb
# mkdir -p /srv/node/sdc
# mkdir -p /srv/node/sdd
</code></pre></li>
<li><p>编辑 <code style="color:#e74c3c; padding:1px 3px; border: solid 1px #e1e4e5">/etc/fstab</code> 文件，添加如下内容：</p>
<pre><code>/dev/sdb /srv/node/sdb xfs noatime,nodiratime,nobarrier,logbufs=8 0 2
/dev/sdc /srv/node/sdc xfs noatime,nodiratime,nobarrier,logbufs=8 0 2
/dev/sdd /srv/node/sdd xfs noatime,nodiratime,nobarrier,logbufs=8 0 2
</code></pre></li>
<li><p>Mount 设备</p>
<pre><code># mount /srv/node/sdb
# mount /srv/node/sdc
# mount /srv/node/sdd
</code></pre></li>
<li><p>创建并编辑 <code style="color:#e74c3c; padding:1px 3px; border: solid 1px #e1e4e5">/etc/rsyncd.conf</code> 文件，内容如下：</p>
<pre><code>uid = swift
gid = swift
log file = /var/log/rsyncd.log
pid file = /var/run/rsyncd.pid
address = 10.202.127.4 #控制节点IP

[account]
max connections = 2
path = /srv/node/
read only = False
lock file = /var/lock/account.lock

[container]
max connections = 2
path = /srv/node/
read only = False
lock file = /var/lock/container.lock

[object]
max connections = 2
path = /srv/node/
read only = False
lock file = /var/lock/object.lock
</code></pre></li>
<li><p>存储节点软件包安装</p>
<pre><code># yum install openstack-swift-account openstack-swift-container \
  openstack-swift-object
</code></pre></li>
<li><p>从Swift源镜像获取账户(accounting)、容器(container)以及对象(object)服务配置文件,并进行配置</p>
<pre><code># curl -o /etc/swift/account-server.conf https://git.openstack.org/cgit/openstack/swift/plain/etc/account-server.conf-sample?h=stable/pike
# curl -o /etc/swift/container-server.conf https://git.openstack.org/cgit/openstack/swift/plain/etc/container-server.conf-sample?h=stable/pike
# curl -o /etc/swift/object-server.conf https://git.openstack.org/cgit/openstack/swift/plain/etc/object-server.conf-sample?h=stable/pike
</code></pre></li>
<li><p>编辑账户服务配置文件 <code style="color:#e74c3c; padding:1px 3px; border: solid 1px #e1e4e5">/etc/swift/account-server.conf</code></p>
<ol>
<li><p>在 <code style="color:#e74c3c; padding:1px 3px; border: solid 1px #e1e4e5">[DEFAULT]</code> 中配置如下信息：</p>
<pre><code>[DEFAULT]
...
bind_ip = 10.202.127.4
bind_port = 6202
user = swift
swift_dir = /etc/swift
devices = /srv/node
mount_check = True
</code></pre></li>
<li><p>编辑 <code style="color:#e74c3c; padding:1px 3px; border: solid 1px #e1e4e5">[pipeline:main]</code></p>
<pre><code>[pipeline:main]
pipeline = healthcheck recon account-server
</code></pre></li>
<li><p>在 <code style="color:#e74c3c; padding:1px 3px; border: solid 1px #e1e4e5">[filter:recon]</code> 中，设置recon cache 目录:</p>
<pre><code>[filter:recon]
use = egg:swift#recon
...
recon_cache_path = /var/cache/swift
</code></pre></li>
</ol>
</li>
<li><p>编辑账户服务配置文件 <code style="color:#e74c3c; padding:1px 3px; border: solid 1px #e1e4e5">/etc/swift/container-server.conf</code></p>
<ol>
<li><p>在 <code style="color:#e74c3c; padding:1px 3px; border: solid 1px #e1e4e5">[DEFAULT]</code> 中配置如下信息：</p>
<pre><code>[DEFAULT]
...
bind_ip = 10.202.127.4
bind_port = 6201
user = swift
swift_dir = /etc/swift
devices = /srv/node
mount_check = True
</code></pre></li>
<li><p>编辑 <code style="color:#e74c3c; padding:1px 3px; border: solid 1px #e1e4e5">[pipeline:main]</code></p>
<pre><code>[pipeline:main]
pipeline = healthcheck recon container-server
</code></pre></li>
<li><p>在 <code style="color:#e74c3c; padding:1px 3px; border: solid 1px #e1e4e5">[filter:recon]</code> 中，设置recon cache 目录:</p>
<pre><code>[filter:recon]
use = egg:swift#recon
...
recon_cache_path = /var/cache/swift
</code></pre></li>
</ol>
</li>
<li><p>编辑账户服务配置文件 <code style="color:#e74c3c; padding:1px 3px; border: solid 1px #e1e4e5">/etc/swift/object-server.conf</code></p>
<ol>
<li><p>在 <code style="color:#e74c3c; padding:1px 3px; border: solid 1px #e1e4e5">[DEFAULT]</code> 中配置如下信息：</p>
<pre><code>[DEFAULT]
...
bind_ip = 10.202.127.4
bind_port = 6200
user = swift
swift_dir = /etc/swift
devices = /srv/node
mount_check = True
</code></pre></li>
<li><p>编辑 <code style="color:#e74c3c; padding:1px 3px; border: solid 1px #e1e4e5">[pipeline:main]</code></p>
<pre><code>[pipeline:main]
pipeline = healthcheck recon object-server
</code></pre></li>
<li><p>在 <code style="color:#e74c3c; padding:1px 3px; border: solid 1px #e1e4e5">[filter:recon]</code> 中，设置recon cache 目录:</p>
<pre><code>[filter:recon]
use = egg:swift#recon
...
recon_cache_path = /var/cache/swift
recon_lock_path = /var/lock
</code></pre></li>
</ol>
</li>
<li><p>Mount 点目录所属权限设置</p>
<pre><code># chown -R swift:swift /srv/node
</code></pre></li>
<li><p>创建 <code style="color:#e74c3c; padding:1px 3px; border: solid 1px #e1e4e5">recon</code>目录，并设置目录所属权限</p>
<pre><code># mkdir -p /var/cache/swift
# chown -R root:swift /var/cache/swift
# chmod -R 775 /var/cache/swift
</code></pre></li>
</ul>
<p><strong>3. 创建Rings</strong></p>
<p>在启动对象存储服务前，需要创建并初始化account，container，object的rings。这里使用一个region，1个zone。总共设置2^10（1024）个最大分区（partitions），使用3副本策略（replicas），设置1小时来限制需要多次移动分区时为最小间隔</p>
<ul>
<li><p>创建account ring</p>
<pre><code>cd /etc/swift
# swift-ring-builder account.builder create 10 3 1
</code></pre><p>  添加所有存储到ring</p>
<pre><code># swift-ring-builder account.builder add \
  --region 1 --zone 1 --ip 10.202.127.4 --port 6202 --device sdb --weight 100
# swift-ring-builder account.builder add \
  --region 1 --zone 1 --ip 10.202.127.4 --port 6202 --device sdc --weight 100
# swift-ring-builder account.builder add \
  --region 1 --zone 1 --ip 10.202.127.4 --port 6202 --device sdd --weight 100
</code></pre><p>  Rebalance the ring</p>
<pre><code># swift-ring-builder account.builder rebalance
</code></pre><p>  确认ring</p>
<pre><code># swift-ring-builder account.builder
</code></pre></li>
<li><p>创建container ring</p>
<pre><code>cd /etc/swift
# swift-ring-builder container.builder create 10 3 1
</code></pre><p>  添加所有存储到ring</p>
<pre><code># swift-ring-builder container.builder add \
  --region 1 --zone 1 --ip 10.202.127.4 --port 6201 --device sdb --weight 100
# swift-ring-builder container.builder add \
  --region 1 --zone 1 --ip 10.202.127.4 --port 6201 --device sdc --weight 100
# swift-ring-builder container.builder add \
  --region 1 --zone 1 --ip 10.202.127.4 --port 6201 --device sdd --weight 100
</code></pre><p>  Rebalance the ring</p>
<pre><code># swift-ring-builder container.builder rebalance
</code></pre><p>  确认ring</p>
<pre><code># swift-ring-builder container.builder
</code></pre></li>
<li><p>创建object ring</p>
<pre><code>cd /etc/swift
# swift-ring-builder object.builder create 10 3 1
</code></pre><p>  添加所有存储到ring</p>
<pre><code># swift-ring-builder object.builder add \
  --region 1 --zone 1 --ip 10.202.127.4 --port 6200 --device sdb --weight 100
# swift-ring-builder object.builder add \
  --region 1 --zone 1 --ip 10.202.127.4 --port 6200 --device sdc --weight 100
# swift-ring-builder object.builder add \
  --region 1 --zone 1 --ip 10.202.127.4 --port 6200 --device sdd --weight 100
</code></pre><p>  Rebalance the ring</p>
<pre><code># swift-ring-builder object.builder rebalance
</code></pre><p>  确认ring</p>
<pre><code># swift-ring-builder object.builder
</code></pre></li>
</ul>
<blockquote>
<p><font color="red"><strong>注意：</strong></font>如果有多个存储节点，需要将ring配置文件 <code style="color:#e74c3c; padding:1px 3px; border: solid 1px #e1e4e5">account.ring.gz</code>, <code style="color:#e74c3c; padding:1px 3px; border: solid 1px #e1e4e5">container.ring.gz</code>，<code style="color:#e74c3c; padding:1px 3px; border: solid 1px #e1e4e5">object.ring.gz</code> 分发到各个存储节点的 <code style="color:#e74c3c; padding:1px 3px; border: solid 1px #e1e4e5">/etc/swift</code> 目录下</p>
</blockquote>
<p><strong>3. 配置swift.conf 并启动各组件服务</strong></p>
<ul>
<li><p>从swift git仓库中获取配置文件到 <code style="color:#e74c3c; padding:1px 3px; border: solid 1px #e1e4e5">/etc/swift/</code> 目录</p>
<pre><code># curl -o /etc/swift/swift.conf \
  https://git.openstack.org/cgit/openstack/swift/plain/etc/swift.conf-sample?h=stable/pike
</code></pre><p>  编辑配置文件<code style="color:#e74c3c; padding:1px 3px; border: solid 1px #e1e4e5">/etc/swift/swift.conf</code></p>
<ol>
<li><p>在 <code style="color:#e74c3c; padding:1px 3px; border: solid 1px #e1e4e5">[swift-hash]</code> 中，设置如下内容：</p>
<pre><code>[swift-hash]
...
swift_hash_path_suffix = HASH_PATH_SUFFIX #替换为自己的内容，如swift
swift_hash_path_prefix = HASH_PATH_PREFIX #替换为自己的内容，如swift
</code></pre></li>
<li><p>创建并配置默认策略</p>
<pre><code>[storage-policy:0]
...
name = Policy-0
default = yes
</code></pre></li>
<li><p>如果是多存储节点，将配置文件 <code style="color:#e74c3c; padding:1px 3px; border: solid 1px #e1e4e5">swift.conf</code> 拷贝到各节点的 <code style="color:#e74c3c; padding:1px 3px; border: solid 1px #e1e4e5">/etc/swift</code> 目录下</p>
</li>
<li><p>修改所有节点 <code style="color:#e74c3c; padding:1px 3px; border: solid 1px #e1e4e5">/etc/swift/</code> 目录所属权限如下：</p>
<pre><code># chown -R root:swift /etc/swift
</code></pre></li>
</ol>
</li>
<li><p>控制节点启动代理服务和memcache服务</p>
<pre><code># systemctl enable openstack-swift-proxy.service memcached.service
# systemctl start openstack-swift-proxy.service memcached.service
</code></pre></li>
<li><p>存储节点启动如下服务</p>
<pre><code># systemctl enable openstack-swift-account.service openstack-swift-account-auditor.service \
  openstack-swift-account-reaper.service openstack-swift-account-replicator.service
# systemctl start openstack-swift-account.service openstack-swift-account-auditor.service \
  openstack-swift-account-reaper.service openstack-swift-account-replicator.service
# systemctl enable openstack-swift-container.service \
  openstack-swift-container-auditor.service openstack-swift-container-replicator.service \
  openstack-swift-container-updater.service
# systemctl start openstack-swift-container.service \
  openstack-swift-container-auditor.service openstack-swift-container-replicator.service \
  openstack-swift-container-updater.service
# systemctl enable openstack-swift-object.service openstack-swift-object-auditor.service \
  openstack-swift-object-replicator.service openstack-swift-object-updater.service
# systemctl start openstack-swift-object.service openstack-swift-object-auditor.service \
  openstack-swift-object-replicator.service openstack-swift-object-updater.service
</code></pre></li>
</ul>
<h4 id="服务验证"><a href="#服务验证" class="headerlink" title="服务验证"></a>服务验证</h4><p>新建并编辑 <code style="color:#e74c3c; padding:1px 3px; border: solid 1px #e1e4e5">testrc</code> 文件</p>
<pre><code>cd $HOME
vim testrc
</code></pre><p>写入 <code style="color:#e74c3c; padding:1px 3px; border: solid 1px #e1e4e5">/etc/swift/proxy-server.conf</code> 配置文件中 配置的用户权限信息，如下：</p>
<pre><code>export ST_AUTH=http://10.202.127.4:8080/auth/v1.0
export ST_USER=test:tester
export ST_KEY=testing
</code></pre><p>执行上诉配置脚本，使配置信息生效</p>
<pre><code>. testrc
</code></pre><p>查看swift服务状态</p>
<pre><code>swift stat
</code></pre><p>获取 <code style="color:#e74c3c; padding:1px 3px; border: solid 1px #e1e4e5">X-Storage-Url</code> 和 <code style="color:#e74c3c; padding:1px 3px; border: solid 1px #e1e4e5">X-Auth-Token</code>：</p>
<pre><code>curl -v -H &apos;X-Storage-User: test:tester&apos; -H &apos;X-Storage-Pass: testing&apos; http://127.0.0.1:8080/auth/v1.0
</code></pre><p>查看账户</p>
<pre><code>curl -v -H &apos;X-Auth-Token: &lt;token-from-x-auth-token-above&gt;&apos; &lt;url-from-x-storage-url-above&gt;
</code></pre><p>我们可以使用如下命令获取账户下容器列表</p>
<pre><code>swift list
</code></pre><p>获取容器下的对象列表</p>
<pre><code>swift list &lt;container&gt;
</code></pre>]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
&lt;p&gt;&lt;strong&gt;原创申明&lt;/strong&gt;：本文为博主原创，转载请注明出处！&lt;/p&gt;
&lt;hr&gt;
&lt;h4 id=&quot;环境&quot;&gt;&lt;a href=&quot;#环境&quot; class=&quot;headerlink&quot; title=&quot;环境&quot;&gt;&lt;/a&gt;环境&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;硬件&lt;/p
    
    </summary>
    
      <category term="分布式存储" scheme="http://202.104.112.179:8085/categories/%E5%88%86%E5%B8%83%E5%BC%8F%E5%AD%98%E5%82%A8/"/>
    
      <category term="运维操作" scheme="http://202.104.112.179:8085/categories/%E5%88%86%E5%B8%83%E5%BC%8F%E5%AD%98%E5%82%A8/%E8%BF%90%E7%BB%B4%E6%93%8D%E4%BD%9C/"/>
    
      <category term="Swift" scheme="http://202.104.112.179:8085/categories/%E5%88%86%E5%B8%83%E5%BC%8F%E5%AD%98%E5%82%A8/%E8%BF%90%E7%BB%B4%E6%93%8D%E4%BD%9C/Swift/"/>
    
    
      <category term="openstack swift" scheme="http://202.104.112.179:8085/tags/openstack-swift/"/>
    
      <category term="对象存储" scheme="http://202.104.112.179:8085/tags/%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8/"/>
    
  </entry>
  
  <entry>
    <title>笔记</title>
    <link href="http://202.104.112.179:8085/2017/09/11/notobook/"/>
    <id>http://202.104.112.179:8085/2017/09/11/notobook/</id>
    <published>2017-09-11T06:03:07.000Z</published>
    <updated>2017-09-11T08:33:53.725Z</updated>
    
    <content type="html"><![CDATA[<hr>
<p><strong>原创申明</strong>：本文为博主原创，转载请注明出处！</p>
<hr>
<h4 id="pip安装理想python包"><a href="#pip安装理想python包" class="headerlink" title="pip安装理想python包"></a>pip安装理想python包</h4><h5 id="准备python包"><a href="#准备python包" class="headerlink" title="准备python包"></a>准备python包</h5><p>在一台可以连网得服务器上，编写requirements文件，或者根据已经安装好的包生成requirements文件。</p>
<pre><code>pip list #查看安装的包
pip freeze &gt;requirements.txt
pip download -d /data/packages -r requirements.txt
</code></pre><h5 id="离线情况安装打包好的包"><a href="#离线情况安装打包好的包" class="headerlink" title="离线情况安装打包好的包"></a>离线情况安装打包好的包</h5><p>将packages文件夹和requirement.txt拷贝至离线机器上目录下</p>
<pre><code>pip install --no-index --find-index=/data/packages -r requirements.txt
</code></pre>]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
&lt;p&gt;&lt;strong&gt;原创申明&lt;/strong&gt;：本文为博主原创，转载请注明出处！&lt;/p&gt;
&lt;hr&gt;
&lt;h4 id=&quot;pip安装理想python包&quot;&gt;&lt;a href=&quot;#pip安装理想python包&quot; class=&quot;headerlink&quot; title=&quot;pip安装理想p
    
    </summary>
    
      <category term="笔记" scheme="http://202.104.112.179:8085/categories/%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="操作命令" scheme="http://202.104.112.179:8085/tags/%E6%93%8D%E4%BD%9C%E5%91%BD%E4%BB%A4/"/>
    
  </entry>
  
  <entry>
    <title>vuejs-study-1</title>
    <link href="http://202.104.112.179:8085/2017/08/15/vuejs-study-1/"/>
    <id>http://202.104.112.179:8085/2017/08/15/vuejs-study-1/</id>
    <published>2017-08-15T01:18:54.000Z</published>
    <updated>2017-08-15T01:29:20.148Z</updated>
    
    <content type="html"><![CDATA[<hr>
<p><strong>转载申明</strong>：本文转载博主<a href="http://www.xheldon.com" target="_blank" rel="external">Xheldon</a>的文章<a href="http://www.xheldon.com/vue-learning-summary.html" target="_blank" rel="external">Vue学习总结</a>，转载请注明出处！</p>
<hr>
<p>这篇文章从Vue 2.0官方文档的”实例”一节开始, 研究一些 Vue API 的使用方法, 以及 Vue 实现一些功能的原理, 此外还有自己的使用感受, 以及站在自己浅薄的角度分析 Vue 为什么要这么设计的不敬之举, 如有得罪还请海涵, 刚接触 Vue 不久, 不当之处烦请指出, 先行谢过。</p>
<blockquote>
<p><strong>注意</strong>: 基础知识直接略过, 我只说我认为需要说的点。</p>
</blockquote>
<h4 id="Vue实例"><a href="#Vue实例" class="headerlink" title="Vue实例"></a>Vue实例</h4><p>每个 Vue.js 的应用都是通过构造函数创建一个 Vue 的根实例启动的, 意思就是, 每个页面的数据都应该只由这一个实例维护, 原始数据的来源都应该只由根实例来发出和接收统一管理, 根实例再通过 props, 分发数据, 或者 events 来监听数据. 子组件只需要 watch/computed 数据变化, 及时更新即可。</p>
<p>文档中说了一句话叫: 所有的 Vue.js 组件其实都是被扩展的 Vue 实例, 这句话正确理解起来应该是, 你可以在组件上使用和实例一样的方法和钩子函数, 除了 data 。</p>
<p>组件中的 data, 必须是一个函数, 因为组件会被复用, 所以必须每次调用组件都生成一份数据。</p>
<p>数据代理(proxy), 指的是 Vue 实例会代理其 data 对象中的所有属性, 而实例属性 $data 则表示 data 属性本身, 以区别被代理的 data。</p>
<p>意思是, 如果一个 vm 的 data 属性为 {a: ‘xheldon’}, 那么 vm.a 即为 ‘xheldon’, 而 vm.$data 则为 {a: ‘xheldon’}。</p>
<p>组件其实也是一个(被扩展的) Vue 实例, 下面是个简单的验证:</p>
<p>有一个 list.vue 组件(template 和 style 省略)：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span>&#123;</div><div class="line">  data()&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span> <span class="keyword">instanceof</span> Vue);<span class="comment">//true</span></div><div class="line">    <span class="keyword">return</span> &#123;&#125;</div><div class="line">  &#125;</div><div class="line">  name: <span class="string">'com-list'</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="props-vs-data"><a href="#props-vs-data" class="headerlink" title="props vs data"></a>props vs data</h4><p>初始化组件的时候, prop 上的属性和 data 上的属性以及 computed 的方法, 都被绑定到 Vue 实例上了, 但是 porps 上的属性, 优先级比 data 同名属性要高,下面是验证:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="keyword">default</span>&#123;</div><div class="line">  data()&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'first:'</span>,<span class="keyword">this</span>);<span class="comment">//list 的实例</span></div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      <span class="attr">a</span>: <span class="string">'a'</span>,<span class="comment">//属性 a 代表的值挂在 data 上, 但是被下面的 prop 属性同名覆盖(查看上面控制台输出的内容即可)</span></div><div class="line">      d: <span class="string">'d'</span></div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">props</span>: [<span class="string">'a'</span>],<span class="comment">//和 data 中的 a 属性同名, 因此来自父级的数据将 data 中的同名属性 a 上的数据覆盖.(注:父级是根组件, 挂载在一个实例上)</span></div><div class="line">  name: <span class="string">'com-list'</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>结果出现警告(不是报错, 不影响渲染):</p>
<img src="/2017/08/15/vuejs-study-1/props-vs-data.png" alt="props-vs-data.png" title="">
<p>而 computed 返回的函数名和 data 上的属性名可以重复, 并且不会有任何提示, 但是同名覆盖了之后, 因为在初始化的时候, 从控制台可以看到 _data 后于 _computedWatcher 来设置这个重复属性的 getter 和 setter(不知道是不是这个原因, 先放在这个地方以待我深入研究之后再修改这篇文章), 因此导致了被覆盖. 相关原理可以看<a href="https://juejin.im/entry/577639de165abd00547b0924" target="_blank" rel="external">这篇介绍</a></p>
<p>它们都在初始化的时候绑定到了实例 属性 上, 同名的 computed 属性被覆盖了, 但是 Vue devtool 仍然正确显示了出来)</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="keyword">default</span>&#123;</div><div class="line">  data()&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'first:'</span>,<span class="keyword">this</span>);<span class="comment">//list 的实例</span></div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      <span class="attr">ab</span>: <span class="string">'a'</span>,<span class="comment">//属性 a 代表的值挂在 data 上, 但是被下面的 prop 属性同名覆盖(查看上面控制台输出的内容即可)</span></div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">computed</span>: &#123;</div><div class="line">    ab()&#123;</div><div class="line">      <span class="keyword">return</span> <span class="string">'computed a'</span>;<span class="comment">//方法名跟 data 上的 a 属性同名, 因此console 出来的 this 不会出现它的值, 用花括号输出的时候也是输出的 data 上的同名属性</span></div><div class="line">    &#125;,</div><div class="line">    f()&#123;</div><div class="line">      <span class="keyword">return</span> <span class="string">'computed f'</span><span class="comment">//方法名没有重复的, 因此 console 出来的 this 会有它的同名属性, 且值为 'computed f', 我们提供的 function 被作为该属性的 getter(计算属性默认只有 getter, 可以手动添加 setter)</span></div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">name</span>: <span class="string">'com-list'</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<img src="/2017/08/15/vuejs-study-1/computed-vs-data1.png" alt="computed-vs-data1.png" title="">
<p>Vue devtool 正确显示了出来:</p>
<img src="/2017/08/15/vuejs-study-1/computed-vs-data3.png" alt="computed-vs-data3.png" title="">
]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
&lt;p&gt;&lt;strong&gt;转载申明&lt;/strong&gt;：本文转载博主&lt;a href=&quot;http://www.xheldon.com&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Xheldon&lt;/a&gt;的文章&lt;a href=&quot;http://www.xheldo
    
    </summary>
    
      <category term="前端技术" scheme="http://202.104.112.179:8085/categories/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/"/>
    
      <category term="Vue" scheme="http://202.104.112.179:8085/categories/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/Vue/"/>
    
    
      <category term="前端" scheme="http://202.104.112.179:8085/tags/%E5%89%8D%E7%AB%AF/"/>
    
      <category term="WVVM" scheme="http://202.104.112.179:8085/tags/WVVM/"/>
    
      <category term="Vue" scheme="http://202.104.112.179:8085/tags/Vue/"/>
    
  </entry>
  
  <entry>
    <title>Vue.js学习-搭建一个简单的demo</title>
    <link href="http://202.104.112.179:8085/2017/08/10/vuejs-demo/"/>
    <id>http://202.104.112.179:8085/2017/08/10/vuejs-demo/</id>
    <published>2017-08-10T02:17:19.000Z</published>
    <updated>2017-08-10T12:29:05.039Z</updated>
    
    <content type="html"><![CDATA[<hr>
<p><strong>原创申明</strong>：本文为博主原创，转载请注明出处！</p>
<hr>
<p>这里主要记录vue.js+webpack在一个简单实例中的使用过程</p>
<blockquote>
<p><strong>说明</strong>：本次搭建基于Win 7平台</p>
</blockquote>
<h3 id="Node-js-安装"><a href="#Node-js-安装" class="headerlink" title="Node.js 安装"></a>Node.js 安装</h3><p><a href="https://nodejs.org/zh-cn/download/" target="_blank" rel="external">官网</a>提供了支持多种平台的的LTS版本下载，我们根据需要来进行下载安装。对于Windows平台提供了.mis和.zip(二进制)两种选择，我们可以根据自己需要任选一种安装。具体安装过程就不详说。</p>
<blockquote>
<p><strong>注意</strong>：为了使用方便，我们需要检测PATH环境变量是否配置了Node.js。点击开始=》运行=》输入“cmd”=》输入命令“path”（我们也可以直接使用命令win+R输入“cmd”=》输入命令“path”），输出如下结果：</p>
<pre><code>C:\Users\01107267&gt;path
PATH=C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\;
D:\Program Files\java\jdk1.8.0-windows-x64\bin;D:\Program Files\java\jdk1.8.0-windows-x64\jre\bin;
D:\Program Files\TortoiseSVN\bin;D:\Program Files\apache-maven-3.3.9\bin;D:\Program Files\gradle-2.2.1\BIN;
D:\Python27\Scripts;D:\Python27\;D:\Program Files\nodejs\;D:\Program Files\nodejs\node_global;
</code></pre><p>我们看到环境变量中已经包含了D:\Program Files\nodejs，我们可以检查一下Node.js版本</p>
<pre><code>C:\Users\01107267&gt;node --version
v6.9.4
</code></pre><p>我们可以看到有这样一个路径在Node.js目录下还有一个npm，这是Nodejs中的包管理工具，它是随Nodejs一起安装的</p>
<pre><code>C:\Users\01107267&gt;npm -v
3.10.10
</code></pre><p>这里需要说明的是可以看到还有一个路径D:\Program Files\nodejs\node_global;这个路径是说将npm安装时指定全局安装的包放在该路径下，比如后面我们会用的webpack，我们可以去到该目录看一下</p>
<pre><code>D:\Program Files&gt;cd nodejs

D:\Program Files\nodejs&gt;dir
 驱动器 D 中的卷没有标签。
 卷的序列号是 0005-FCB7

 D:\Program Files\nodejs 的目录

2017/03/12  11:52&lt;DIR .
2017/03/12  11:52&lt;DIR ..
2017/01/05  21:0018,513,048 node.exe
2016/12/22  18:01   702 nodevars.bat
2017/08/07  19:29&lt;DIR node_cache
2017/01/05  20:46 8,997 node_etw_provider.man
2017/08/08  09:49&lt;DIR node_global
2017/01/16  10:57&lt;DIR node_modules
2016/12/22  18:01 4,974 node_perfctr_provider.man
2016/11/16  19:45   867 npm
2016/11/16  19:45   483 npm.cmd
   6 个文件 18,529,071 字节
   5 个目录 146,669,424,640 可用字节

D:\Program Files\nodejs&gt;cd node_global

D:\Program Files\nodejs\node_global&gt;dir
 驱动器 D 中的卷没有标签。
 卷的序列号是 0005-FCB7

 D:\Program Files\nodejs\node_global 的目录

2017/08/08  09:49&lt;DIR .
2017/08/08  09:49&lt;DIR ..
2017/03/12  11:56&lt;DIR etc
2017/08/08  09:49&lt;DIR node_modules
2017/08/07  17:46   321 vue
2017/08/07  17:46   333 vue-build
2017/08/07  17:46   210 vue-build.cmd
2017/08/07  17:46   331 vue-init
2017/08/07  17:46   208 vue-init.cmd
2017/08/07  17:46   331 vue-list
2017/08/07  17:46   208 vue-list.cmd
2017/08/07  17:46   198 vue.cmd
2017/08/08  09:49   335 webpack
2017/08/08  09:49   379 webpack-dev-server
2017/08/08  09:49   256 webpack-dev-server.cmd
2017/08/08  09:49   212 webpack.cmd
  12 个文件  3,322 字节
   4 个目录 146,669,424,640 可用字节

D:\Program Files\nodejs\node_global&gt;
</code></pre></blockquote>
<h3 id="项目搭建"><a href="#项目搭建" class="headerlink" title="项目搭建"></a>项目搭建</h3><h4 id="初始化项目"><a href="#初始化项目" class="headerlink" title="初始化项目"></a>初始化项目</h4><p>新建一个项目文件夹，名为vuedemo</p>
<pre><code>E:\IDC\Workspace&gt;md vuedemo

E:\IDC\Workspace&gt;cd vuedemo

E:\IDC\Workspace\vuedemo&gt;
</code></pre><p>初始化项目，生成package.json文件</p>
<pre><code>E:\IDC\Workspace\vuedemo&gt;npm init -y
Wrote to E:\IDC\Workspace\vuedemo\package.json:

{
  &quot;name&quot;: &quot;vuedemo&quot;,
  &quot;version&quot;: &quot;1.0.0&quot;,
  &quot;description&quot;: &quot;&quot;,
  &quot;main&quot;: &quot;index.js&quot;,
  &quot;scripts&quot;: {
&quot;test&quot;: &quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;
  },
  &quot;keywords&quot;: [],
  &quot;author&quot;: &quot;&quot;,
  &quot;license&quot;: &quot;ISC&quot;
}



E:\IDC\Workspace\vuedemo&gt;dir
 驱动器 E 中的卷没有标签。
 卷的序列号是 000D-8BC6

 E:\IDC\Workspace\vuedemo 的目录

2017/08/10  09:59&lt;DIR&gt;  .
2017/08/10  09:59&lt;DIR&gt;  ..
2017/08/10  09:59   221 package.json
   1 个文件221 字节
   2 个目录 91,132,411,904 可用字节
</code></pre><h4 id="安装依赖库"><a href="#安装依赖库" class="headerlink" title="安装依赖库"></a>安装依赖库</h4><p>在使用npm安装依赖之前，我先解释几个参数。npm安装分为全局安装和和本地安装。如：</p>
<pre><code>npm install express        # 本地安装
npm install express -g    # 全局安装
</code></pre><blockquote>
<p><strong>说明</strong>：</p>
<p>本地安装</p>
<blockquote>
<ul>
<li>将安装包放在 ./node_modules 下（运行 npm 命令时所在的目录），如果没有 node_modules 目录，会在当前执行 npm 命令的目录下生成 node_modules 目录。</li>
<li>可以通过 require() 来引入本地安装的包。</li>
</ul>
</blockquote>
<p>全局安装</p>
<blockquote>
<ul>
<li>将安装包放在 .\/node_modules 下（运行 npm 命令时所在的目录），如果没有 node_modules 目录，会在当前执行 npm 命令的目录下生成 node_modules 目录。</li>
<li>可以直接在命令行里使用。</li>
</ul>
</blockquote>
<p>如果你希望具备两者功能，则需要在两个地方安装它或使用 npm link。</p>
</blockquote>
<p>另外，npm install在安装npm包时，有两种命令可以把他们的信息写入package.json文件，一个是npm install –save另一个是 npm install –save-dev，他们表面上的区别是–save 会把依赖包名称添加到 package.json 文件 dependencies 键下，–save-dev 则添加到 package.json 文件 devDependencies 键下，–save-dev 是你开发时候依赖的东西，–save 是你发布之后还依赖的东西。</p>
<h5 id="安装vue及相关组件"><a href="#安装vue及相关组件" class="headerlink" title="安装vue及相关组件"></a>安装vue及相关组件</h5><p>安装<a href="https://cn.vuejs.org/" target="_blank" rel="external">vue.js</a>，默认安装最新的版本</p>
<pre><code>nmp install --save vue
</code></pre><p>安装路由组件vue-router.js</p>
<pre><code>nmp install --save vue-router
</code></pre><blockquote>
<p><strong>拓展</strong>：在一个项目中通常还需要用到的组件<a href="https://github.com/pagekit/vue-resource" target="_blank" rel="external">vue-resource</a>进行HTTP异步请求提交，还可以使用<a href="http://element.eleme.io/#/zh-CN/component/installation" target="_blank" rel="external">element-ui</a>提供的各种前端组件帮助我们快速完成开发。</p>
</blockquote>
<h5 id="安装webpack及相关组件"><a href="#安装webpack及相关组件" class="headerlink" title="安装webpack及相关组件"></a>安装webpack及相关组件</h5><p>全局和本地安装<a href="https://webpack.github.io" target="_blank" rel="external">webpack</a>，以及Nodejs.js解释服务器webpack-dev-server</p>
<pre><code>npm install webpack webpack-dev-server -g                    #全局安装
npm install --save-dev webpack webpack-dev-server            #本地安装
</code></pre><h5 id="安装其他有用的组件"><a href="#安装其他有用的组件" class="headerlink" title="安装其他有用的组件"></a>安装其他有用的组件</h5><p>安装babel，其作用是将ES6的语法编译成浏览器认识的语法ES5</p>
<pre><code>npm install --save-dev babel-core babel-loader babel-preset-es2015
</code></pre><p>安装vue解析组件，解析.vue后缀文件</p>
<pre><code>npm install --save-dev vue-loader vue-template-compiler
</code></pre><p>安装css解析组件</p>
<pre><code>npm install --save-dev css-loader style-loader
</code></pre><blockquote>
<p><strong>拓展</strong>：css-loader 和 style-loader，二者处理的任务不同，css-loader使你能够使用类似@import 和 url(…)的方法实现 require()的功能,style-loader将所有的计算后的样式加入页面中，二者组合在一起使你能够把样式表嵌入webpack打包后的JS文件中。</p>
</blockquote>
<p>安装url-loader，file-loader打包文件和图片</p>
<pre><code>npm install --save-dev url-loader file-loader
</code></pre><p>查看一下package.json文件的内容</p>
<pre><code>E:\IDC\Workspace\vuedemo&gt;type package.json
{
  &quot;name&quot;: &quot;vuedemo&quot;,
  &quot;version&quot;: &quot;1.0.0&quot;,
  &quot;description&quot;: &quot;&quot;,
  &quot;main&quot;: &quot;index.js&quot;,
  &quot;scripts&quot;: {
    &quot;test&quot;: &quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;
  },
  &quot;keywords&quot;: [],
  &quot;author&quot;: &quot;&quot;,
  &quot;license&quot;: &quot;ISC&quot;,
  &quot;dependencies&quot;: {
    &quot;vue&quot;: &quot;^2.4.2&quot;,
    &quot;vue-router&quot;: &quot;^2.7.0&quot;
  },
  &quot;devDependencies&quot;: {
    &quot;babel-core&quot;: &quot;^6.25.0&quot;,
    &quot;babel-loader&quot;: &quot;^7.1.1&quot;,
    &quot;babel-preset-es2015&quot;: &quot;^6.24.1&quot;,
    &quot;css-loader&quot;: &quot;^0.28.4&quot;,
    &quot;file-loader&quot;: &quot;^0.11.2&quot;,
    &quot;style-loader&quot;: &quot;^0.18.2&quot;,
    &quot;url-loader&quot;: &quot;^0.5.9&quot;,
    &quot;vue-loader&quot;: &quot;^13.0.4&quot;,
    &quot;vue-template-compiler&quot;: &quot;^2.4.2&quot;,
    &quot;webpack&quot;: &quot;^3.5.2&quot;,
    &quot;webpack-dev-server&quot;: &quot;^2.7.1&quot;
  }
}
</code></pre><h4 id="编辑项目目录和添加代码"><a href="#编辑项目目录和添加代码" class="headerlink" title="编辑项目目录和添加代码"></a>编辑项目目录和添加代码</h4><p>查看当前目录</p>
<pre><code>E:\IDC\Workspace\vuedemo&gt;tree
E:.
├─ dist
├─ node_modules
│   ├─ .bin
│   └─ ...
├─ src
│   ├─ assets
│   │   ├─ imgs
│   │   │   └─ logo.png
│   │   └─ styles
│   │       └─ base.css
│   ├─ components
│   │      └─ header.vue
│   ├─ views
│   │   ├─ about.vue
│   │   └─ home.vue
│   ├─ App.vue
│   ├─ main.js
│   └─ routes.js
├─ index.html  
├─ package.json    
└─ webpack.config.js    
</code></pre><h5 id="项目目录"><a href="#项目目录" class="headerlink" title="项目目录"></a>项目目录</h5><p>//dist文件是后面执行webpack指令生产的，不用管；</p>
<p>//webpack.config.js 配置文件，本身也是一个标准的Commonjs规范的模块；</p>
<p>//routes.js文件放路由配置文件；</p>
<p>//index.html首页入口文件</p>
<p>//App.vue是项目入口文件。</p>
<p>//main.js这是项目的核心文件。全局的配置都在这个文件里面配置。</p>
<p>//components目录里面放了公共组件header文件。</p>
<p>//views文件放详情页面；</p>
<h5 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h5><h6 id="根目录代码"><a href="#根目录代码" class="headerlink" title="根目录代码"></a>根目录代码</h6><p>这里主要是编写webpack.config.js配置文件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * Created by 01107267 on 2017/8/7.</div><div class="line"> */</div><div class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</div><div class="line"><span class="keyword">var</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>)</div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">	<span class="attr">entry</span>: <span class="string">'./src/main.js'</span>,<span class="comment">//也可以是数组，对象</span></div><div class="line">	output: &#123;</div><div class="line">    	<span class="attr">path</span>: path.resolve(__dirname, <span class="string">'./dist'</span>),<span class="comment">//webpack 构建后的结果存在此位置</span></div><div class="line">    	publicPath: <span class="string">'/dist/'</span>,   <span class="comment">//许多Webpack的插件用于在生产模式和开发模式下下更新内嵌到css、html，img文件里的url值</span></div><div class="line">    	filename: <span class="string">'build.js'</span></div><div class="line">	&#125;,</div><div class="line">    <span class="attr">module</span>: &#123;</div><div class="line">    	<span class="attr">rules</span>: [</div><div class="line">    		&#123;</div><div class="line">		    	<span class="attr">test</span>: <span class="regexp">/\.vue$/</span>, <span class="comment">//一个匹配loaders所处理的文件的拓展名的正则表达式（必须）</span></div><div class="line">			    loader: <span class="string">'vue-loader'</span>, <span class="comment">//loader的名称（必须）</span></div><div class="line">			    options: &#123;</div><div class="line">				    <span class="attr">loaders</span>: &#123;</div><div class="line">		    		&#125;</div><div class="line">	    			<span class="comment">//other vue-oader options go here</span></div><div class="line">	    		&#125;</div><div class="line">	    	&#125;,</div><div class="line">		    &#123;</div><div class="line">			    <span class="attr">test</span>: <span class="regexp">/\.(png|jpe?g|gif|svg)(\?\S*)?$/</span>,</div><div class="line">			    <span class="attr">loader</span>: <span class="string">'file-loader'</span>,</div><div class="line">			    <span class="attr">query</span>: &#123;</div><div class="line">				    <span class="attr">name</span>: <span class="string">'[name].[ext]?[hash]'</span></div><div class="line">			    &#125;</div><div class="line">		    &#125;,</div><div class="line">		    &#123;</div><div class="line">			    <span class="attr">test</span>: <span class="regexp">/\.js$/</span>,</div><div class="line">			    <span class="attr">loader</span>: <span class="string">'babel-loader'</span>,</div><div class="line">			    <span class="attr">exclude</span>: <span class="regexp">/node_modules/</span></div><div class="line">		    &#125;,</div><div class="line">		    <span class="comment">// self define</span></div><div class="line">		    &#123;</div><div class="line">			    <span class="attr">test</span>: <span class="regexp">/\.css$/</span>,</div><div class="line">			    <span class="attr">loader</span>: <span class="string">"style-loader!css-loader"</span></div><div class="line">		    &#125;</div><div class="line">		    ,</div><div class="line">		    &#123;</div><div class="line">			    <span class="attr">test</span>: <span class="regexp">/\.scss$/</span>,</div><div class="line">			    <span class="attr">loader</span>: <span class="string">"style-loader!css-loader!sass-loader!"</span></div><div class="line">		    &#125;,</div><div class="line">		    &#123;</div><div class="line">			    <span class="attr">test</span>: <span class="regexp">/\.(eot|svg|ttf|woff|woff2)(\?\S*)?$/</span>,</div><div class="line">			    <span class="attr">loader</span>: <span class="string">'file-loader'</span></div><div class="line">		    &#125;</div><div class="line">  		]</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">resolve</span>: &#123;</div><div class="line">	    <span class="attr">alias</span>: &#123;</div><div class="line">	    	<span class="string">'vue$'</span>: <span class="string">'vue/dist/vue.esm.js'</span></div><div class="line">	    &#125;</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">devServer</span>: &#123;<span class="comment">//webpack-dev-server配置</span></div><div class="line">	    historyApiFallback: <span class="literal">true</span>,<span class="comment">//不跳转</span></div><div class="line">	    noInfo: <span class="literal">true</span>,</div><div class="line">	    <span class="attr">inline</span>: <span class="literal">true</span><span class="comment">//实时刷新</span></div><div class="line">    &#125;,</div><div class="line">    <span class="attr">performance</span>: &#123;</div><div class="line">	    <span class="attr">hints</span>: <span class="literal">false</span></div><div class="line">    &#125;,</div><div class="line">    <span class="attr">devtool</span>: <span class="string">'#eval-source-map'</span></div><div class="line">&#125;</div><div class="line">    </div><div class="line"><span class="keyword">if</span> (process.env.NODE_ENV === <span class="string">'production'</span>) &#123;</div><div class="line">    <span class="built_in">module</span>.exports.devtool = <span class="string">'#source-map'</span></div><div class="line">    <span class="comment">// http://vue-loader.vuejs.org/en/workflow/production.html</span></div><div class="line">    <span class="built_in">module</span>.exports.plugins = (<span class="built_in">module</span>.exports.plugins || []).concat([</div><div class="line">	    <span class="keyword">new</span> webpack.DefinePlugin(&#123;</div><div class="line">	    	<span class="string">'process.env'</span>: &#123;</div><div class="line">	    		<span class="attr">NODE_ENV</span>: <span class="string">'"production"'</span></div><div class="line">	    	&#125;</div><div class="line">	    &#125;),</div><div class="line">	    <span class="keyword">new</span> webpack.optimize.UglifyJsPlugin(&#123;</div><div class="line">	    	<span class="attr">sourceMap</span>: <span class="literal">true</span>,</div><div class="line">	    	<span class="attr">compress</span>: &#123;</div><div class="line">	    		<span class="attr">warnings</span>: <span class="literal">false</span></div><div class="line">    		&#125;</div><div class="line">	    &#125;),</div><div class="line">	    <span class="keyword">new</span> webpack.LoaderOptionsPlugin(&#123;</div><div class="line">	    	<span class="attr">minimize</span>: <span class="literal">true</span></div><div class="line">	    &#125;)</div><div class="line">    ])</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p><strong>注释</strong>：<br>test：一个匹配loaders所处理的文件的拓展名的正则表达式（必须）<br>loader：loader的名称（必须）<br>include/exclude:手动添加必须处理的文件（文件夹）或屏蔽不需要处理的文件（文件夹）（可选）</p>
</blockquote>
<p>编写routes.js文件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 引用模板</span></div><div class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span>;</div><div class="line"><span class="keyword">import</span> Router <span class="keyword">from</span> <span class="string">'vue-router'</span>;</div><div class="line"><span class="keyword">import</span> indexPage <span class="keyword">from</span> <span class="string">'./components/header.vue'</span></div><div class="line"><span class="keyword">import</span> homePage <span class="keyword">from</span> <span class="string">'./views/home.vue'</span></div><div class="line"><span class="keyword">import</span> aboutPage <span class="keyword">from</span> <span class="string">'./views/about.vue'</span></div><div class="line"></div><div class="line">Vue.use(Router)</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> Router(&#123;</div><div class="line">    <span class="attr">routes</span>:[</div><div class="line">        &#123;</div><div class="line">            <span class="attr">path</span>:<span class="string">'/'</span>,</div><div class="line">            <span class="attr">component</span>:homePage</div><div class="line">        &#125;,</div><div class="line">        &#123;</div><div class="line">            <span class="attr">path</span>:<span class="string">'/about'</span>,</div><div class="line">            <span class="attr">component</span>:aboutPage</div><div class="line">        &#125;</div><div class="line">    ]</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>编写index.html文件</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"appIndex"</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./dist/build.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<p>编写App.vue文件</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!--App.vue是项目入口文件。--&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">header-tab</span>&gt;</span><span class="tag">&lt;/<span class="name">header-tab</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;&#123;msg&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"nav-box"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"nav-list"</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">class</span>=<span class="string">"nav-item"</span> <span class="attr">to</span>=<span class="string">"/"</span>&gt;</span>首页<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">class</span>=<span class="string">"nav-item"</span> <span class="attr">to</span>=<span class="string">"/about"</span>&gt;</span>关于<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">router-view</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line"><span class="keyword">import</span> HeaderTab <span class="keyword">from</span> <span class="string">'./components/header.vue'</span>;</div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</div><div class="line">  <span class="attr">name</span>: <span class="string">'app'</span>,</div><div class="line">  data () &#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      <span class="attr">msg</span>: <span class="string">'Welcome to Your Vue.js App'</span></div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">components</span>:&#123;</div><div class="line">    HeaderTab</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="css"></span></div><div class="line">    <span class="selector-tag">h2</span>&#123;</div><div class="line">        <span class="attribute">color</span>:<span class="number">#ff0000</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="selector-id">#app</span> &#123;</div><div class="line">        <span class="attribute">text-align</span>: center;</div><div class="line">        <span class="attribute">color</span>: <span class="number">#2c3e50</span>;</div><div class="line">        <span class="attribute">margin-top</span>: <span class="number">60px</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="selector-tag">h1</span>, <span class="selector-tag">h2</span> &#123;</div><div class="line">        <span class="attribute">font-weight</span>: normal;</div><div class="line">    &#125;</div><div class="line">    <span class="selector-tag">ul</span> &#123;</div><div class="line">        <span class="attribute">list-style-type</span>: none;</div><div class="line">        <span class="attribute">padding</span>: <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="selector-tag">li</span> &#123;</div><div class="line">        <span class="attribute">text-align</span>: left;</div><div class="line">        <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">10px</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="selector-tag">a</span> &#123;</div><div class="line">        <span class="attribute">color</span>: <span class="number">#42b983</span>;</div><div class="line">    &#125;</div><div class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></div></pre></td></tr></table></figure>
<p>编写main.js文件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//main.js这是项目的核心文件。全局的配置都在这个文件里面配置</span></div><div class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></div><div class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'./App.vue'</span></div><div class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">'./routes.js'</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> <span class="string">'./assets/styles/base.css'</span></div><div class="line">Vue.config.debug = <span class="literal">true</span>;<span class="comment">//开启错误提示</span></div><div class="line"></div><div class="line"><span class="keyword">new</span> Vue(&#123;</div><div class="line">        router,</div><div class="line">        <span class="attr">el</span>: <span class="string">'#appIndex'</span>,</div><div class="line">        <span class="attr">render</span>: <span class="function"><span class="params">h</span> =&gt;</span> h(App)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h6 id="components组件目录代码"><a href="#components组件目录代码" class="headerlink" title="components组件目录代码"></a>components组件目录代码</h6><p>编写header.vue文件</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>共同header<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"../assets/imgs/logo.png"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></div></pre></td></tr></table></figure>
<h6 id="views目录代码"><a href="#views目录代码" class="headerlink" title="views目录代码"></a>views目录代码</h6><p>编写about.vue文件</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">//about.vue</div><div class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>about<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></div></pre></td></tr></table></figure>
<p>编写home.vue文件</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">//index.vue</div><div class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">ol</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">"todo in todos"</span>&gt;</span></div><div class="line">                &#123;&#123; todo.text &#125;&#125;</div><div class="line">            <span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">"eClick()"</span>&gt;</span>事件<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</div><div class="line">  <span class="attr">name</span>: <span class="string">'indexP'</span>,</div><div class="line">  data () &#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">       <span class="attr">todos</span>: [</div><div class="line">          &#123; <span class="attr">text</span>: <span class="string">'Learn JavaScript'</span> &#125;,</div><div class="line">          &#123; <span class="attr">text</span>: <span class="string">'Learn Vue'</span> &#125;,</div><div class="line">          &#123; <span class="attr">text</span>: <span class="string">'Build something awesome'</span> &#125;</div><div class="line">        ]</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">methods</span>:&#123;</div><div class="line">    eClick()&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="number">9999</span>);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
<h6 id="style目录代码"><a href="#style目录代码" class="headerlink" title="style目录代码"></a>style目录代码</h6><p>编写base.css文件</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">h1</span>&#123;</div><div class="line">    <span class="attribute">color</span>: <span class="number">#999</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="项目启动"><a href="#项目启动" class="headerlink" title="项目启动"></a>项目启动</h4><p>构建打包</p>
<pre><code>webpack
</code></pre><img src="/2017/08/10/vuejs-demo/webpack.png" alt="webpack.png" title="">
<p>执行webpack-dev-server</p>
<pre><code>webpack-dev-server
</code></pre><img src="/2017/08/10/vuejs-demo/webpack-dev-server.png" alt="webpack-dev-server.png" title="">
<p>页面效果</p>
<img src="/2017/08/10/vuejs-demo/index.jpg" alt="index.jpg" title="">
]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
&lt;p&gt;&lt;strong&gt;原创申明&lt;/strong&gt;：本文为博主原创，转载请注明出处！&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;这里主要记录vue.js+webpack在一个简单实例中的使用过程&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;说明&lt;/strong&gt;：本次搭建基于W
    
    </summary>
    
      <category term="Web前端技术" scheme="http://202.104.112.179:8085/categories/Web%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="vue" scheme="http://202.104.112.179:8085/tags/vue/"/>
    
  </entry>
  
  <entry>
    <title>python学习笔记（一）</title>
    <link href="http://202.104.112.179:8085/2017/08/04/python-learning-01/"/>
    <id>http://202.104.112.179:8085/2017/08/04/python-learning-01/</id>
    <published>2017-08-04T02:27:01.000Z</published>
    <updated>2018-03-06T08:54:01.623Z</updated>
    
    <content type="html"><![CDATA[<hr>
<p><strong>原创申明</strong>：本文为博主原创，转载请注明出处！</p>
<hr>
]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
&lt;p&gt;&lt;strong&gt;原创申明&lt;/strong&gt;：本文为博主原创，转载请注明出处！&lt;/p&gt;
&lt;hr&gt;

    
    </summary>
    
      <category term="Python" scheme="http://202.104.112.179:8085/categories/Python/"/>
    
    
      <category term="Python" scheme="http://202.104.112.179:8085/tags/Python/"/>
    
      <category term="编程学习" scheme="http://202.104.112.179:8085/tags/%E7%BC%96%E7%A8%8B%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>linux常用操作总结</title>
    <link href="http://202.104.112.179:8085/2017/08/01/linux-ops/"/>
    <id>http://202.104.112.179:8085/2017/08/01/linux-ops/</id>
    <published>2017-08-01T06:17:19.000Z</published>
    <updated>2018-03-06T06:04:38.297Z</updated>
    
    <content type="html"><![CDATA[<hr>
<p><strong>原创申明</strong>：本文为博主原创，转载请注明出处！</p>
<hr>
<ul>
<li><p>查看当前文件夹大小</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">du -sh &lt;dir_path&gt;</div><div class="line">or</div><div class="line">du -ah --max-depth=1</div></pre></td></tr></table></figure>
</li>
<li><p>查看系统默认的文件句柄数</p>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">ulimit</span> -n</div></pre></td></tr></table></figure>
</li>
<li><p>查看进程打开的文件句柄数】</p>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">lsof -n|awk <span class="string">'&#123;print $2&#125;'</span>|sort|uniq -c|sort -nr|more</div></pre></td></tr></table></figure>
</li>
<li><p>查看某块磁盘上的读写进程</p>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">lsof /dev/xxx | head</div><div class="line"><span class="comment"># 查看详情</span></div><div class="line">lsof -p <span class="variable">$pid</span></div></pre></td></tr></table></figure>
</li>
<li><p>获取进程IO信息(内核版本&gt;2.6.20)</p>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cat /proc/<span class="variable">$pid</span>/io <span class="comment">#iotop -oP</span></div></pre></td></tr></table></figure>
</li>
<li><p>批量删除<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">```bash</div><div class="line">find /tmp -name &quot;*.pyc&quot; | xargs rm -rf</div><div class="line">sudo find /tmp -name &quot;*.pyc&quot; | xargs rm -rf</div><div class="line">find /tmp -name &quot;*.pyc&quot; -exec rm -f &#123;&#125;\</div></pre></td></tr></table></figure></p>
</li>
<li><p>使用gdb调试</p>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">gdb attach <span class="variable">$pid</span></div><div class="line">b [module]/[<span class="keyword">function</span>]/:[lineno]</div><div class="line">c <span class="comment">#run</span></div><div class="line">n <span class="comment">#next</span></div><div class="line">s <span class="comment">#into func</span></div><div class="line">list <span class="comment">#content</span></div><div class="line">...</div></pre></td></tr></table></figure>
</li>
<li><p>查看端口zhanyon</p>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">netstat -tpnl | grep <span class="variable">$pid</span></div></pre></td></tr></table></figure>
</li>
<li><p>格式化文件系统，如xfs</p>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mkfs.xfs -f /dev/sdx</div></pre></td></tr></table></figure>
</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
&lt;p&gt;&lt;strong&gt;原创申明&lt;/strong&gt;：本文为博主原创，转载请注明出处！&lt;/p&gt;
&lt;hr&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;查看当前文件夹大小&lt;/p&gt;
 &lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutt
    
    </summary>
    
      <category term="linux" scheme="http://202.104.112.179:8085/categories/linux/"/>
    
    
      <category term="linux" scheme="http://202.104.112.179:8085/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>CEPH运维之安装部署（luminous）</title>
    <link href="http://202.104.112.179:8085/2017/08/01/ceph-ops/"/>
    <id>http://202.104.112.179:8085/2017/08/01/ceph-ops/</id>
    <published>2017-08-01T06:09:41.000Z</published>
    <updated>2017-08-10T11:11:47.796Z</updated>
    
    <content type="html"><![CDATA[<hr>
<p><strong>原创申明</strong>：本文为博主原创，转载请注明出处！    </p>
<hr>
<p>这篇文档主要介绍ceph的搭建过程。</p>
<h3 id="集群规划"><a href="#集群规划" class="headerlink" title="集群规划"></a>集群规划</h3><p>服务器规划及配置，如下：</p>
<table>
<thead>
<tr>
<th style="text-align:left">hostname</th>
<th style="text-align:left">public ip</th>
<th style="text-align:left">cluster ip</th>
<th style="text-align:left">节点说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">ch-osd-1</td>
<td style="text-align:left">172.16.30.73</td>
<td style="text-align:left">172.16.31.73</td>
<td style="text-align:left">osd节点</td>
</tr>
<tr>
<td style="text-align:left">ch-osd-2</td>
<td style="text-align:left">172.16.30.72</td>
<td style="text-align:left">172.16.31.72</td>
<td style="text-align:left">osd节点</td>
</tr>
<tr>
<td style="text-align:left">ch-osd-3</td>
<td style="text-align:left">172.16.30.75</td>
<td style="text-align:left">172.16.31.75</td>
<td style="text-align:left">osd节点</td>
</tr>
<tr>
<td style="text-align:left">ch-osd-4</td>
<td style="text-align:left">172.16.30.77</td>
<td style="text-align:left">172.16.31.77</td>
<td style="text-align:left">osd节点</td>
</tr>
<tr>
<td style="text-align:left">ch-mon-1</td>
<td style="text-align:left">172.16.30.78</td>
<td style="text-align:left">172.16.31.78</td>
<td style="text-align:left">mon+rgw+manger节点</td>
</tr>
<tr>
<td style="text-align:left">ch-mon-2</td>
<td style="text-align:left">172.16.30.79</td>
<td style="text-align:left">172.16.31.79</td>
<td style="text-align:left">mon+rgw节点</td>
</tr>
<tr>
<td style="text-align:left">ch-mon-3</td>
<td style="text-align:left">172.16.30.80</td>
<td style="text-align:left">172.16.31.80</td>
<td style="text-align:left">mon+rgw节点</td>
</tr>
</tbody>
</table>
<ul>
<li>操作系统：centos release 7.2</li>
<li>CPU：OSD节点为Intel(R) Xeon(R) CPU E5-2650 v4 @ 2.20GHz * 48 ，MON节点为Intel(R) Xeon(R) CPU E5-2650 0 @ 2.00GHz * 32；</li>
<li>内存大小：OSD 为256GB； MON为64GB</li>
<li>数据硬盘配置（不含系统盘）：OSD 为1.2TB SAS * 3和480G SSD * 1，其中SSD不是必要的，我们这里主要存放journal，MON单独部署可以不需要数据盘</li>
<li>网络配置：public 网络和 cluster 均为万兆光纤</li>
<li>每台服务器第1，2块磁盘做RAID1；其余磁盘做RAID0</li>
<li>ch-mon-1节点作为管理节点，部署ceph-deploy</li>
<li>Ceph版本：目前最新版 v12.1.2</li>
<li>ceph-deploy版本：1.5.38</li>
<li>这里使用root用户安装，如果不是root用户，应该拥有root权限</li>
</ul>
<h3 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h3><h4 id="基础环境检查"><a href="#基础环境检查" class="headerlink" title="基础环境检查"></a>基础环境检查</h4><ol>
<li>网络连接正常（方法略）</li>
<li>ntp服务正常（方法略）</li>
<li>集群服务器时间，时区一致（方法略）</li>
<li>防火墙策略，开端口6789，6800：7300</li>
<li>SELINUX设置为Permissive或者禁掉</li>
<li>磁盘阵列检查</li>
</ol>
<p>首先需要在存储节点安装Megacli，下载RPM包，如MegaCli-8.07.14-1.noarch.rpm，安装命令如下：</p>
<pre><code>rpm -ivh MegaCli-8.07.14-1.noarch.rpm
</code></pre><p>使用磁盘阵列检查工具Megacli进行相关检查，查看是否满足需要的配置策略。</p>
<pre><code>/opt/MegaRAID/MegaCli64 -LDGetProp -Cache -LALL -aALL
</code></pre><p>一般情况可在安装操作系统前对各硬盘做好磁盘阵列，不同厂商的设备磁盘阵列配置略有不同，这里不做详述。如果没做磁盘阵列，这里需要做磁盘阵列，使用MegaCli来对磁盘做日常管理。</p>
<p>OSD数据盘做RAID0 ，并分别设置读、写、缓存策略，其中读策略为Read-Ahead；写策略为WriteBack，写入缓存直接返回；磁盘缓存Disk cache设置为disable；I/O策略为Direct请求不被系统Cache缓存。如磁盘编号为10 的物理磁盘组成一个RAID0</p>
<pre><code>/opt/MegaRAID/MegaCli64 -cfgldadd -r0 [32:10] WB RA RA -a0
</code></pre><p>或者</p>
<pre><code>/opt/MegaRAID/MegaCli64 -LDSetProp 10 WB -a0
/opt/MegaRAID/MegaCli64 -LDSetProp 10 RA -a0
/opt/MegaRAID/MegaCli64 -LDSetProp 10 RA -a0
</code></pre><p>SSD做日志盘做RAID0，读策略为Normal，不适用预读，写策略为Write Through直接写入磁盘；如果SSD有掉电保护，磁盘缓存Disk cache设置为Enable；I/O策略为Direct请求不被Cache缓存。</p>
<pre><code>/opt/MegaRAID/MegaCli64 -cfgldadd -r0 [32:13] WT NORA Direct -a0
</code></pre><p>Megacli更详细的使用，可以参考其他资料，如<a href="https://supportforums.cisco.com/document/62901/megacli-common-commands-and-procedures" target="_blank" rel="external">参考文档1</a>等</p>
<h4 id="基础环境配置"><a href="#基础环境配置" class="headerlink" title="基础环境配置"></a>基础环境配置</h4><h5 id="yum源配置"><a href="#yum源配置" class="headerlink" title="yum源配置"></a>yum源配置</h5><p>这里采用yum安装，我已经将CEPH二进制RPM包上传至YUM镜像，所以先配置CEPH可用的YUM源，包括CEPH本身和EPEL源，如下：</p>
<pre><code>[root@node-5 env-check-init]# cat /etc/yum.repos.d/CentOS.repo 
...
[CENTOS7-epel]
name=CENTOS7 epel resource
baseurl=http://yum17.int.sfdc.com.cn/epel7Server/$basearch
enabled=1
gpgcheck=0
gpgkey=http://yum17.int.sfdc.com.cn/epel7/$basearch/RPM-GPG-KEY-EPEL-7

[CENTOS7-ceph]
name=CENTOS7 ceph resource
baseurl=http://yum17.int.sfdc.com.cn/ceph/el7/$basearch
enabled=1
gpgcheck=0
gpgkey=http://yum17.int.sfdc.com.cn/ceph/el7/$basearch/RPM-GPG-KEY-EPEL-7
</code></pre><blockquote>
<p><strong>提示</strong>：如果你没有自己的YUM源可使用国内开源镜像，如<a href="https://mirrors.tuna.tsinghua.edu.cn/" target="_blank" rel="external">清华镜像</a>，<a href="http://mirrors.ustc.edu.cn/" target="_blank" rel="external">中科大镜像</a>，<a href="https://mirrors.aliyun.com/" target="_blank" rel="external">阿里镜像</a>等，也可以使用<a href="http://docs.ceph.com/docs/master/start/quick-start-preflight/#rhel-centos" target="_blank" rel="external">Ceph官方文档</a>给出的配置。</p>
</blockquote>
<h5 id="SSH互信"><a href="#SSH互信" class="headerlink" title="SSH互信"></a>SSH互信</h5><p>需要为管理节点和其他集群节点建立ssh互信，使管理节点可以免验证登录其他各节点</p>
<p>在管理节点生成ssh keys，命令如下：</p>
<pre><code>ssh-keygen
</code></pre><p>将管理节点的ssh key 拷贝到其它个节点：</p>
<pre><code>ssh-copy-id root@172.16.30.xxx
</code></pre><h3 id="集群部署"><a href="#集群部署" class="headerlink" title="集群部署"></a>集群部署</h3><h4 id="软件包安装"><a href="#软件包安装" class="headerlink" title="软件包安装"></a>软件包安装</h4><p>在管理节点安装ceph-deploy</p>
<pre><code>yum install ceph-deploy -y
</code></pre><p>安装Ceph，在各个节点执行命令</p>
<pre><code>yum install ceph -y
</code></pre><p>安装完后可以使用如下命令查看版本</p>
<pre><code>[root@ch-mon-1 ~]# ceph -v
ceph version 12.1.2 (b661348f156f148d764b998b65b90451f096cb27) luminous (rc)
</code></pre><p>同时，可以看到在/etc目录下新增了一个ceph目录。进入/etc/ceph目录</p>
<pre><code>cd /etc/ceph
</code></pre><h4 id="创建集群"><a href="#创建集群" class="headerlink" title="创建集群"></a>创建集群</h4><h5 id="初始化集群"><a href="#初始化集群" class="headerlink" title="初始化集群"></a>初始化集群</h5><p>准备3个Monitor节点</p>
<pre><code>ceph-deploy new ch-mon-1 ch-mon-2 ch-mon-3
</code></pre><p>执行完毕后再该目录下可以看到有如下文件</p>
<pre><code>[root@ch-mon-1 ceph]# pwd
/etc/ceph
[root@ch-mon-1 ceph]# ll
-rw-r--r-- 1 root root   805 Aug  3 13:44 ceph.conf
-rw-r--r-- 1 root root 33736 Aug  3 13:45 ceph-deploy-ceph.log
-rw------- 1 root root    73 Aug  3 13:43 ceph.mon.keyring
</code></pre><p>此时可以开始规划集群配置，如集群网络配置，我这里的配置如下：</p>
<p>默认配置</p>
<pre><code>[root@ch-mon-1 ceph]# cat ceph.conf 
[global]
fsid = 31fc3bef-d912-4d12-aa1e-130d3270d5db
mon_initial_members = ch-mon-1, ch-mon-2, ch-mon-3
mon_host = 172.16.30.78,172.16.30.79,172.16.30.80
auth_cluster_required = cephx
auth_service_required = cephx
auth_client_required = cephx
</code></pre><p>修改后</p>
<pre><code>[root@ch-mon-1 ceph]# cat ceph.conf 
[global]
fsid = 31fc3bef-d912-4d12-aa1e-130d3270d5db
mon_initial_members = ch-mon-1, ch-mon-2, ch-mon-3
mon_host = 172.16.30.78,172.16.30.79,172.16.30.80
auth_cluster_required = cephx
auth_service_required = cephx
auth_client_required = cephx

public_network = 172.16.30.0/24
cluster_network = 172.16.31.0/24
osd_pool_default_size = 3
osd_pool_default_min_size = 1
osd_pool_default_pg_num = 8
osd_pool_default_pgp_num = 8
osd_crush_chooseleaf_type = 1

[mon]
mon_clock_drift_allowed = 0.5

[osd]
osd_mkfs_type = xfs
osd_mkfs_options_xfs = -f
filestore_max_sync_interval = 5
filestore_min_sync_interval = 0.1
filestore_fd_cache_size = 655350
filestore_omap_header_cache_size = 655350
filestore_fd_cache_random = true
osd op threads = 8
osd disk threads = 4
filestore op threads = 8
max_open_files = 655350
</code></pre><h5 id="初始化Monitor"><a href="#初始化Monitor" class="headerlink" title="初始化Monitor"></a>初始化Monitor</h5><p>部署初始的monitors，并获得keys</p>
<pre><code>ceph-deploy mon create-initial
</code></pre><p>做完这一步，在当前目录下就会看到有如下的keyrings：</p>
<pre><code>[root@ch-mon-1 ceph]# ll
-rw------- 1 root root    71 Aug  3 13:45 ceph.bootstrap-mds.keyring
-rw------- 1 root root    71 Aug  3 13:45 ceph.bootstrap-mgr.keyring
-rw------- 1 root root    71 Aug  3 13:45 ceph.bootstrap-osd.keyring
-rw------- 1 root root    71 Aug  3 13:45 ceph.bootstrap-rgw.keyring
-rw------- 1 root root    63 Aug  3 13:45 ceph.client.admin.keyring
</code></pre><p>要在节点使用ceph命令行需要将ceph.client.admin.keyring放在需要的节点的/etc/ceph目录下。如这里希望在所有的节点使用命令行，可以通过如下命令将ceph.client.admin.keyring拷贝到各节点，当然也可以使用cp命令。</p>
<pre><code>ceph-deploy admin ch-mon-2 ch-mon-3 ch-osd-1 ch-osd-2 ch-osd-3 ch-osd-4
</code></pre><p>在L版本的Ceph中新增了manager daemon，如下命令部署一个Manager守护进程</p>
<pre><code>ceph-deploy mgr create ch-mon-1
</code></pre><h5 id="增加OSDs"><a href="#增加OSDs" class="headerlink" title="增加OSDs"></a>增加OSDs</h5><p>我们使用的版本后端存储默认使用bluestore</p>
<p>下面我们添加OSDs</p>
<pre><code>ceph-deploy osd create ch-osd-1:/dev/sdb ch-osd-1:/dev/sdc ch-osd-1:/dev/sdd ch-osd-2:/dev/sdb ch-osd-2:/dev/sdc ch-osd-2:/dev/sdd ch-osd-3:/dev/sdb ch-osd-3:/dev/sdc ch-osd-3:/dev/sdd ch-osd-4:/dev/sdb ch-osd-4:/dev/sdc ch-osd-4:/dev/sdd
</code></pre><blockquote>
<p><strong>提示</strong>：在早期的版本中，添加OSD分为prepare和activate两步，这里不详述</p>
</blockquote>
<p>等命令执行结束之后可以查看集群状态</p>
<pre><code>[root@ch-mon-1 ~]# ceph -s
  cluster:
    id:     31fc3bef-d912-4d12-aa1e-130d3270d5db
    health: HEALTH_OK

  services:
    mon: 3 daemons, quorum ch-mon-1,ch-mon-2,ch-mon-3
    mgr: ch-mon-1(active)
    osd: 12 osds: 12 up, 12 in

  data:
    pools:   0 pools, 0 pgs
    objects: 0 objects, 0 bytes
    usage:   12742 MB used, 13386 GB / 13398 GB avail
    pgs:
</code></pre><p>查看OSDs</p>
<pre><code>[root@ch-osd-1 ~]# ceph osd tree
ID CLASS WEIGHT   TYPE NAME         STATUS REWEIGHT PRI-AFF 
-1       13.08472 root default                              
-3        3.27118     host ch-osd-1                         
 0   hdd  1.09039         osd.0         up  1.00000 1.00000 
 1   hdd  1.09039         osd.1         up  1.00000 1.00000 
 2   hdd  1.09039         osd.2         up  1.00000 1.00000 
-5        3.27118     host ch-osd-2                         
 3   hdd  1.09039         osd.3         up  1.00000 1.00000 
 4   hdd  1.09039         osd.4         up  1.00000 1.00000 
 5   hdd  1.09039         osd.5         up  1.00000 1.00000 
-7        3.27118     host ch-osd-3                         
 6   hdd  1.09039         osd.6         up  1.00000 1.00000 
 7   hdd  1.09039         osd.7         up  1.00000 1.00000 
 8   hdd  1.09039         osd.8         up  1.00000 1.00000 
-9        3.27118     host ch-osd-4                         
 9   hdd  1.09039         osd.9         up  1.00000 1.00000 
10   hdd  1.09039         osd.10        up  1.00000 1.00000 
11   hdd  1.09039         osd.11        up  1.00000 1.00000 
</code></pre><p>至此，整个集群就搭建完毕。</p>
<p>通过对目前最新版本Ceph部署，可见比老版本比如生产上大量使用的Hammer版部署起来简单，当然这里没有太多的配置优化。</p>
<h3 id="常用运维"><a href="#常用运维" class="headerlink" title="常用运维"></a>常用运维</h3><h4 id="开启监控模块"><a href="#开启监控模块" class="headerlink" title="开启监控模块"></a>开启监控模块</h4><p>在配置文件/etc/ceph/ceph.conf中添加</p>
<pre><code>[mgr]
mgr modules = dashboard
</code></pre><p>或者</p>
<pre><code>ceph mgr module enable dashboard
</code></pre><p>设置dashboard的ip和端口</p>
<pre><code>ceph config-key put mgr/dashboard/server_addr 172.16.30.78
ceph config-key put mgr/dashboard/server_port 7000
</code></pre><p>重启mgr服务</p>
<pre><code>[root@ch-osd-1 ~]# systemctl restart ceph-mgr@ch-mon-1
</code></pre><h4 id="增加-删除-MONITORs"><a href="#增加-删除-MONITORs" class="headerlink" title="增加/删除 MONITORs"></a>增加/删除 MONITORs</h4><h5 id="增加MONITOR"><a href="#增加MONITOR" class="headerlink" title="增加MONITOR"></a>增加MONITOR</h5><h5 id="删除MONITOR"><a href="#删除MONITOR" class="headerlink" title="删除MONITOR"></a>删除MONITOR</h5><p>首先停需要删除的monitor守护进程，命令如下：</p>
<pre><code>service ceph -a stop mon.{mon-id}
#for example
service ceph -a stop mon.ch-mon-1
</code></pre><p>然后将monitor从集群删除</p>
<pre><code>ceph mon remove {mon-id}
#for example
ceph mon remove ch-mon-1
</code></pre><p>最后，删除ceph.conf中的该monitor配置</p>
<p>更详细的使用方法见<a href="http://docs.ceph.com/docs/master/rados/operations/add-or-rm-mons/#removing-monitors" target="_blank" rel="external">官方文档</a></p>
<h4 id="增加-删除-OSDs"><a href="#增加-删除-OSDs" class="headerlink" title="增加/删除 OSDs"></a>增加/删除 OSDs</h4><h5 id="增加OSD"><a href="#增加OSD" class="headerlink" title="增加OSD"></a>增加OSD</h5><h5 id="删除OSD"><a href="#删除OSD" class="headerlink" title="删除OSD"></a>删除OSD</h5><p>在删除OSD之前，OSD通常为up且in的状态，需要先将要删除的OSD踢出集群，让集群可以进行rebalancing，同时将数据拷贝到其它OSD上。 在<strong>管理节点</strong>执行OSD踢出集群命令如下：</p>
<pre><code>ceph osd out {osd-num}
#for example
ceph osd out 2
</code></pre><p>一旦OSD被踢出集群后，集群通过将要删除的OSD上的PGs迁出来进行rebalancing，我们可以通过如下命令来观察整个过程</p>
<pre><code>ceph -w
</code></pre><blockquote>
<p><strong>注意</strong>：在只有少数服务器的小集群中，比如我们测试的集群，在进行out操作可能使一些PGs始终在active+remapped状态，这时，应该将osd置回in,回到初始状态<br><code>ceph osd in {osd-num}</code><br>然后，不是out OSD，而是将OSD权重设置为0。<br><code>ceph osd crush reweight osd.{osd-num} 0</code><br>之后再观察数据迁移状态。out和权重置0的区别在于，第一种情况下，OSD权重不改变，后者桶的权重被更新。</p>
</blockquote>
<p>将OSD踢出集群后，OSD可能仍然处于up且out状态，在从配置中删除OSD之前，需要将该OSD服务停止，登录<strong>OSD节点</strong>，执行命令停止相关OSD服务</p>
<pre><code>ssh {osd-host}
sudo systemctl stop ceph-osd@{osd-num}
#for example
ssh ch-osd-1
systemctl stop ceph-osd@2
</code></pre><p>或者</p>
<pre><code>kill -9 {pid}
</code></pre><p>在早期的版本中使用如下命令</p>
<pre><code>service ceph stop osd.2
</code></pre><p>最后需要将OSD从集群的CRUSH MAP中删除，同时删除其权限，并且从OSD MAP删除OSD，在<strong>管理节点</strong>执行命令：</p>
<pre><code>#remove osd from crush map
ceph osd crush remove {name}
#remove the osd authentication key
ceph auth del osd.{osd-num}
#remove the osd
ceph osd rm {osd-num}
#for example
ceph osd crush remove osd.2
ceph auth del osd.2
ceph osd rm 2
</code></pre><p>如果在ceph.conf文件中有该OSD的配置，还需要删除相关配置</p>
<p>更详细的使用方法见<a href="http://docs.ceph.com/docs/master/rados/operations/add-or-rm-osds/#removing-osds-manual" target="_blank" rel="external">官方文档</a></p>
<h4 id="配置推送"><a href="#配置推送" class="headerlink" title="配置推送"></a>配置推送</h4><p>我们无需再每台服务器上修改ceph.conf文件中的配置信息，只需要在管理节点修改一份，然后推送到需要更行的节点上即可，如这里我们修改了ch-mon-1上/etc/ceph/ceph.conf内容，需要同时在ch-mon-2, ch-mon-3生效</p>
<pre><code>ceph-deploy --overwrite-conf config push ch-mon-2 ch-mon-3
</code></pre>]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
&lt;p&gt;&lt;strong&gt;原创申明&lt;/strong&gt;：本文为博主原创，转载请注明出处！    &lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;这篇文档主要介绍ceph的搭建过程。&lt;/p&gt;
&lt;h3 id=&quot;集群规划&quot;&gt;&lt;a href=&quot;#集群规划&quot; class=&quot;headerlink&quot; title
    
    </summary>
    
      <category term="分布式存储" scheme="http://202.104.112.179:8085/categories/%E5%88%86%E5%B8%83%E5%BC%8F%E5%AD%98%E5%82%A8/"/>
    
      <category term="运维操作" scheme="http://202.104.112.179:8085/categories/%E5%88%86%E5%B8%83%E5%BC%8F%E5%AD%98%E5%82%A8/%E8%BF%90%E7%BB%B4%E6%93%8D%E4%BD%9C/"/>
    
      <category term="Ceph" scheme="http://202.104.112.179:8085/categories/%E5%88%86%E5%B8%83%E5%BC%8F%E5%AD%98%E5%82%A8/%E8%BF%90%E7%BB%B4%E6%93%8D%E4%BD%9C/Ceph/"/>
    
    
      <category term="ceph" scheme="http://202.104.112.179:8085/tags/ceph/"/>
    
      <category term="分布式存储" scheme="http://202.104.112.179:8085/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E5%AD%98%E5%82%A8/"/>
    
  </entry>
  
  <entry>
    <title>一致性哈希算法</title>
    <link href="http://202.104.112.179:8085/2017/07/29/consistHash/"/>
    <id>http://202.104.112.179:8085/2017/07/29/consistHash/</id>
    <published>2017-07-29T05:10:02.000Z</published>
    <updated>2017-08-10T11:12:12.859Z</updated>
    
    <content type="html"><![CDATA[<hr>
<p><strong>转载申明</strong>：本文转载博主<a href="http://weibo.com/oilbeater/profile?s=6cm7D0" target="_blank" rel="external">oilbeater</a>的文章<a href="http://oilbeater.com/%E5%8D%9A%E5%AE%A2/2016/12/18/consist-hash.html" target="_blank" rel="external">聊聊一致性哈希</a>，转载请注明出处！</p>
<hr>
<p>既然有一致性哈希，就肯定还有不一致哈希，为啥平时没人说不一致哈希呢？因为常见的哈希都是不一致的，所以就不修饰了，到了一致性哈希才特殊加个描述词修饰一下。</p>
<p>哈希一般都是将一个大数字取模然后分散到不同的桶里，假设我们只有两个桶，有 2、3、4、5 四个数字，那么模 2 分桶的结果就是：</p>
<img src="/2017/07/29/consistHash/unconsist-hash-1.png" alt="unconsist-hash-1.png" title="">
<p>这时我们嫌桶太少要给哈希表扩容加了一个新桶，这时候所有的数字就需要模 3 来确定分在哪个桶里，结果就变成了：</p>
<img src="/2017/07/29/consistHash/unconsist-hash-2.png" alt="unconsist-hash-2.png" title="">
<p>可以看到新加了一个桶后所有数字的分布都变了，这就意味着哈希表的每次扩展和收缩都会导致所有条目分布的重新计算，这个特性在某些场景下是不可接受的。比如分布式的存储系统，每个桶就相当于一个机器，文件分布在哪台机器由哈希算法来决定，这个系统想要加一台机器时就需要停下来等所有文件重新分布一次才能对外提供服务，而当一台机器掉线的时候尽管只掉了一部分数据，但所有数据访问路由都会出问题。这样整个服务就无法平滑的扩缩容，成为了有状态的服务。</p>
<p>要想实现无状态化，就要用到一致性哈希了，一致性哈希中假想我们有很多个桶，先定一个小目标比如 7 个，但一开始真实还是只有两个桶，编号是 3 和 6。哈希算法还是同样的取模，只不过现在分桶分到的很可能是不存在的桶，那么就往下找找到第一个真实存在的桶放进去。这样 2 和 3 都被分到了编号为 3 的桶， 4 和 5 被分到了编号为 6 的桶。</p>
<img src="/2017/07/29/consistHash/consist-hash-1.png" alt="consist-hash-1.png" title="">
<p>这时候再添加一个新的桶，编号是 4，取模方法不变还是模 7：</p>
<img src="/2017/07/29/consistHash/consist-hash-2.png" alt="consist-hash-2.png" title="">
<p>因为 3 号桶里都是取模小于等于 3 的，4 号桶只需要从 6 号桶里拿走属于它的数字就可以了，这种情况下只需要调整一个桶的数字就可分成了重新分布。可以想象下即使有 1 亿个桶，增加减少一个桶也只会影响一个桶的数据分布。</p>
<p>这样增加一个机器只需要和他后面的机器同步一下数据就可以开始工作了，下线一个机器需要先把他的数据同步到后面一台机器再下线。如果突然掉了一台机器也只会影响这台机器上的数据。实现中可以让每台机器同步一份自己前面机器的数据，这样即使掉线也不会影响这一部分的数据服务。</p>
<p>这里还有个小问题要是编号为 6 的机桶下线了，它没有后一个桶了，数据该咋办？为了解决这个问题，实现上通常把哈希空间做成环状，这样 3 就成了 6 的下一桶，数据给 3 就好了：</p>
<img src="/2017/07/29/consistHash/consist-hash-3.png" alt="consist-hash-3.png" title="">
<p>用一致性哈希还能实现部分的分布式系统无锁化，每个任务有自己的编号，由于哈希算法的确定性，分到哪个桶也是确定的就不存在争抢，也就不需要分布式锁了。</p>
<p>既然一致性哈希有这么多好的特性，那为啥主流的哈希都是非一致的呢？主要一个原因在于查找效率上，普通的哈希查询一次哈希计算就可以找到对应的桶了，算法时间复杂度是 O(1)，而一致性哈希需要将排好序的桶组成一个链表，然后一路找下去，k 个桶查询时间复杂度是 O(k)，所以通常情况下的哈希还是用不一致的实现。</p>
<p>当然 O(k) 的时间复杂度对于哈希来说还是不能忍的，想一下都是O(k) 这个量级了用哈希的意义在哪里？既然是在排好序的桶里查询，很自然的想法就是二分了，能把时间复杂度降到 O(logk)，然而桶的组合需要不断的增减，所以是个链表的实现，二分肯定就不行了，还好可以用跳转表进行一个快速的跳转也能实现 O(logk) 的时间复杂度。</p>
<img src="/2017/07/29/consistHash/finger-table.png" alt="finger-table.png" title="">
<p>在这个跳转表中，每个桶记录距离自己 1，2，4 距离的数字所存的桶，这样不管查询落在哪个节点上，对整个哈希环上任意的查询一次都可以至少跳过一半的查询空间，这样递归下去很快就可以定位到数据是存在哪个桶上。</p>
<p>当然这写都只是一致性哈希实现方式中的一种，还有很多实现上的变体。比如选择数字放在哪个桶，上面的介绍里是选择顺着数字下去出现的第一个桶，其实也可以选择距离这个数字最近的桶，这样实现和后面的跳转表规则也会有变化。同样跳转表也有多种不同的算法实现，感兴趣的可以去看一下 CAN，Chord，Tapestry，Pastry 这四种 DHT 的实现，有意思的是它们都是 2001 年发出来的 paper，所以 2001 年大概是 P2P 下载的元年吧。</p>
]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
&lt;p&gt;&lt;strong&gt;转载申明&lt;/strong&gt;：本文转载博主&lt;a href=&quot;http://weibo.com/oilbeater/profile?s=6cm7D0&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;oilbeater&lt;/a&gt;的文章&lt;a 
    
    </summary>
    
      <category term="转载" scheme="http://202.104.112.179:8085/categories/%E8%BD%AC%E8%BD%BD/"/>
    
      <category term="技术原理" scheme="http://202.104.112.179:8085/categories/%E8%BD%AC%E8%BD%BD/%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86/"/>
    
    
      <category term="算法" scheme="http://202.104.112.179:8085/tags/%E7%AE%97%E6%B3%95/"/>
    
      <category term="哈希" scheme="http://202.104.112.179:8085/tags/%E5%93%88%E5%B8%8C/"/>
    
      <category term="分布式" scheme="http://202.104.112.179:8085/tags/%E5%88%86%E5%B8%83%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>test</title>
    <link href="http://202.104.112.179:8085/2017/07/10/test/"/>
    <id>http://202.104.112.179:8085/2017/07/10/test/</id>
    <published>2017-07-10T11:24:35.000Z</published>
    <updated>2017-08-10T11:50:26.109Z</updated>
    
    <content type="html"><![CDATA[<hr>
<p><strong>原创申明</strong>：本文为博主原创，转载请注明出处！</p>
<p><strong>转载申明</strong>：本文转载博主的文章test，转载请注明出处！</p>
<hr>
<pre><code>[code lang=&quot;bash&quot;]

E:\IDC\Workspace&gt;md vuedemo

E:\IDC\Workspace&gt;cd vuedemo

E:\IDC\Workspace\vuedemo&gt;

[/code]
</code></pre><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="selector-id">#button</span> &#123;</div><div class="line">    <span class="attribute">border</span>: none;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>[code lang=”css”]</p>
<p>#button {<br>    border: none;<br>}</p>
<p>[/code]</p>
]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
&lt;p&gt;&lt;strong&gt;原创申明&lt;/strong&gt;：本文为博主原创，转载请注明出处！&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;转载申明&lt;/strong&gt;：本文转载博主的文章test，转载请注明出处！&lt;/p&gt;
&lt;hr&gt;
&lt;pre&gt;&lt;code&gt;[code lang=&amp;quot;bash
    
    </summary>
    
    
  </entry>
  
</feed>
